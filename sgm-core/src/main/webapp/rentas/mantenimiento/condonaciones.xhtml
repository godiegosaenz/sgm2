<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE composition PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
                template="./../../template/template.xhtml"
                xmlns:h="http://xmlns.jcp.org/jsf/html" xmlns="http://www.w3.org/1999/xhtml"
                xmlns:p="http://primefaces.org/ui"
                xmlns:f="http://xmlns.jcp.org/jsf/core">
    <ui:define name="head">
        <style type="text/css">
            .ui-datatable tbody td {
                border-color: lightsteelblue;
                padding-bottom: 0px;
            }
            .ui-datatable table {
                border-collapse: collapse;
            }
            .ui-datatable-even {
                background: #e1e4f0;
            }
            .ui-datepicker .ui-datepicker-title select {
                font-size: 1em;
                margin: 1px 0;
                color: black;
            }
        </style>
    </ui:define>

    <ui:define name="page_title">
        Condonaciones
    </ui:define>

    <ui:define name="top">
        <h1>Mantenimiento de Condonaciones</h1>
    </ui:define>

    <ui:define name="content">
        <h:form id="frmMain">
            <p:tabView>
                <p:tab title="Condonaciones">
                    <center>
                        <p:panel header="Nuevo ingreso" style="width: 75%;">
                            <h:outputText value="Fecha de inicio: "/>
                            <p:calendar value="#{condonacionView.condonacion.fechaInicio}" navigator="true" pattern="dd/MM/yyyy" />
                            <h:outputText value=" Fecha de finalización: "/>
                            <p:calendar value="#{condonacionView.condonacion.fechaFin}" navigator="true" pattern="dd/MM/yyyy"/>
                            <p:commandButton value="Agregar condonación" update="dlgPorcentaje" actionListener="#{condonacionView.agregarNuevaCondonacion}" styleClass="btnStyle"/>
                        </p:panel>
                        <p:panel header="Condonaciones ingresadas" style="width: 75%;">
                            <p:dataTable id="dtCondonaciones" value="#{condonacionView.condonacionesList}" emptyMessage="No hay datos que mostrar" 
                                         paginatorPosition="top" paginator="true" rows="5" var="cond">
                                <p:column headerText="Fecha de inicio">
                                    <center><h:outputFormat value="{0, date, dd-MM-yyyy}">
                                            <f:param value="#{cond.fechaInicio}" />
                                    </h:outputFormat></center>
                                </p:column>
                                <p:column headerText="Fecha de finalización">
                                    <center><h:outputFormat value="{0, date, dd-MM-yyyy}">
                                            <f:param value="#{cond.fechaFin}" />
                                    </h:outputFormat></center>
                                </p:column>
                                <p:column headerText="Acción">
                                    <center><p:commandLink value="Editar" actionListener="#{condonacionView.editarCondonacion(cond)}" update="frmPorcentajeEdit" onclick="PF('dlgPorcentajeEdit').show()"/>
                                        <h:outputText value=" / "/><p:commandLink value="Eliminar" actionListener="#{condonacionView.eliminarCondonacion(cond)}" update="dtCondonaciones"/></center>
                                </p:column>
                            </p:dataTable>
                        </p:panel>
                    </center>
                </p:tab>
                <p:tab title="Lista de condonaciones solicitadas">
                    
                </p:tab>
            </p:tabView>
        </h:form>
        
        <!-- -->
        
        <p:dialog id="dlgPorcentaje" widgetVar="dlgPorcentaje" header="Rangos de porcentajes" appendTo="@(body)" modal="true" width="500" resizable="false" closable="true" closeOnEscape="true">
            <h:form id="frmPorcentaje" >
                <p:panel id="pPrctje" header="Ingrese los rangos de fecha con sus porcentajes" style="width: 100%">
                    <div align="center">
                        <p:panelGrid columns="2">
                            <p:panelGrid columns="2">
                                <h:outputText value="Fecha de inicio: "/>
                                <p:calendar value="#{condonacionView.porcentaje.fechaDesde}" navigator="true" pattern="dd/MM/yyyy"/>
                                <h:outputText value="Fecha de finalización: "/>
                                <p:calendar value="#{condonacionView.porcentaje.fechaHasta}" navigator="true" pattern="dd/MM/yyyy"/>
                                <h:outputText value="Porcentaje: "/>
                                <p:inputText value="#{condonacionView.porcentaje.porcentaje}"/>
                            </p:panelGrid>
                            <p:commandButton value="Agregar" actionListener="#{condonacionView.agregarPorcentaje()}" update="frmPorcentaje"/>
                        </p:panelGrid>
                        
                        
                        <p:dataTable id="dtPorcentajes" value="#{condonacionView.porcentajesList}" paginator="true" paginatorPosition="top" rows="5" var="porcentaje">
                            <p:column headerText="Fecha de inicio">
                                <center><h:outputFormat value="{0, date, dd-MM-yyyy}">
                                        <f:param value="#{porcentaje.fechaDesde}" />
                                    </h:outputFormat></center>
                            </p:column>
                            <p:column headerText="Fecha de fin">
                                <center><h:outputFormat value="{0, date, dd-MM-yyyy}">
                                        <f:param value="#{porcentaje.fechaHasta}" />
                                    </h:outputFormat></center>
                            </p:column>
                            <p:column headerText="Porcentaje">
                                <center><h:outputText value="#{porcentaje.porcentaje}"/></center>
                            </p:column>
                            <p:column headerText="Acción"> 
                                <center><p:commandLink value="Eliminar" actionListener="#{condonacionView.eliminarPorcentaje(porcentaje)}" update="dtPorcentajes"/></center>
                            </p:column>
                        </p:dataTable>
                        <p:commandButton value="Aceptar" styleClass="btnStyle" actionListener="#{condonacionView.nuevaCondonacion()}" style="margin-top: 15px;" update="frmMain" onclick="PF('dlgPorcentaje').hide()"/>
                    </div>
                    
                </p:panel>
            </h:form>
        </p:dialog>
        
        <!-- -->
        
        <p:dialog id="dlgPorcentajeEdit" widgetVar="dlgPorcentajeEdit" header="Rangos de porcentajes" appendTo="@(body)" modal="true" width="500" resizable="false" closable="true" closeOnEscape="true">
            <h:form id="frmPorcentajeEdit" >
                <p:accordionPanel>
                    <p:tab title="Nuevos rangos de fechas de la condonación">
                        <p:panel id="pPrctje1" header="Ingrese los rangos de fecha con sus porcentajes" style="width: 100%">
                            <p:panelGrid columns="2">
                                <p:panelGrid columns="2">
                                    <h:outputText value="Fecha de inicio: "/>
                                    <p:calendar value="#{condonacionView.condonacion.fechaInicio}" navigator="true" pattern="dd/MM/yyyy" />
                                    <h:outputText value=" Fecha de finalización: "/>
                                    <p:calendar value="#{condonacionView.condonacion.fechaFin}" navigator="true" pattern="dd/MM/yyyy"/>                                    
                                </p:panelGrid>
                                <p:commandButton value="Editar condonación" update="dlgPorcentaje" actionListener="#{condonacionView.editarCondonacion}" styleClass="btnStyle"/>
                            </p:panelGrid>
                        </p:panel>
                    </p:tab>
                    
                    
                    
                    <p:tab title="Porcentajes">
                        <p:panel id="pPrctje" header="Ingrese los rangos de fecha con sus porcentajes" style="width: 100%">
                            <div align="center">
                                <p:panelGrid columns="2">
                                    <p:panelGrid columns="2">
                                        <h:outputText value="Fecha de inicio: "/>
                                        <p:calendar value="#{condonacionView.porcentaje.fechaDesde}" navigator="true" pattern="dd/MM/yyyy"/>
                                        <h:outputText value="Fecha de finalización: "/>
                                        <p:calendar value="#{condonacionView.porcentaje.fechaHasta}" navigator="true" pattern="dd/MM/yyyy"/>
                                        <h:outputText value="Porcentaje: "/>
                                        <p:inputText value="#{condonacionView.porcentaje.porcentaje}"/>
                                    </p:panelGrid>
                                    <p:commandButton value="Agregar" actionListener="#{condonacionView.agregarPorcentaje()}" update="frmPorcentajeEdit"/>
                                </p:panelGrid>


                                <p:dataTable id="dtPorcentajes" value="#{condonacionView.porcentajesList}" var="porcentaje" 
                                             paginator="true" paginatorPosition="top" rows="5">
                                    <p:column headerText="Fecha de inicio">
                                        <center><h:outputFormat value="{0, date, dd-MM-yyyy}">
                                                <f:param value="#{porcentaje.fechaDesde}" />
                                            </h:outputFormat></center>
                                    </p:column>
                                    <p:column headerText="Fecha de fin">
                                        <center><h:outputFormat value="{0, date, dd-MM-yyyy}">
                                                <f:param value="#{porcentaje.fechaHasta}" />
                                            </h:outputFormat></center>
                                    </p:column>
                                    <p:column headerText="Porcentaje">
                                        <center><h:outputText value="#{porcentaje.porcentaje}"/></center>
                                    </p:column>
                                    <p:column headerText="Acción"> 
                                        <center><p:commandLink value="Eliminar" actionListener="#{condonacionView.eliminarPorcentaje(porcentaje)}" update="dtPorcentajes"/></center>
                                    </p:column>
                                </p:dataTable>
                            </div>

                        </p:panel>
                    
                        
                    </p:tab>
                    
                </p:accordionPanel>
                
                <center><p:commandButton value="Aceptar" update="frmMain" styleClass="btnStyle" style="margin-top: 15px;" onclick="PF('dlgPorcentajeEdit').hide()"/></center>

            </h:form>
        </p:dialog>
        
    </ui:define>
</ui:composition>