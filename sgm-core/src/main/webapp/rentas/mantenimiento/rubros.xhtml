<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE composition PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
                template="./../../template/template.xhtml"
                xmlns:h="http://xmlns.jcp.org/jsf/html" xmlns="http://www.w3.org/1999/xhtml"
                xmlns:p="http://primefaces.org/ui"
                xmlns:f="http://xmlns.jcp.org/jsf/core">

    <ui:define name="page_title">
        Tipo de Liquidación
    </ui:define>



    <ui:define name="content">
        <center>
            <h1>Lista de Tipos de Liquidaciones</h1>
        </center>
        <h:form id="frmMain">
            <div align="right">
<!--                <p:selectManyMenu value="#{tipoLiquidacionView.tiposLiquidaciones.activos}" >
                    <f:selectItem itemLabel="Activos" itemValue="#{true}"/>
                    <f:selectItem itemLabel="Inactivos" itemValue="#{false}"/>
                </p:selectManyMenu>-->
                <p:commandButton value="Nuevo tipo de liquidación" onclick="PF('dlgNew').show()" styleClass="btnStyle" update=":frmNew" style="float: right;" actionListener="#{tipoLiquidacionView.nuevoTipoLiquidacion}"/>
            </div>
            <p:dataTable id="tableTr" value="#{tipoLiquidacionView.tiposLiquidaciones}" var="tl" paginator="true" rows="20" 
                         lazy="true" reflow="true" rowsPerPageTemplate="20, 40, 50, 100" 
                         paginatorPosition="top" emptyMessage="No tiene datos" filterEvent="enter">

                <p:column headerText="Nombre Transacción" filterBy="#{tl.nombreTransaccion}" filterStyle="width: 90%;">
                    <center><h:outputText value="#{tl.nombreTransaccion}"/></center>
                </p:column>
                <p:column headerText="Nombre Título" filterBy="#{tl.nombreTitulo}" filterStyle="width: 90%;">
                    <center><h:outputText value="#{tl.nombreTitulo}"/></center>
                </p:column>
                <p:column headerText="Prefijo" filterBy="#{tl.prefijo}" filterStyle="width: 90%;">
                    <center><h:outputText value="#{tl.prefijo}"/></center>
                </p:column>
                <p:column headerText="Acción">
                    <center>
<!--                        <p:commandLink value="Eliminar" actionListener="#{tipoLiquidacionView.eliminarTitulo(tl)}" update="frmMain">
                            <p:confirm header="Confirmación" message="Esta seguro de continuar?" icon="ui-icon-alert"/>
                        </p:commandLink>-->
                        <p:spacer width="5" />
                        <p:commandLink value="Editar" actionListener="#{tipoLiquidacionView.setTipoLiquidacion(tl)}" update=":frmEdit" onclick="PF('dlgEdit').show()"/>
                        <p:spacer width="5" />
                        <p:commandLink value="Asignar rubros" actionListener="#{tipoLiquidacionView.asignarRubros(tl)}" update=":frmRubros"/>
                    </center>
                </p:column>
            </p:dataTable>
        </h:form>

        <p:dialog id="dlgNew" widgetVar="dlgNew"  header="Nuevo tipo de liquidación" appendTo="@(body)" modal="true" width="500" resizable="false" closable="true" closeOnEscape="true">
            <h:form id="frmNew">
                <center>
                    <p:panelGrid columns="2">
                        <h:outputText value="Nombre Transacción:"/>
                        <p:inputText value="#{tipoLiquidacionView.tipoLiquidacion.nombreTransaccion}"/>
                        <h:outputText value="Nombre Título:"/>
                        <p:inputText value="#{tipoLiquidacionView.tipoLiquidacion.nombreTitulo}"/>
                        <h:outputText value="Cta. Transacción:"/>
                        <p:inputText value="#{tipoLiquidacionView.tipoLiquidacion.ctaTransaccion}"/>
                        <h:outputText value="Prefijo:"/>
                        <p:inputText value="#{tipoLiquidacionView.tipoLiquidacion.prefijo}"/>
                        <h:outputText value="Nombre Reporte (Comprobante):"/>
                        <p:inputText value="#{tipoLiquidacionView.tipoLiquidacion.nombreReporte}"/>
                        <!--                        <h:outputText value="Estado:"/>
                                                <p:selectBooleanCheckbox value="# {tipoLiquidacionView.tipoLiquidacion.estado}"/>-->
                    </p:panelGrid>
                </center>
                <center style="margin-top: 10px;">
                    <p:commandButton value="Guardar" actionListener="#{tipoLiquidacionView.guardarNuevoTipoLiq()}" update=":frmMain" oncomplete="PF('dlgNew').hide()"/>
                    <p:commandButton value="Cancelar" onclick="PF('dlgNew').hide()"/>
                </center>
            </h:form>
        </p:dialog>

        <p:dialog id="dlgEdit" widgetVar="dlgEdit"  header="Editar tipo de liquidación" appendTo="@(body)" modal="true" width="500" resizable="false" closable="true" closeOnEscape="true">
            <h:form id="frmEdit">
                <center>
                    <p:panelGrid columns="2">
                        <h:outputText value="Nombre Transacción:"/>
                        <p:inputText value="#{tipoLiquidacionView.tipoLiquidacion.nombreTransaccion}"/>
                        <h:outputText value="Nombre Título:"/>
                        <p:inputText value="#{tipoLiquidacionView.tipoLiquidacion.nombreTitulo}"/>
                        <h:outputText value="Cta. Transacción:"/>
                        <p:inputText value="#{tipoLiquidacionView.tipoLiquidacion.ctaTransaccion}"/>
                        <h:outputText value="Prefijo:"/>
                        <p:inputText value="#{tipoLiquidacionView.tipoLiquidacion.prefijo}"/>
                        <h:outputText value="Nombre Reporte (Comprobante):"/>
                        <p:inputText value="#{tipoLiquidacionView.tipoLiquidacion.nombreReporte}"/>
                        <h:outputText value="Estado:"/>
                        <p:selectBooleanCheckbox value="#{tipoLiquidacionView.tipoLiquidacion.estado}"/>

                    </p:panelGrid>
                </center>

                <center style="margin-top: 10px;">
                    <p:commandButton value="Guardar" onclick="PF('dlgEdit').hide()" actionListener="#{tipoLiquidacionView.guardarEdicionTipoLiq()}" update=":frmMain"/>
                    <p:commandButton value="Cancelar" onclick="PF('dlgEdit').hide()"/>
                </center>
            </h:form>
        </p:dialog>


        <p:dialog id="dlgRubros" widgetVar="dlgRubros"  header="Agregar rubros al tipo de liquidación" appendTo="@(body)" modal="true" width="500" resizable="false" closable="true" closeOnEscape="true">
            <h:form id="frmRubros">
                <center>
                    <!--
                    <p:dataTable id="dtAsig" rows="5" paginator="true" var="tr" value="#{tipoLiquidacionView.transaccionesList}" reflow="true" rowKey="#{tr.id}"
                                 paginatorPosition="top" emptyMessage="No tiene datos" style="width: 480px; margin-top: 10px;">
                        <f:facet name="header">
                            Lista de transacciones para seleccionar
                        </f:facet>
                        <p:column headerText="Descripción" filterBy="#{tr.descripcion}">
                            <center><h:outputText value="#{tr.descripcion}"/></center>
                        </p:column>
                        <p:column headerText="Tipo">
                            <center><h:outputText value="#{tr.tipo.descripcion}"/></center>
                        </p:column>
                        <p:column headerText="Acción">
                            <center><p:commandButton value="Agregar" actionListener="#{tipoLiquidacionView.agregarTransaccion(tr)}" update="frmRubros"/></center>
                        </p:column>
                    </p:dataTable>
                    <p:dataTable id="dtRubros" rows="5" paginator="true" var="rubro" value="#{tipoLiquidacionView.rubrosList}" reflow="true" rowKey="#{rubro.transaccion.descripcion}"
                                 paginatorPosition="top" rowIndexVar="index"  emptyMessage="No tiene datos" style="width: 480px; margin-top: 10px;">
                        <f:facet name="header">
                            Lista de transacciones seleccionadas
                        </f:facet>
                        <p:column headerText="Descripción">
                            <center><h:outputText value="#{rubro.transaccion.descripcion}"/></center>
                        </p:column>
                        <p:column headerText="Tipo">
                            <center><h:outputText value="#{rubro.transaccion.tipo.descripcion}"/></center>
                        </p:column>
                        
                        <p:column headerText="Cta. Contable">
                            <center><p:inputText value="#{rubro.ctaContable}" style="width: 100px;"/></center>
                        </p:column>
                        <p:column headerText="Cta. Orden">
                            <center><p:inputText value="#{rubro.ctaOrden}" style="width: 100px;"/></center>
                        </p:column>
                        <p:column headerText="Cta. Presupuesto">
                            <center><p:inputText value="#{rubro.ctaPresupuesto}" style="width: 100px;"/></center>
                        </p:column>
                        <p:column headerText="Valor">
                            <center><p:inputText value="#{rubro.valor}" style="width: 100px;"/></center>
                        </p:column>
                        <p:column headerText="Tipo de Valor">
                            <center><p:selectOneMenu value="#{rubro.tipoValor}" converter="entityConverter">
                                    <f:selectItems value="#{tipoLiquidacionView.tipoValorList}" var="tipo" itemLabel="#{tipo.descripcion}" itemValue="#{tipo}"/>
                                    </p:selectOneMenu></center>
                        </p:column>
                    
                        <p:column headerText="Acción">
                            <center><p:commandButton value="Eliminar" actionListener="#{tipoLiquidacionView.eliminarTransaccion(index)}" update="frmRubros"/></center>
                        </p:column>
                    </p:dataTable>
                    -->
                </center>

                <center style="margin-top: 10px;">
                    <p:commandButton value="Guardar" onclick="PF('dlgRubros').hide()" actionListener="#{tipoLiquidacionView.guardarRubros()}" update=":frmMain"/>
                    <p:commandButton value="Cancelar" onclick="PF('dlgRubros').hide()"/>
                </center>
            </h:form>
        </p:dialog>
    </ui:define>
</ui:composition>