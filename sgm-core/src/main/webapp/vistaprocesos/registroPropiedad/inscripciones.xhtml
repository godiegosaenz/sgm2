<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE composition PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition 
    xmlns="http://www.w3.org/1999/xhtml"
    template="/template/template.xhtml"
    xmlns:f="http://xmlns.jcp.org/jsf/core"
    xmlns:h="http://xmlns.jcp.org/jsf/html" xmlns="http://www.w3.org/1999/xhtml"
    xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
    xmlns:p="http://primefaces.org/ui">
    <ui:define name="metadata">
        <f:metadata>
            <f:event type="preRenderView" listener="#{inscripciones.doPreRenderView()}"/>
        </f:metadata>
    </ui:define>
    <ui:define name="content">
        <h:form id="mainForm">
            <p:panelGrid styleClass="noBorder" style="width: 100%">
                <p:outputLabel value="Inscripciones Ingresadas" style="font-size: 24px;"/>
                <p:commandButton value="Imprimir Repertorio" icon="ui-icon-print" style="float: right"
                                 styleClass="btnStyle" actionListener="#{inscripciones.showDlgRepertorios()}"/>
                <p:spacer width="5" height="1" style="float: right;"/>
                <p:commandButton value="Inscripcion Antigua" icon="ui-icon-arrowreturnthick-1-w" style="float: right" styleClass="btnStyle" 
                                 actionListener="#{inscripciones.redirectFacelet('/vistaprocesos/registroPropiedad/inscripcionNuevaDirecta.xhtml')}"/>
                <p:spacer width="5" height="1" style="float: right;"/>
                <p:commandButton value="Secuencia Inscripcion" icon="ui-icon-shuffle" style="float: right" styleClass="btnStyle" 
                                 actionListener="#{inscripciones.redirectFacelet('/vistaprocesos/registroPropiedad/inscripcionSecuencial.xhtml')}"/>
            </p:panelGrid>
            <p:dataTable id="dtMovimientos" reflow="true" paginator="true" lazy="true" rows="30" rowsPerPageTemplate="30,50,100" 
                         paginatorTemplate="{FirstPageLink} {PreviousPageLink} {PageLinks} {CurrentPageReport} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
                         value="#{inscripciones.movimientosLazy}" var="mov" emptyMessage="No se encontró ningún Item."
                         style="text-align: center;" filterEvent="enter" resizableColumns="true">
                <p:column headerText="Libro" filterBy="#{mov.libro.nombre}" filterStyle="width: 95%">
                    <h:outputText  value="#{mov.libro.nombre}"/>
                </p:column>
                <p:column headerText="Acto" filterBy="#{mov.acto.nombre}" filterStyle="width: 95%">
                    <h:outputText  value="#{mov.acto.nombre}"/>
                </p:column>
                <p:column headerText="Inscripcion" filterBy="#{mov.numInscripcion}" filterStyle="width: 95%"
                          sortBy="#{mov.numInscripcion}" width="100">
                    <h:outputText value="#{mov.numInscripcion}"/>
                </p:column>
                <p:column headerText="Repertorio"  filterBy="#{mov.numRepertorio}" filterStyle="width: 95%"
                          sortBy="#{mov.numRepertorio}" width="100">
                    <h:outputText value="#{mov.numRepertorio}"/>
                </p:column> 
                <p:column headerText="Folio" filterBy="#{mov.folioInicio}" sortBy="#{mov.folioInicio}" width="100"
                          filterStyle="width: 90%">
                    <h:outputText value="#{mov.folioInicio}"/>
                </p:column>
                <p:column headerText="Fec.Inscripcion" sortBy="#{mov.fechaInscripcion}" width="100">
                    <h:outputText value="#{mov.fechaInscripcion}">
                        <f:convertDateTime pattern="dd/MM/yyyy"/>
                    </h:outputText>
                </p:column>
                <p:column headerText="Sec." filterBy="#{mov.indice}" sortBy="#{mov.indice}" width="60" filterStyle="width: 99%">
                    <h:outputText value="#{mov.indice}"/>
                </p:column>
                <p:column headerText="Editar" width="50">
                    <p:commandLink actionListener="#{inscripciones.editarInscripcion(mov)}">
                        <p:graphicImage value="/css/homeIconsImages/edit.png"/>   
                    </p:commandLink>
                </p:column>    
                <p:column headerText="Razon" width="50">
                    <p:commandLink actionListener="#{inscripciones.imprimirRazon(mov)}">
                        <p:graphicImage value="/css/homeIconsImages/reporte.png" height="16"/>   
                    </p:commandLink>
                </p:column>
                <p:column headerText="Inscrip.1" width="65">
                    <p:commandLink actionListener="#{inscripciones.imprimirInscripcion(mov,'RegistroInscripcion')}">
                        <p:graphicImage value="/css/homeIconsImages/reporte.png" height="16"/>   
                    </p:commandLink>
                </p:column>
                <p:column headerText="Inscrip.2" width="65">
                    <p:commandLink actionListener="#{inscripciones.imprimirInscripcion(mov,'RegistroInscripcionMaximo')}">
                        <p:graphicImage value="/css/homeIconsImages/reporte.png" height="16"/>   
                    </p:commandLink>
                </p:column>
                <p:column headerText="Selec." width="50">
                    <p:commandLink actionListener="#{inscripciones.showDlgMovSelect(mov)}">
                        <p:graphicImage value="/css/homeIconsImages/abrir.png" height="16"/>   
                    </p:commandLink>
                </p:column>
            </p:dataTable>
        </h:form>

        <p:dialog id="dlgBuscarRepertorio" header="Consulta Repertorio" widgetVar="dlgRepertorio" resizable="false" 
                  modal="true" position="center" width="240" height="300">
            <h:form id="frmConsultarRepertorio">
                <p:panelGrid styleClass="noBorder" columns="1" style="width: 100%;text-align: center">
                    <h:outputText value="Fecha ingreso: " style="font-weight: bolder;font-size: 14px"/>
                    <p:calendar value="#{inscripciones.fechaIngreso}" mode="inline"/>
                    <p:commandButton value="Imprimir Repertorio" icon="ui-icon-print" styleClass="btnStyle"
                                     actionListener="#{inscripciones.imprimirRepertorios()}" style="float: end"/>
                </p:panelGrid>
            </h:form>
        </p:dialog>   

        <p:dialog id="dlgMovimientoRegistral" header="Movimiento Registral Seleccionado" widgetVar="dlgMovRegSelec" 
                  resizable="false" modal="true" closeOnEscape="true" width="800" height="550">
            <h:form id="formMovRegSelec">
                <p:fieldset legend="Datos de la Inscripcion">
                    <p:panelGrid styleClass="noBorder" style="width: 100%;font-size: 12px;font-weight: bolder;">
                        <p:row>
                            <p:column>
                                Num.Inscrip.:
                                <p:outputLabel value="#{inscripciones.movimiento.numInscripcion}"/>
                            </p:column>
                            <p:column>
                                Fecha Inscrip.:
                                <p:outputLabel value="#{inscripciones.movimiento.fechaInscripcion}">
                                    <f:convertDateTime pattern="dd/MM/yyyy"/>
                                </p:outputLabel>
                            </p:column>
                            <p:column>
                                Num.Rep.: 
                                <p:outputLabel  value="#{inscripciones.movimiento.numRepertorio}"/>
                            </p:column>
                        </p:row>                  
                        <p:row>
                            <p:column>
                                Libro: 
                                <p:outputLabel value="#{inscripciones.movimiento.libro.nombre}"/>
                            </p:column>
                            <p:column colspan="2">
                                Acto: 
                                <p:outputLabel value="#{inscripciones.movimiento.acto.nombre}"/>
                            </p:column>
                        </p:row>                  
                        <p:row>
                            <p:column>
                                Tomo: 
                                <p:outputLabel value="#{inscripciones.movimiento.numTomo}"/>
                            </p:column>
                            <p:column>
                                Folio Inicio: 
                                <p:outputLabel value="#{inscripciones.movimiento.folioInicio}"/>
                            </p:column>
                            <p:column>
                                Folio Fin: 
                                <p:outputLabel value="#{inscripciones.movimiento.folioFin}"/>
                            </p:column>
                        </p:row>
                        <p:row>
                            <p:column>
                                Canton: 
                                <p:outputLabel value="#{inscripciones.movimiento.codigoCan.nombre}"/>
                            </p:column>
                            <p:column>
                                Fech/Otorg.:
                                <p:outputLabel value="#{inscripciones.movimiento.fechaOto}">
                                    <f:convertDateTime pattern="dd/MM/yyyy"/>
                                </p:outputLabel>
                            </p:column>
                            <p:column>
                                Not./Juz.: 
                                <p:outputLabel value="#{inscripciones.movimiento.enteJudicial.nombre}"/>
                            </p:column>
                        </p:row>
                        <p:row>
                            <p:column>
                                Escri/Juicio/Resolu: 
                                <p:outputLabel value="#{inscripciones.movimiento.escritJuicProvResolucion}"/>
                            </p:column>
                            <p:column>
                                Estado/Mov: 
                                <p:outputLabel value="#{inscripciones.movimiento.estado}"/>
                            </p:column>
                            <p:column style="text-align: right">
                                <p:commandButton value="Bitacora" icon="ui-icon-document" styleClass="btnStyle"
                                                 actionListener="#{inscripciones.imprimirBitacora()}"/>
                            </p:column>
                        </p:row>
                    </p:panelGrid>
                </p:fieldset>
                <p:tabView>
                    <p:tab title="Intervinientes">
                        <p:dataTable emptyMessage="No hay datos para mostrar..." var="inter" scrollable="true" 
                                     value="#{inscripciones.modelo.listMovCli}" scrollHeight="240">
                            <p:column headerText="C.I/R.U.C" style="text-align: center" width="15%">
                                <p:outputLabel value="#{inter.enteInterv.cedRuc}"/>
                                <!-- <p:outputLabel value="# {inter.ente.catEntePersona.ci}" rendered="# {inter.ente.isPersona}"/> -->
                            </p:column>
                            <p:column headerText="Nombre del Cliente" style="text-align: center">
                                <p:outputLabel value="#{inter.enteInterv.nombre}"/>
                                <!-- <p:outputLabel value="# {inter.ente.catEntePersona.nombres} # {inter.ente.catEntePersona.apellidos}" rendered="# {inter.ente.isPersona}"/> -->
                            </p:column>
                            <p:column headerText="Papel" style="text-align: center" width="20%">
                                <p:outputLabel value="#{inter.papel.papel}"/>
                            </p:column>
                            <p:column headerText="Domicilio" style="text-align: center">
                                <p:outputLabel value="#{inter.domicilio.nombre}"/>
                            </p:column>
                            <p:column headerText="Estado" style="text-align: center">
                                <p:outputLabel value="#{inter.estado}"/>
                            </p:column>
                            <p:column headerText="Relacion" style="text-align: center">
                                <p:outputLabel value="#{inter.nombres}"/>
                            </p:column>
                        </p:dataTable>
                    </p:tab>
                    <!-- SE COMENTA Representantes-Socios-Capital 09-01-2016 -->
                    <!--<p:tab title="Representantes">
                        <p:dataTable emptyMessage="No hay datos para mostrar..." var="rep" scrollable="true" 
                                     value="# {inscripciones.modelo.lisMovRep}" scrollHeight="250">
                            <p:column headerText="C.I/R.U.C" style="text-align: center" width="15%">
                                <p:outputLabel value="# {rep.enteInterv.cedRuc}"/> -->
                    <!-- <p:outputLabel value="# {rep.ente.catEntePersona.ci}" rendered="# {rep.ente.isPersona}"/> -->
                    <!--    </p:column>
                            <p:column headerText="Nombre del Cliente" style="text-align: center">
                                <p:outputLabel value="# {rep.enteInterv.nombre}"/> -->
                    <!-- <p:outputLabel value="# {rep.ente.catEntePersona.nombres} # {rep.ente.catEntePersona.apellidos}" rendered="# {rep.ente.isPersona}"/> -->
                    <!--    </p:column>
                            <p:column headerText="Cargo" style="text-align: center" width="20%">
                                <p:outputLabel value="# {rep.enteInterv.nombre}"/>
                            </p:column>
                        </p:dataTable>
                    </p:tab> -->
                    <!--<p:tab title="Socios">
                        <p:dataTable emptyMessage="No hay datos para mostrar..." value="# {inscripciones.modelo.listMovSoc}" 
                                     var="soc" scrollable="true"  scrollHeight="250">
                            <p:column headerText="C.I/R.U.C" style="text-align: center">
                                <p:outputLabel value="# {soc.enteInterv.cedRuc}" />
                            </p:column>
                            <p:column headerText="Nombre del Cliente" style="text-align: center">
                                <p:outputLabel value="# {soc.enteInterv.nombre}" />
                            </p:column>
                            <p:column headerText="Tipo Participacion" style="text-align: center">
                                <p:outputLabel value="# {soc.tipoParticipacion.nombre}"/>
                            </p:column>
                            <p:column headerText="Cantidad" style="text-align: center">
                                <p:outputLabel value="# {soc.cantidad}"/>
                            </p:column>
                            <p:column headerText="Valor" style="text-align: center">
                                <p:outputLabel value="# {soc.valor}"/>
                            </p:column>
                        </p:dataTable>
                    </p:tab> -->
                    <!--<p:tab title="Capital">
                        <p:dataTable emptyMessage="No hay datos para mostrar..." scrollHeight="250"
                                     value="# {inscripciones.modelo.listMovCap}" var="cap" scrollable="true"  >
                            <p:column headerText="Capital" style="text-align: center">
                                <p:outputLabel value="# {cap.capital.nombre}"/>
                            </p:column>
                            <p:column headerText="Valor" style="text-align: center">
                                <p:outputLabel value="# {cap.valor}"/>
                            </p:column>
                        </p:dataTable>
                    </p:tab> -->
                    <p:tab title="Bienes">
                        <p:dataTable value="#{inscripciones.modelo.fichas}" var="fich" style="width: 100%;text-align: center" scrollable="true" 
                                     scrollHeight="250" rowIndexVar="rowIndex" emptyMessage="No se encontraron elementos...">
                            <p:column headerText="No" width="60">
                                #{rowIndex+1}
                            </p:column>
                            <p:column headerText="Num. Ficha" width="100">
                                <p:outputLabel value="#{fich.numFicha}"/>
                            </p:column>
                            <p:column headerText="Tipo Ficha">
                                <p:outputLabel value="#{fich.tipo.nombre}"/>
                            </p:column>
                            <p:column headerText="Codigo Predial">
                                <p:outputLabel value="#{fich.codigoPredial}"/>
                            </p:column>
                            <p:column headerText="Fec.Apertura" width="100">
                                <p:outputLabel value="#{fich.fechaApe}">
                                    <f:convertDateTime pattern="dd/MM/yyyy"/>
                                </p:outputLabel>
                            </p:column>
                        </p:dataTable>
                    </p:tab>
                    <p:tab title="Observacion">
                        <p:inputTextarea value="#{inscripciones.movimiento.observacion}" readonly="true"
                                         autoResize="false" scrollHeight="200" style="width: 100%; height: 250px"/>
                    </p:tab>
                    <p:tab title="Referencia(s)">
                        <p:dataTable style="text-align: center;width: 100%" scrollable="true" scrollHeight="250" scrollWidth="1000" rowIndexVar="indexMovRef"
                                     value="#{inscripciones.modelo.listMovRef}" var="movRef" 
                                     emptyMessage="Movimiento sin referencia(s)." resizableColumns="true">
                            <p:column headerText="No" width="30">
                                #{indexMovRef+1}
                            </p:column>
                            <p:column headerText="Libro">
                                <p:outputLabel value="#{movRef.movimientoReff.libro.nombre}"/>
                            </p:column>
                            <p:column headerText="Acto">
                                <p:outputLabel value="#{movRef.movimientoReff.acto.nombre}"/>
                            </p:column>
                            <p:column headerText="Inscripcion" width="100">
                                <p:outputLabel value="#{movRef.movimientoReff.numInscripcion}"/>                                   
                            </p:column>
                            <p:column headerText="Repertorio" width="100">
                                <p:outputLabel value="#{movRef.movimientoReff.numRepertorio}"/>                                   
                            </p:column>
                            <p:column headerText="Folio" width="100">
                                <p:outputLabel value="#{movRef.movimientoReff.folioInicio}"/>                                   
                            </p:column>
                            <p:column headerText="Fec.Inscripcion" width="110">
                                <p:outputLabel value="#{movRef.movimientoReff.fechaInscripcion}">
                                    <f:convertDateTime pattern="dd/MM/yyyy"/>
                                </p:outputLabel>                                   
                            </p:column>
                        </p:dataTable>
                    </p:tab>
                    <p:tab title="Descarga">
                        <iframe src="#{samdocUploadCompUtil.samdocUrl}#{inscripciones.urlDownload}"></iframe>
                    </p:tab>
                </p:tabView>
            </h:form>
        </p:dialog>

    </ui:define>
</ui:composition>
