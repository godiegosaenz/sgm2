<ui:composition 
    xmlns="http://www.w3.org/1999/xhtml"
    template="/template/template.xhtml"
    xmlns:f="http://xmlns.jcp.org/jsf/core"
    xmlns:h="http://xmlns.jcp.org/jsf/html" xmlns="http://www.w3.org/1999/xhtml"
    xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
    xmlns:p="http://primefaces.org/ui">
    <ui:define name="metadata">
        <f:metadata>
            <f:event type="preRenderView" listener="#{entregaDocumentosRp.doPreRenderView()}"/>
        </f:metadata>
    </ui:define>
    <ui:define name="content">
        <h:form id="mainForm">
            <p:panelGrid styleClass="noBorder" columns="4" style="width: 100%;font-size: 14px;">
                <p:outputLabel value="Tarea: #{entregaDocumentosRp.taskDataByTaskID.name}" style="font-weight: bolder;color: #005f9c"/>
                <p:outputLabel value="No Seguimiento: #{entregaDocumentosRp.ht.id}" style="font-weight: bolder;color: #005f9c"/>
                <p:outputLabel value="No Tramite: #{entregaDocumentosRp.ht.numTramiteXDepartamento}" style="font-weight: bolder;color: #005f9c"/>
            </p:panelGrid>
            <p:tabView id="mainTab">
                <p:tab title="Tarea">
                    <center>
                        <p:panelGrid id="panelSolicitante" style="width: 500px;" styleClass="noBorder">
                            <f:facet name="header">  
                                <p:row>  
                                    <p:column colspan="4">
                                        <h:outputText value="INFORMACION DE PERSONA" />
                                    </p:column>  
                                </p:row>
                            </f:facet>
                            <p:row>
                                <p:column>
                                    <p:outputLabel value="C.I.:" style="font-weight: bolder"/>
                                </p:column>
                                <p:column>
                                    <p:inputText value="#{entregaDocumentosRp.solicitante.ciRuc}"/>
                                </p:column>
                                <p:column>
                                    <p:commandButton value="Buscar" icon="ui-icon-search" update="panelSolicitante" styleClass="btnStyle"
                                                     actionListener="#{entregaDocumentosRp.buscarSolicitante()}"/>
                                </p:column>
                                <p:column>
                                    <p:commandButton value="Editar" icon="ui-icon-pencil" styleClass="btnStyle"
                                                     actionListener="#{entregaDocumentosRp.showDlgEditarSol()}"/>
                                </p:column>
                            </p:row>
                            <p:row>
                                <p:column>
                                    <p:outputLabel value="Nombres:" style="font-weight: bolder"/>
                                </p:column>
                                <p:column colspan="3">
                                    <p:inputText value="#{entregaDocumentosRp.solicitante.nombres}" style="width: 100%" readonly="true"/>
                                </p:column>
                            </p:row>
                            <p:row>
                                <p:column>
                                    <p:outputLabel value="Apellidos:" style="font-weight: bolder"/>
                                </p:column>
                                <p:column colspan="3">
                                    <p:inputText value="#{entregaDocumentosRp.solicitante.apellidos}" style="width: 100%" readonly="true"/>
                                </p:column>
                            </p:row>
                            <p:row>
                                <p:column>
                                    <p:outputLabel value="Dirección:" style="font-weight: bolder"/>
                                </p:column>
                                <p:column colspan="3">
                                    <p:inputText value="#{entregaDocumentosRp.solicitante.direccion}" style="width: 100%" readonly="true"/>
                                </p:column>
                            </p:row>
                            <p:row>
                                <p:column colspan="4">
                                    <p:dataTable value="#{entregaDocumentosRp.solicitante.enteCorreoCollection}" emptyMessage="Sin elementos..."
                                                 var="cor" scrollable="true" scrollHeight="80">
                                        <p:column headerText="Correos" style="text-align: center">
                                            <p:outputLabel value="#{cor.email}"/>
                                        </p:column>
                                    </p:dataTable>
                                </p:column>
                            </p:row>
                            <p:row>
                                <p:column colspan="4">
                                    <p:dataTable value="#{entregaDocumentosRp.solicitante.enteTelefonoCollection}" emptyMessage="Sin elementos..."
                                                 var="tlf" scrollable="true" scrollHeight="80">
                                        <p:column headerText="Teléfonos" style="text-align: center">
                                            <p:outputLabel value="#{tlf.telefono}"/>
                                        </p:column>
                                    </p:dataTable>
                                </p:column>
                            </p:row>
                            <p:row>
                                <p:column colspan="4" style="text-align: center">
                                    <p:commandButton value="Completar Tarea" icon="ui-icon-check" styleClass="btnStyle"
                                                     actionListener="#{entregaDocumentosRp.completarTarea()}"/>
                                </p:column>
                            </p:row>
                        </p:panelGrid>
                    </center>
                </p:tab>
                <p:tab title="Detalle">
                    <p:panelGrid style="margin: 0 auto">
                        <p:row>
                            <p:column>
                                <p:dataTable value="#{entregaDocumentosRp.liq.regpIntervinientesCollection}"
                                             var="inter" style="text-align: center;width: 500px" scrollable="true" scrollHeight="250">
                                    <f:facet name="header">
                                        Intervinientes
                                    </f:facet>
                                    <p:column headerText="Nombres">
                                        <p:outputLabel value="#{inter.nombres}"/>
                                    </p:column>
                                    <p:column headerText="Papel" width="200">
                                        <p:outputLabel value="#{inter.papel.papel}"/>
                                    </p:column>
                                </p:dataTable>
                            </p:column>
                            <p:column>
                                <p:dataTable value="#{entregaDocumentosRp.liq.regpLiquidacionDetallesCollection}"
                                             var="det" style="text-align: center;width: 500px" scrollable="true" scrollHeight="250">
                                    <f:facet name="header">
                                        Actos del Tramite
                                    </f:facet>
                                    <p:column headerText="Acto">
                                        <p:outputLabel value="#{det.acto.nombre}"/>
                                    </p:column>
                                    <p:column headerText="Cantidad" width="70">
                                        <p:outputLabel value="#{det.cantidad}"/>
                                    </p:column>
                                </p:dataTable>
                            </p:column>
                        </p:row>
                    </p:panelGrid>
                </p:tab>
                <p:tab title="Observaciones">
                    <p:dataTable value="#{entregaDocumentosRp.ht.observacionesCollection}" var="obs" reflow="true"
                                 style="text-align: center" emptyMessage="Sin observaciones..."
                                 scrollable="true" scrollHeight="300">
                        <p:column headerText="Observacion">
                            <h:outputText value="#{obs.observacion}"/>
                        </p:column>
                        <p:column headerText="Tarea" width="250">
                            <h:outputText value="#{obs.tarea}"/>
                        </p:column>
                        <p:column headerText="Responsable" width="150">
                            <h:outputText value="#{obs.userCre}"/>
                        </p:column>
                        <p:column headerText="Fecha" width="150">
                            <h:outputText value="#{obs.fecCre}">
                                <f:convertDateTime pattern="dd-MM-yyyy HH:mm"/>
                            </h:outputText>
                        </p:column>
                    </p:dataTable>
                </p:tab>
            </p:tabView>
        </h:form>

        <p:dialog id="dlgSolicitante" header="Datos de Persona" widgetVar="dlgSolInf" resizable="false" modal="true" 
                  position="center" closable="false">
            <h:form id="formSolicitante">
                <p:panelGrid styleClass="noBorder" style="width: 400px">
                    <p:row>
                        <p:column>
                            <p:outputLabel value="Cédula:" style="font-weight: bolder"/>
                        </p:column>
                        <p:column>
                            <p:inputText value="#{entregaDocumentosRp.persona.ciRuc}" readonly="true"/>
                        </p:column>
                    </p:row>
                    <p:row>
                        <p:column>
                            <p:outputLabel value="Nombres:" style="font-weight: bolder"/>
                        </p:column>
                        <p:column>
                            <p:inputText value="#{entregaDocumentosRp.persona.nombres}" style="width: 100%"/>
                        </p:column>
                    </p:row>
                    <p:row>
                        <p:column>
                            <p:outputLabel value="Apellidos:" style="font-weight: bolder"/>
                        </p:column>
                        <p:column>
                            <p:inputText value="#{entregaDocumentosRp.persona.apellidos}" style="width: 100%"/>
                        </p:column>
                    </p:row>
                    <p:row>
                        <p:column>
                            <p:outputLabel value="Dirección :"/>
                        </p:column>
                        <p:column>
                            <p:inputText value="#{entregaDocumentosRp.persona.direccion}" style="width: 100%"/>
                        </p:column>
                    </p:row>
                    <p:row>
                        <p:column colspan="2">
                            <p:commandLink value="SI CLIENTE NO POSEE CORREO DE CLIC AQUI." style="font-weight: bolder;color: #0033FF"
                                           actionListener="#{entregaDocumentosRp.agregarCorreoGenerico()}" update="dtEmailPer"/>
                        </p:column>
                    </p:row>
                    <p:row>
                        <p:column>
                            <p:outputLabel value="Email:" style="font-weight: bolder"/>
                        </p:column>
                        <p:column>
                            <p:inputText id="labelEmail" value="#{entregaDocumentosRp.emailNew}" size="35" placeholder="Ejemplo: correo@ejemplo.com"/>
                            <p:spacer width="15" height="1"/>
                            <p:commandButton value="Agregar" icon="ui-icon-plus" update="dtEmailPer,labelEmail"
                                             actionListener="#{entregaDocumentosRp.agregarEmail()}" />
                        </p:column>
                    </p:row>
                    <p:row>
                        <p:column colspan="2">
                            <p:dataTable id="dtEmailPer" value="#{entregaDocumentosRp.persona.enteCorreoCollection}" var="mail" scrollable="true" scrollHeight="80">
                                <p:column headerText="Email" style="text-align: center">
                                    <p:outputLabel value="#{mail.email}"/>
                                </p:column>
                                <p:column headerText="Acción" style="text-align: center" width="60">
                                    <p:commandLink value="Eliminar" actionListener="#{entregaDocumentosRp.eliminarEmail(mail)}" 
                                                   update="dtEmailPer" style="color: #0033FF;font-weight: bolder"/>
                                </p:column>
                            </p:dataTable>
                        </p:column>
                    </p:row>
                    <p:row>
                        <p:column>
                            <p:outputLabel value="Teléfono:" style="font-weight: bolder"/>
                        </p:column>
                        <p:column>
                            <p:inputText id="labelTelef" value="#{entregaDocumentosRp.tlfnNew}" size="35" placeholder="Ejemplo: 045555555 ó 0988888888"/>
                            <p:spacer width="20" height="1"/>
                            <p:commandButton value="Agregar" actionListener="#{entregaDocumentosRp.agregarTlfn()}" 
                                             update="dtTelefPer,labelTelef" icon="ui-icon-plus"/>
                        </p:column>
                    </p:row>
                    <p:row>
                        <p:column colspan="2">
                            <p:dataTable id="dtTelefPer" value="#{entregaDocumentosRp.persona.enteTelefonoCollection}" var="tlfn" scrollable="true" scrollHeight="80">
                                <p:column headerText="Teléfono" style="text-align: center" >
                                    <p:outputLabel value="#{tlfn.telefono}"/>
                                </p:column>
                                <p:column headerText="Acción" style="text-align: center" width="60">
                                    <p:commandLink value="Eliminar" actionListener="#{entregaDocumentosRp.eliminarTlfn(tlfn)}"
                                                   style="color: #0033FF;font-weight: bolder" update="dtTelefPer" />
                                </p:column>
                            </p:dataTable>
                        </p:column>
                    </p:row>
                    <p:row>
                        <p:column colspan="2" style="text-align: center">
                            <p:commandButton value="Guardar" icon="ui-icon-disk" styleClass="btnStyle"
                                             actionListener="#{entregaDocumentosRp.guardarSolicitante()}"/>
                            <p:spacer width="40" height="1"/>
                            <p:commandButton value="Cancelar" icon="ui-icon-cancel" styleClass="btnStyle" oncomplete="PF('dlgSolInf').hide();"
                                             actionListener="#{entregaDocumentosRp.inicializarVariables()}"/>
                        </p:column>
                    </p:row>
                </p:panelGrid>
            </h:form>
        </p:dialog>

    </ui:define>
</ui:composition>

