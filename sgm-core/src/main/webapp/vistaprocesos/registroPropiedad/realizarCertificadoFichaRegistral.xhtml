<ui:composition 
    xmlns="http://www.w3.org/1999/xhtml"
    template="/template/template.xhtml"
    xmlns:f="http://xmlns.jcp.org/jsf/core"
    xmlns:h="http://xmlns.jcp.org/jsf/html" xmlns="http://www.w3.org/1999/xhtml"
    xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
    xmlns:p="http://primefaces.org/ui"
    xmlns:pe="http://primefaces.org/ui/extensions">
    <ui:define name="metadata">
        <f:metadata>
            <f:viewParam name="code" value="#{realizarCertificadoFichaRegistral.idTarea}" />
            <f:event type="preRenderView" listener="#{realizarCertificadoFichaRegistral.doPreRenderView}"/>
        </f:metadata>
    </ui:define>
    <ui:define name="top">
        <h3>Certificado Ficha Registral</h3>
    </ui:define>
    <ui:define name="content">
        <h:form id="mainForm">
            <p:fieldset legend="Busqueda">
                <h:panelGrid columns="3" width="30%">
                    <p:outputLabel value="Num.Ficha:" style="font-size: 17px;"/>
                    <pe:inputNumber value="#{realizarCertificadoFichaRegistral.numeroFicha}" decimalPlaces="0"/>
                    <p:commandButton value="Buscar" styleClass="btnStyle" icon="ui-icon-search"
                                     actionListener="#{realizarCertificadoFichaRegistral.buscarFichaRegistral()}" />
                </h:panelGrid>
            </p:fieldset>
            <p:spacer height="10"/>
            <p:fieldset legend="Datos Ficha Registral">
                <p:panelGrid columns="6" styleClass="noBorder" style="width: 60%">
                    <p:outputLabel value="Num. Ficha :" style="font-weight: bolder;font-size: 12px;"/>
                    <p:outputLabel value="#{realizarCertificadoFichaRegistral.regFicha.numFicha}" style="font-weight: bolder;font-size: 12px;"/>
                    <p:outputLabel value="Fec. Apertura :" style="font-weight: bolder;font-size: 12px;"/>
                    <p:outputLabel value="#{realizarCertificadoFichaRegistral.regFicha.fechaApe}" style="font-weight: bolder;font-size: 12px;">
                        <f:convertDateTime pattern="dd/MM/yyyy"/>
                    </p:outputLabel>
                    <p:outputLabel value="Estado :" style="font-weight: bolder;font-size: 12px;"/>
                    <p:outputLabel value="#{realizarCertificadoFichaRegistral.regFicha.estado.valor}" style="font-weight: bolder;font-size: 12px;"/>
                </p:panelGrid>
                <p:tabView id="fichaPanel">
                    <p:tab title="Linderos Registrales">
                        <p:inputTextarea value="#{realizarCertificadoFichaRegistral.regFicha.linderos}" 
                                         cols="140" rows="14" readonly="true" scrollHeight="300"/> 
                    </p:tab>
                    <p:tab id="movimientosFicha" title="Movimientos Registrales">
                        <!--<div align="right"><p:commandButton icon="ui-icon-plus" value="Agregar Movimiento" onclick="PF('movimientosRegistralesDlg').show();" styleClass="btnStyle" style="height: 30px;" rendered="# {realizarCertificadoFichaRegistral.regFicha ne null}"/></div>-->
                        <p:dataTable id="dtMovimientosFicha" value="#{realizarCertificadoFichaRegistral.movimientosFicha}" var="movimiento" style="width: 100%; margin: 0px;"
                                     emptyMessage="No se encontraron elementos..." scrollHeight="300" scrollable="true" rowIndexVar="rowIndex">
                            <p:column headerText="N°" style="width: 40px">
                                #{rowIndex+1}
                            </p:column>
                            <p:column headerText="Libro">
                                <p:outputLabel value="#{movimiento.libro.nombre}"/>
                            </p:column>
                            <p:column headerText="Acto">
                                <p:outputLabel value="#{movimiento.acto.nombre}"/>
                            </p:column>
                            <p:column headerText="Inscripcion" width="120">
                                <p:outputLabel value="#{movimiento.numInscripcion}"/>
                            </p:column>
                            <p:column headerText="Repertorio" width="100">
                                <p:outputLabel value="#{movimiento.numRepertorio}"/>
                            </p:column>
                            <p:column headerText="Folio" width="100">
                                <p:outputLabel value="#{movimiento.folioInicio}"/>
                            </p:column>
                            <p:column headerText="Fec.Inscripcion" width="120">
                                <p:outputLabel value="#{movimiento.fechaInscripcion}">
                                    <f:convertDateTime pattern="dd/MM/yyyy"/>
                                </p:outputLabel>
                            </p:column>
                            <!--<p:column headerText="Accion" width="70px;">
                                <p:commandLink value="Eliminar" style="color: #0033FF; font-weight: bold;" rendered="# {movimiento.id eq null}" actionListener="# {realizarCertificadoFichaRegistral.eliminarMovimiento(movimiento)}" update="mainForm:fichaPanel"/>
                            </p:column>-->
                        </p:dataTable>
                    </p:tab>
                    <p:tab title="Estado">
                        <p:inputTextarea value="#{realizarCertificadoFichaRegistral.regFicha.descripcionTemp}" style="font-weight: bolder;color: #0033FF;font-size: 14px;"
                                         cols="120" rows="10" readonly="true"/>
                    </p:tab>
                    <!--<p:tab title="Información Catastral">
                        <h:panelGrid columns="4" cellpadding="5">
                            <p:outputLabel value="Num. Predio :" style="font-size: 17px;"/>
                            <p:inputText value="# {realizarCertificadoFichaRegistral.numeroPredio}" size="10"/>
                            <p:spacer width="20"/>
                            <p:commandButton value="Buscar"  styleClass="btnStyle" icon="ui-icon-search" iconPos="s" actionListener="#{realizarCertificadoFichaRegistral.buscarPredio()}" update=":mainForm:fichaPanel"/>
                        </h:panelGrid>
                        <p:accordionPanel id="predioPanel" style="width: 95%" rendered="# {realizarCertificadoFichaRegistral.predio ne null}">
                            <p:tab title="Datos Predio" titleStyle="background: #bdbdbd; font-weight: bolder; font-size: 12px;" >
                                <p:panelGrid columns="4" layout="grid" >
                                    <p:outputLabel value="Num. Predio :"/>      <p:inputText value="# {realizarCertificadoFichaRegistral.predio.numPredio}" readonly="true"/>
                                    <p:outputLabel value="Código Catastral :"/> <p:outputLabel value="# {realizarCertificadoFichaRegistral.predio.getCodigoPredial()}"/>
                                    <p:outputLabel value="Solar :"/>            <p:inputText value="# {realizarCertificadoFichaRegistral.predio.solar}" readonly="true"/>
                                    <p:outputLabel value="Manzana :"/>          <p:inputText value="# {realizarCertificadoFichaRegistral.predio.mz}" readonly="true"/>
                                </p:panelGrid>
                            </p:tab>
                            <p:tab title="Datos Propietario(s)" titleStyle="background: #bdbdbd; font-weight: bolder; font-size: 12px;">
                                <p:dataTable value="# {realizarCertificadoFichaRegistral.propietarios}" var="propietario" style="width: 100%">
                                    <p:column headerText="Tipo Propietario " style="text-align: center">
                                        <h:outputText value="# {propietario.tipo.valor}"/>
                                    </p:column>
                                    <p:column headerText="Apellido/Nombre " style="text-align: center">
                                        <h:outputText value="# {propietario.ente.razonSocial}" rendered="# {!propietario.ente.esPersona}"/>
                                        <h:outputText value="# {propietario.ente.apellidos} # {propietario.ente.nombres}" rendered="# {propietario.ente.esPersona}"/>
                                    </p:column>
                                    <p:column headerText="C.I. / R.U.C " style="text-align: center">
                                        <h:outputText value="# {propietario.ente.ciRuc}"/>
                                    </p:column>
                                    <p:column headerText="Email " style="text-align: center">
                                        <h:outputText value="# {realizarCertificadoFichaRegistral.getCorreo(propietario.ente)}" />
                                    </p:column>
                                </p:dataTable>
                            </p:tab>
                            <p:tab title="Linderos Según Escrituras" titleStyle="background: #bdbdbd; font-weight: bolder; font-size: 12px;">
                                <p:panelGrid style="width: 100%" columns="4" layout="grid">
                                    Norte :     <p:inputText value="# {realizarCertificadoFichaRegistral.escritura.lindEscrNorte}" maxlength="45" readonly="true"/>
                                    Con :       <pe:inputNumber value="# {realizarCertificadoFichaRegistral.escritura.lindEscrNorteCon}"/>
                                    Sur :       <p:inputText value="# {realizarCertificadoFichaRegistral.escritura.lindEscrSur}" maxlength="45" readonly="true"/>
                                    Con :       <pe:inputNumber value="# {realizarCertificadoFichaRegistral.escritura.lindEscrSurCon}"/>
                                    Este :      <p:inputText value="# {realizarCertificadoFichaRegistral.escritura.lindEscrEste}" maxlength="45" readonly="true"/>
                                    Con :       <pe:inputNumber value="# {realizarCertificadoFichaRegistral.escritura.lindEscrEsteCon}"/>
                                    Oeste :     <p:inputText value="# {realizarCertificadoFichaRegistral.escritura.lindEscrOeste}" maxlength="45" readonly="true"/>
                                    Con :       <pe:inputNumber value="# {realizarCertificadoFichaRegistral.escritura.lindEscrOesteCon}"/>
                                    Area mts2 : <pe:inputNumber value="# {realizarCertificadoFichaRegistral.escritura.areaSolar}"/>
                                    Alícuota :  <pe:inputNumber value="# {realizarCertificadoFichaRegistral.escritura.alicuota}" symbol="%" symbolPosition="s"/>
                                </p:panelGrid>
                            </p:tab>
                            <p:tab title="Linderos Según Levantamiento" titleStyle="background: #bdbdbd; font-weight: bolder; font-size: 12px;">
                                <p:panelGrid style="width: 100%" columns="4" layout="grid">
                                    Norte :     <p:inputText value="# {realizarCertificadoFichaRegistral.predio.catPredioS6.lindLevNorte}" readonly="true" />
                                    Con :       <p:inputText value="# {realizarCertificadoFichaRegistral.predio.catPredioS6.lindLevNorteCon}" readonly="true"/>
                                    Sur :       <p:inputText value="# {realizarCertificadoFichaRegistral.predio.catPredioS6.lindLevSur}" readonly="true" />
                                    Con :       <p:inputText value="# {realizarCertificadoFichaRegistral.predio.catPredioS6.lindLevSurCon}" readonly="true" />
                                    Este :      <p:inputText value="# {realizarCertificadoFichaRegistral.predio.catPredioS6.lindLevEste}" readonly="true" />
                                    Con :       <p:inputText value="# {realizarCertificadoFichaRegistral.predio.catPredioS6.lindLevEsteCon}" readonly="true" />
                                    Oeste :     <p:inputText value="# {realizarCertificadoFichaRegistral.predio.catPredioS6.lindLevOeste}" readonly="true" />
                                    Con :       <p:inputText value="# {realizarCertificadoFichaRegistral.predio.catPredioS6.lindLevOesteCon}" readonly="true" />
                                    Area mts2 : <p:inputText value="# {realizarCertificadoFichaRegistral.predio.catPredioS4.areaCalculada}" readonly="true" />
                                    Alícuota :% <p:inputText value="# {realizarCertificadoFichaRegistral.predio.catPredioS6.alicuota}" readonly="true" />                                
                                </p:panelGrid>
                            </p:tab>
                        </p:accordionPanel>
                    </p:tab>-->
                </p:tabView>
                <div style="width: 100%;">
                    <p:commandButton value="Certificado 1" icon="ui-icon-document" styleClass="btnStyle"
                                     actionListener="#{realizarCertificadoFichaRegistral.imprimirFichaRegistral('fichaRegistralBienInmueble')}"/>
                    <p:spacer width="20" height="1"/>
                    <p:commandButton value="Certificado 2" icon="ui-icon-document" styleClass="btnStyle"
                                     actionListener="#{realizarCertificadoFichaRegistral.imprimirFichaRegistral('fichaRegistralBienInmuebleMinimo')}"/>
                    <p:spacer width="20" height="1"/>
                    <p:commandButton value="Certificado 3" icon="ui-icon-document" styleClass="btnStyle"
                                     actionListener="#{realizarCertificadoFichaRegistral.imprimirFichaRegistral('fichaRegistralBienInmuebleMaximo')}"/>
                    <p:commandButton value="Finalizar Tarea" icon="ui-icon-check" actionListener="#{realizarCertificadoFichaRegistral.actualizarTarea()}" 
                                     styleClass="btnStyle" style="float: right;"/>
                </div>
            </p:fieldset>
        </h:form>

        <p:dialog id="dlgConfirmacion" closeOnEscape="false" header="Confirmacion de Ficha" widgetVar="dlgConfirmFicha"
                  resizable="false" modal="true" position="center">
            <h:form id="formConfirmFicha">
                <center>
                    <h:outputText value="Este numero de Ficha ya fue Impreso para esta tarea. Desea Continuar?" style="font-size: 14px; font-weight: bolder"/>
                    <br/>
                    <br/>
                    <p:commandButton value="Aceptar" icon="ui-icon-check" styleClass="btnStyle"
                                     actionListener="#{realizarCertificadoFichaRegistral.busqueda()}"/>
                </center>
            </h:form>
        </p:dialog>

    </ui:define>
</ui:composition>
