<ui:composition 
    xmlns="http://www.w3.org/1999/xhtml"
    template="/template/template.xhtml"
    xmlns:f="http://xmlns.jcp.org/jsf/core"
    xmlns:h="http://xmlns.jcp.org/jsf/html" xmlns="http://www.w3.org/1999/xhtml"
    xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
    xmlns:p="http://primefaces.org/ui">
    <ui:define name="metadata">
        <f:metadata>
            <f:event type="preRenderView" listener="#{certificados.doPreRenderView()}"/>
        </f:metadata>
    </ui:define>
    <ui:define name="content">
        <h:form id="mainForm">
            <p:panelGrid styleClass="noBorder" style="width: 100%">
                <p:outputLabel value="Certificados Ingresados" style="font-size: 24px;"/>
                <p:commandButton value="Plantilla Word" icon="ui-icon-document" style="float: right" styleClass="btnStyle" actionListener="#{certificados.descargarDocumento()}"/>
            </p:panelGrid>
            <p:dataTable id="dtCertificados" reflow="true" paginator="true" lazy="true" rows="20" rowsPerPageTemplate="20,50,100" resizableColumns="true"
                         paginatorTemplate="{FirstPageLink} {PreviousPageLink} {PageLinks} {CurrentPageReport} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
                         value="#{certificados.certificadoLazy}" var="cert" emptyMessage="No se encontró ningún Item." filterEvent="enter"
                         style="text-align: center;">
                <p:column headerText="Tipo Certificado" width="200">
                    <p:outputLabel value="#{cert.tipoCertificado.nombreCertificado}"/>
                </p:column>
                <p:column headerText="Beneficiario" filterBy="#{cert.beneficiario}" filterStyle="width: 95%">
                    <p:outputLabel value="#{cert.beneficiario}"/>
                </p:column>
                <p:column headerText="Num.Seg." width="120" filterBy="#{cert.numTramite}" sortBy="#{cert.numTramite}">
                    <p:outputLabel value="#{cert.numTramite}"/>
                </p:column>
                <p:column headerText="Num.Certificado" width="120">
                    <p:outputLabel value="#{cert.numCertificado != null ? cert.numCertificado : 'Dinardap'} - #{cert.secuencia}"/>
                </p:column>
                <p:column headerText="Fec.Emision" width="120" sortBy="#{cert.fechaEmision}">
                    <p:outputLabel value="#{cert.fechaEmision}">
                        <f:convertDateTime pattern="dd/MM/yyyy"/>
                    </p:outputLabel>
                </p:column>
                <p:column headerText="Pdf" width="60">
                    <p:commandLink actionListener="#{certificados.certificadoWord(cert)}">
                        <p:graphicImage value="/css/homeIconsImages/reporte.png" height="16"/>   
                    </p:commandLink>
                </p:column>
                <!--<p:column headerText="Word" width="60">
                    <p:commandLink actionListener="# {certificados.certificadoWord(cert)}">
                        <p:graphicImage value="/css/homeIconsImages/word2.png" height="16"/>   
                    </p:commandLink>
                </p:column>-->
                <p:column headerText="Editar" width="60">
                    <p:commandLink actionListener="#{certificados.editarCertificado(cert)}">
                        <p:graphicImage value="/css/homeIconsImages/edit.png"/>   
                    </p:commandLink>
                </p:column>
            </p:dataTable>
        </h:form>

        <p:dialog id="dlgEditor" widgetVar="dlgEditCert" header="Certificado" modal="true" width="725" 
                  resizable="false" position="center" height="450">
            <h:form id="formEdit">
                <p:panelGrid styleClass="noBorder">
                    <p:row>
                        <p:column style="width: 150px">
                            <p:outputLabel value="Tipo Certificado:"/>
                        </p:column>
                        <p:column>
                            <p:outputLabel value="#{certificados.certificado.tipoCertificado.nombreCertificado}" style="text-transform: uppercase"/>
                        </p:column>
                    </p:row>
                    <p:row>
                        <p:column>
                            <p:outputLabel value="Beneficiario:"/>
                        </p:column>
                        <p:column>
                            <p:inputText value="#{certificados.certificado.beneficiario}" style="width: 100%"/>
                        </p:column>
                    </p:row>
                    <p:row>
                        <p:column colspan="2">
                            <p:editor widgetVar="obsEditor" height="330" value="#{certificados.certificado.observacion}"/>
                        </p:column>
                    </p:row>
                    <p:row>
                        <p:column colspan="2" style="text-align: center">
                            <p:commandButton value="Modificar" styleClass="btnStyle" icon="ui-icon-check"
                                             actionListener="#{certificados.modificarCertificado()}"/>
                        </p:column>
                    </p:row>    
                </p:panelGrid>
            </h:form>
        </p:dialog>

    </ui:define>
</ui:composition>
