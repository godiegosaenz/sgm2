<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE composition PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
                template="/template/template.xhtml"
                xmlns:h="http://xmlns.jcp.org/jsf/html"
                xmlns:p="http://primefaces.org/ui"
                xmlns:pe="http://primefaces.org/ui/extensions"
                xmlns:f="http://xmlns.jcp.org/jsf/core"
                xmlns:dlg="http://xmlns.jcp.org/jsf/composite/dialog"
                xmlns:comp="http://java.sun.com/jsf/composite/dialog">
    <f:metadata>
        <f:event type="preRenderView" listener="#{avaluos.load()}"/>
    </f:metadata>

    <!--    <head>
            <link href="#{appConfig.urlbase}resources/css/main.css" rel="stylesheet" type="text/css" />
    
        </head>-->

    <ui:define name="content">
        <center>
            <h1>Avalùos Predial</h1>
        </center>
        <h:panelGroup layout="block" class="Wid100 Responsive100">
            <h:form id="frmAvaluo" prependId="false" enctype="multipart/form-data">
                <p:fieldset legend="Áreas del predio" toggleable="true" style="margin-top: 15px;">
                    <h:panelGrid columns="3" style="width: 100%">
                        <comp:decorateForm id="area_terreno" label="Terreno:" bind="#{avaluos.predio.areaSolar}"
                                           floatValidate="true" readonly="true" pattern="##############.##"  />

                        <comp:decorateForm id="area_cultivos" label="Cultivos:" bind="#{avaluos.predio.areaCultivos}"
                                           floatValidate="true" readonly="true" pattern="##############.##" />

                        <comp:decorateForm id="area_construccion" label="Construcción:" bind="#{avaluos.predio.areaDeclaradaConst}"
                                           floatValidate="true" readonly="true" pattern="##############.##" />

                        <!--            <comp:decorateForm id="area_obras" label="Obras:" bind="# {avaluos.predio.areaObras}"
                                                       floatValidate="true" pattern="##############.##" readonly="true" next="tdatos:frmDatosPredio:btnS1"/>-->

                    </h:panelGrid>
                </p:fieldset>
                <br></br>
                <p:fieldset legend="Avalúos del predio" toggleable="true" class="MarBot10">
                    <h:panelGrid id="pgAvaluos" columns="3" style="width: 100%">
                        <comp:decorateForm id="ava_terreno" label="Terreno: $" bind="#{avaluos.predio.avaluoSolar}"
                                           floatValidate="true" pattern="$" readonly="true">
                        </comp:decorateForm>    

                        <comp:decorateForm id="ava_construccion" label="Construcción: $" bind="#{avaluos.predio.avaluoConstruccion}"
                                           floatValidate="true" pattern="$" readonly="true"/>

                        <comp:decorateForm id="ava_cultivos" label="Cultivos: $" bind="#{avaluos.predio.avaluoCultivos}"
                                           floatValidate="true" pattern="$" readonly="true"/>
                        
                        <comp:decorateForm id="ava_propiedad" label="Propiedad: $" bind="#{avaluos.predio.avaluoMunicipal}"
                                           floatValidate="true" pattern="$" readonly="true"/>

                        <comp:decorateForm id="valorbasem2" label="Valor Base:" bind="#{avaluos.predio.valorM2}"
                                           readonly="true" floatValidate="true" pattern="$" />            
                        <comp:decorateForm id="valorm2" label="Valor  Afectacion Coeficiente terreno:" bind="#{avaluos.predio.valorAfectacionCoeficenteTerreno}"
                                           readonly="true" floatValidate="true" pattern="$"/>

                    </h:panelGrid>
                </p:fieldset>
                <br></br>
                <p:fieldset legend="Historial de Avalúos" toggleable="true" style="margin-top: 15px;" >
                    <h:panelGroup layout="block" class="Responsive Wid100 Container100" >
                        <p:dataTable id="avalHistoricoList" 
                                     value="#{avaluos.avaluosHistoricosPredio}" 
                                     var="p" emptyMessage="No existen registros historicos" paginator="true" rows="10" >
                            <p:column headerText="Fecha de Actualización">
                                <h:outputText value="#{p.fechaActualizacion}"  style="text-align: center"/>
                            </p:column>
                            <p:column headerText="Año">
                                <h:outputText value="#{p.anioInicio}"  style="text-align: center"/>
                            </p:column>
<!--                            <p:column headerText="Valor Base por M2" style="text-align: right">
                                $<h:outputText value="#{p.valorBaseM2}" >
                                    <f:convertNumber type="currency" currencySymbol="" locale="en_US" />
                                </h:outputText>
                            </p:column>-->
                            <p:column headerText="Avalúo Solar" style="text-align: right">
                                $<h:outputText value="#{p.avaluoSolar}" >
                                    <f:convertNumber type="currency" currencySymbol="" locale="en_US" />
                                </h:outputText>
                            </p:column>
                            <!--                <p:column headerText="Suma de Coeficientes del Solar">
                                                <h:outputText value="#{p.sumaCoeficientes}" style="text-align: center" />
                                            </p:column>-->
                            <p:column headerText="Avalúo de la Construcción" style="text-align: right">
                                $<h:outputText value="#{p.avaluoConstruccion}" >
                                    <f:convertNumber type="currency" currencySymbol="" locale="en_US" />
                                </h:outputText>
                            </p:column>
                            <!--                <p:column headerText="Suma de Coeficientes de la Construcción">
                                                <h:outputText value="# {p.sumaCoefEdif}" style="text-align: center"/>
                                            </p:column>--> 
                            <p:column headerText="Avalúo de la Propiedad" style="text-align: right">
                                $<h:outputText value="#{p.avaluoMunicipal}" >
                                    <f:convertNumber type="currency" currencySymbol="" locale="en_US" />
                                </h:outputText>
                            </p:column>
                            <p:column headerText="Detalles de Cálculos">
                                <p:commandLink actionListener="#{avaluos.reporteDetalleCalculos(p)}" rendered="#{!p.migrada}" >
                                    <p:graphicImage value="/css/homeIconsImages/reporte.png" height="35"/>
                                </p:commandLink>
                            </p:column>
                        </p:dataTable>
                    </h:panelGroup>
                </p:fieldset> 

            </h:form>
        </h:panelGroup>
    </ui:define>
</ui:composition>