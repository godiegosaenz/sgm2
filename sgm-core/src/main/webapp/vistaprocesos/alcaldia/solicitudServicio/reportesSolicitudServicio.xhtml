<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE composition PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
                template="/template/template.xhtml"
                xmlns:h="http://xmlns.jcp.org/jsf/html" xmlns="http://www.w3.org/1999/xhtml"
                xmlns:p="http://primefaces.org/ui"
                xmlns:f="http://xmlns.jcp.org/jsf/core">


    <ui:define name="top">
        <h1>REPORTES TRAMITES ALCALDIA</h1>
    </ui:define>

    <ui:define name="content">
        <h:form id="formRepSol" >

            <p:panel style="width: 50%;">
                <p:outputLabel value="Seleccione El tipo de Reporte: " style="font-size: 14px; font-weight: bold;"/>
                <p:spacer width="15"/>
                <p:selectOneMenu value="#{reportesSolicitudServicio.id}" panelStyle="padding: 0em 1em 0em 1em;">
                    <f:selectItem itemLabel="Servicios Solicitados - Resumen." itemValue="#{1}" />
                    <f:selectItem itemLabel="Servicios Solicitados(Excepto Audiencias Km.10)." itemValue="#{2}"/>
                    <f:selectItem itemLabel="Servicios Solicitados por Departamento." itemValue="#{3}"/>
                    <f:selectItem itemLabel="Servicios Solicitados - Audiencias Km.10." itemValue="#{4}"/>
                    <f:selectItem itemLabel="Tareas Alcaldia." itemValue="#{5}" rendered="false"/>
                    <f:selectItem itemLabel="Resumen por Departamentos." itemValue="#{6}"/>
                    <p:ajax update="formRepSol"/>
                </p:selectOneMenu>
                <p:commandButton value="Ver Detalle" actionListener="#{reportesSolicitudServicio.tareasAlcaldia()}" styleClass="btnStyle" icon="ui-icon-document" iconPos="s" style="float: right;" rendered="#{reportesSolicitudServicio.id eq 5}" oncomplete="PF('tareasAlcaldia').show();" update="formTareasAlcaldia"/>
            </p:panel>
            <br/>

            <p:panelGrid style="width: 80%; margin: 0 auto;" columns="5" layout="grid" rendered="#{reportesSolicitudServicio.id eq 1}">

                <p:outputLabel value="Tipo:"/>
                <p:outputLabel value="Estado:"/>
                <p:outputLabel value="Fecha Incio:"/>
                <p:outputLabel value="Fecha Fin:"/>
                <p:outputLabel value="Acción"/>

                <p:selectOneMenu value="#{reportesSolicitudServicio.tipo}">
                    <f:selectItem itemLabel="Por Estados" itemValue="#{1}"/>
                    <f:selectItem itemLabel="Resumen" itemValue="#{2}"/>
                </p:selectOneMenu>

                <p:selectOneMenu value="#{reportesSolicitudServicio.estado}">
                    <f:selectItem itemLabel="pendiente" itemValue="pendiente"/>
                    <f:selectItem itemLabel="finalizado" itemValue="finalizado"/>
                    <f:selectItem itemLabel="inactivo" itemValue="inactivo"/>
                </p:selectOneMenu>
                <p:calendar value="#{reportesSolicitudServicio.fechaInicioResumen}" pattern="dd/MM/yyy"/>
                <p:calendar value="#{reportesSolicitudServicio.fechaFinResumen}" pattern="dd/MM/yyyy"/>
                <p:commandButton value="Reporte" actionListener="#{reportesSolicitudServicio.reporteResumen()}" styleClass="btnStyle" icon="ui-icon-document" iconPos="s"/>

            </p:panelGrid>

            <p:panelGrid style="width: 80%; margin: 0 auto;" columns="3" layout="grid"  rendered="#{reportesSolicitudServicio.id eq 2}">
                <p:outputLabel value="Fecha Incio:"/>
                <p:outputLabel value="Fecha Fin:"/>
                <p:outputLabel value="Acción"/>

                <p:calendar value="#{reportesSolicitudServicio.fechaInicio}" pattern="dd/MM/yyy"/>
                <p:calendar value="#{reportesSolicitudServicio.fechaFin}" pattern="dd/MM/yyyy"/>
                <p:commandButton value="Reporte" actionListener="#{reportesSolicitudServicio.reportes(1)}" styleClass="btnStyle" icon="ui-icon-document" iconPos="s"/>
            </p:panelGrid>

            <p:panelGrid style="width: 80%; margin: 0 auto;" columns="3" layout="grid"  rendered="#{reportesSolicitudServicio.id eq 3}">

                <p:outputLabel value="Fecha Incio:"/>
                <p:outputLabel value="Fecha Fin:"/>
                <p:outputLabel value="Acción"/>

                <p:calendar value="#{reportesSolicitudServicio.fechaInicioDep}" pattern="dd/MM/yyy"/>
                <p:calendar value="#{reportesSolicitudServicio.fechaFinDep}" pattern="dd/MM/yyyy"/>
                <p:commandButton value="Reporte" actionListener="#{reportesSolicitudServicio.reportes(3)}" styleClass="btnStyle" icon="ui-icon-document" iconPos="s"/>
            </p:panelGrid>

            <p:panelGrid style="width: 80%; margin: 0 auto;" columns="3" layout="grid"  rendered="#{reportesSolicitudServicio.id eq 4}"> <!-- Audiencia 10-->

                <p:outputLabel value="Fecha Incio:"/>
                <p:outputLabel value="Fecha Fin:"/>
                <p:outputLabel value="Acción"/>

                <p:calendar value="#{reportesSolicitudServicio.fechaInicio10}" pattern="dd/MM/yyy"/>
                <p:calendar value="#{reportesSolicitudServicio.fechaFin10}" pattern="dd/MM/yyyy"/>
                <p:commandButton value="Reporte" actionListener="#{reportesSolicitudServicio.reportes(2)}" styleClass="btnStyle" icon="ui-icon-document" iconPos="s"/>

            </p:panelGrid>

            <p:panelGrid style="width: 50%; margin: 0 auto;" columns="2" layout="grid" rendered="#{reportesSolicitudServicio.id eq 6}">
                <p:outputLabel value="Tipo:"/>
                <p:selectOneMenu value="#{reportesSolicitudServicio.tipo}">
                    <f:selectItem itemLabel="Por Departamento" itemValue="#{1}"/>
                    <f:selectItem itemLabel="Varios Departamentos" itemValue="#{2}"/>
                </p:selectOneMenu>

                <p:outputLabel value="Estado:"/>
                <p:selectOneMenu value="#{reportesSolicitudServicio.estado}">
                    <f:selectItem itemLabel="Pendiente" itemValue="Pendiente"/>
                    <f:selectItem itemLabel="Finalizado" itemValue="Finalizado"/>
                    <f:selectItem itemLabel="Inactivo" itemValue="Inactivo"/>
                </p:selectOneMenu>

                <p:outputLabel value="Fecha Incio:"/>
                <p:calendar value="#{reportesSolicitudServicio.fechaInicioResumen}" pattern="yyyy-MM-dd"/>

                <p:outputLabel value="Fecha Fin:"/>
                <p:calendar value="#{reportesSolicitudServicio.fechaFinResumen}" pattern="yyyy-MM-dd"/>
                <p:outputLabel value="Acción"/>

                <h:panelGroup>
                    <p:commandButton value="Generar" actionListener="#{reportesSolicitudServicio.resumenDepartamento(1)}" styleClass="btnStyle" icon="ui-icon-document" iconPos="s"/>
                    <p:commandButton value="Excel" actionListener="#{reportesSolicitudServicio.resumenDepartamento(2)}" styleClass="btnStyle" icon="ui-icon-document" iconPos="s"/>
                </h:panelGroup>

            </p:panelGrid>

        </h:form>

        <p:dialog widgetVar="tareasAlcaldia" modal="true" header="Detalle Tareas Alcaldia" width="50%">
            <h:form id="formTareasAlcaldia">
                <p:panelGrid style="width: 100%;">
                    <p:row>
                        <p:column>
                            <p:outputLabel value="Responsable: " style="font-weight: bolder;"/>
                            <p:outputLabel value="#{reportesSolicitudServicio.asistente.ente.apellidos} #{reportesSolicitudServicio.asistente.ente.nombres}"/>
                        </p:column>
                    </p:row>
                    <p:row>
                        <p:column>
                            <p:outputLabel value="Num. Tareas: " style="font-weight: bolder;"/>
                            <p:outputLabel value="#{reportesSolicitudServicio.tareasAsignadasAlcaldia.size()}"/>
                        </p:column>
                    </p:row>
                    <p:row>
                        <p:column>
                            <p:dataTable id="taskList" paginator="true" style="text-align: center;" var="v_task" value="#{reportesSolicitudServicio.tareasAsignadasAlcaldia}"
                                         paginatorTemplate="{FirstPageLink} {PreviousPageLink} {PageLinks} {CurrentPageReport} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
                                         rows="10" emptyMessage="No tiene tareas pendientes..." filterEvent="enter">
                                <p:column headerText="Nombre Tarea" style="text-align: center">
                                    <p:outputLabel value=" #{v_task.tarea.name}" style="text-transform: uppercase"/>
                                </p:column>
                                <p:column headerText="Solicitante" filterBy="#{v_task.tramite.nombrePropietario}" filterStyle="width: 90%"
                                          sortBy="#{v_task.tramite.nombrePropietario}" >
                                    <p:outputLabel value="#{v_task.tramite.nombrePropietario}" style="text-transform: uppercase"/>
                                </p:column>
                                <p:column headerText="No.Tramite" filterBy="#{v_task.tramite.id}" sortBy="#{v_task.tramite.id}"
                                          width="120" filterStyle="width: 90%">
                                    <p:outputLabel value="#{v_task.tramite.id}"/>
                                </p:column>
                                <p:column headerText="Fecha" sortBy="#{v_task.tramite.fecha}" width="80">
                                    <p:outputLabel value="#{v_task.tramite.fecha}">
                                        <f:convertDateTime pattern="dd/MM/yyyy"/>
                                    </p:outputLabel>
                                </p:column>
                            </p:dataTable>
                        </p:column>
                    </p:row>
                </p:panelGrid>
                <div align="center">
                    <p:commandButton id="AgrPla" value="Aceptar" onclick="PF('tareasAlcaldia').hide()" style="height: 30px; " styleClass="btnStyle"/>
                </div>
            </h:form>
        </p:dialog>
    </ui:define>

</ui:composition>
