<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE composition PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
                template="/template/template.xhtml"
                xmlns:h="http://xmlns.jcp.org/jsf/html" xmlns="http://www.w3.org/1999/xhtml"
                xmlns:p="http://primefaces.org/ui"
                xmlns:f="http://xmlns.jcp.org/jsf/core">


    <ui:define name="content">

        <h:form id="forGenLiq">
            <p:panelGrid styleClass="noBorder" columns="4" style="width: 100%;font-size: 14px;">
                <p:outputLabel value="Tarea: #{editarLiquidacionPC.taskDataByTaskID.name}" style="font-weight: bolder;color: #005f9c"/>
                <p:outputLabel value="No Trámite: #{editarLiquidacionPC.ht.id}" style="font-weight: bolder;color: #005f9c"/>
                <p:outputLabel value="Responsable: #{editarLiquidacionPC.taskDataByTaskID.assignee}" style="font-weight: bolder;color: #005f9c"/>
            </p:panelGrid>
            
            <p:panelGrid id="panelCons" style="width: 100%; margin: 0px; margin-bottom: 20px">
                <f:facet name="header" >
                    <p:column colspan="17">PERMISO DE CONSTRUCCIÓN</p:column>
                </f:facet>
                <!-- Busqueda Cod Predio -->
                <p:row styleClass="ui-widget-header" style="margin-top: 10px;" >   
                    <p:column colspan="17">
                        <center>
                            Número Predio <p:inputText readonly="true" id="numPre" value="#{editarLiquidacionPC.predio.numPredio}" /><p:spacer width="5"/>
                        </center>
                    </p:column>
                </p:row> 
                <p:row >
                    <p:column>Sector<br/><p:inputText readonly="true" value="#{editarLiquidacionPC.predio.sector}"  maxlength="4" style="width: 50px;"/></p:column>
                    <p:column>Mnz. <p:inputText readonly="true" value="#{editarLiquidacionPC.predio.mz}"  maxlength="4" style="width: 80%;"/></p:column>
                    <p:column>Cdla. <p:inputText readonly="true" value="#{editarLiquidacionPC.predio.cdla}"  maxlength="4" style="width: 80%;"/></p:column>
                    <p:column>Mz. Div <p:inputText readonly="true" value="#{editarLiquidacionPC.predio.mzdiv}"  maxlength="4" style="width: 80%;"/></p:column>
                    <p:column>Solar <p:inputText readonly="true" value="#{editarLiquidacionPC.predio.solar}"  maxlength="4" style="width: 80%;"/></p:column>
                    <p:column>Div1 <p:inputText readonly="true" value="#{editarLiquidacionPC.predio.div1}"  maxlength="1"  style="width: 80%;"/></p:column>
                    <p:column>Div2 <p:inputText readonly="true" value="#{editarLiquidacionPC.predio.div2}"  maxlength="1"  style="width: 80%;"/></p:column>
                    <p:column>Div3 <p:inputText readonly="true" value="#{editarLiquidacionPC.predio.div3}"  maxlength="1"  style="width: 80%;"/></p:column>
                    <p:column>Div4 <p:inputText readonly="true" value="#{editarLiquidacionPC.predio.div4}"  maxlength="1"  style="width: 80%;"/></p:column>
                    <p:column>Div5 <p:inputText readonly="true" value="#{editarLiquidacionPC.predio.div5}"  maxlength="1"  style="width: 80%;"/></p:column>
                    <p:column>Div6 <p:inputText readonly="true" value="#{editarLiquidacionPC.predio.div6}"  maxlength="1"  style="width: 80%;"/></p:column>
                    <p:column>Div7 <p:inputText readonly="true" value="#{editarLiquidacionPC.predio.div7}"  maxlength="1"  style="width: 80%;"/></p:column>
                    <p:column>Div8 <p:inputText readonly="true" value="#{editarLiquidacionPC.predio.div8}"  maxlength="1"  style="width: 80%;"/></p:column>
                    <p:column>Div9 <p:inputText readonly="true" value="#{editarLiquidacionPC.predio.div9}"  maxlength="1"  style="width: 80%;"/></p:column>
                    <p:column>Phv <p:inputText readonly="true" value="#{editarLiquidacionPC.predio.phv}"  maxlength="2" style="width: 80%;"/></p:column>
                    <p:column>Phh <p:inputText readonly="true" value="#{editarLiquidacionPC.predio.phh}"  maxlength="2" style="width: 80%;"/></p:column>
                    <p:column> </p:column>

                </p:row>
                <!-- Datos de Permiso -->
                <p:row>
                    <p:column colspan="17" styleClass="ui-widget-header" style="text-align: center">Datos de Permiso</p:column>
                </p:row>
                <p:row>
                    <p:column colspan="4">
                        Tipo Permiso<br/>
                        <p:selectOneMenu id="tipConstruccion" value="#{editarLiquidacionPC.ht.tipoTramiteNombre}"  style="width: 160px;"  >  
                            <f:selectItems value="#{editarLiquidacionPC.listRequisTra}" var="req1" itemValue="#{req1.descripcion}"  itemLabel="#{req1.descripcion}" itemDisabled="true"/>
                        </p:selectOneMenu>                                     
                    </p:column>
                    <p:column colspan="4">Año Tramite<br/>
                        <p:inputText readonly="true" value="#{editarLiquidacionPC.permisoNuevo.anioTramite}"   /></p:column>
                    <p:column colspan="3">Número de Tramite<br/>
                        <p:inputText readonly="true" value="#{editarLiquidacionPC.permisoNuevo.tramite.id}"  /></p:column>
                    <p:column colspan="3">Fecha Emisión<br/>
                        <p:calendar value="#{editarLiquidacionPC.permisoNuevo.fechaEmision}" readonlyInput="true" disabled="true"/></p:column>
                    <p:column colspan="3">Fecha Caducidad<br/>
                        <p:calendar readonly="true" value="#{editarLiquidacionPC.permisoNuevo.fechaCaducidad}" readonlyInput="true" disabled="true"/></p:column>
                </p:row>
                <!-- Datos de Propietario-->
                <p:row>
                    <p:column colspan="17" styleClass="ui-widget-header" style="text-align: center">Datos de Propietario</p:column>
                </p:row>
                <p:row>
                    <p:column colspan="17">
                        <p:dataTable id="dtProp" value="#{editarLiquidacionPC.listaPropietarios}" var="pp" style="width: 100%" reflow="true" emptyMessage="No hay asignado Propietarios al Predio">
                            <p:column headerText="#C.I. O R.U.C" style="text-align: center;font-weight: bold">
                                <p:outputLabel value="#{pp.ente.ciRuc}"/>
                            </p:column>
                            <p:column headerText="Propietario" style="text-align: center;font-weight: bold">
                                <p:outputLabel value="#{pp.ente.nombres} #{pp.ente.apellidos}" rendered="#{pp.ente.esPersona}"/>
                                <p:outputLabel value="#{pp.ente.razonSocial}" rendered="#{!pp.ente.esPersona}"/>
                            </p:column>

                        </p:dataTable>
                    </p:column>
                </p:row>
                <!-- Responsable Tecnico-->
                <p:row >
                    <p:column colspan="3">
                        Ced. Identidad <p:inputMask readonly="true" id="ciIde" mask="9999999999" value="#{editarLiquidacionPC.respTec.ciRuc}"/>
                    </p:column>
                    <p:column colspan="8">
                        Resp. Tecnico <p:inputText readonly="true" id="resT" value="#{editarLiquidacionPC.permisoNuevo.responsable}" style="width: 70%;"/> 
                    </p:column>
                    <p:column colspan="6">
                        Registro Profesional <p:inputText readonly="true" id="regP" value="#{editarLiquidacionPC.respTec.regProf}"/>
                    </p:column>
                </p:row>
                <!-- Ubicación-->
                <p:row>
                    <p:column styleClass="ui-widget-header" colspan="17" style="text-align: center">Ubicación</p:column>
                </p:row>
                <p:row>
                    <p:column colspan="3">
                        Sector <p:inputText value="La Puntilla" readonly="true" style="width: 70%"  />                                   
                    </p:column>
                    <p:column colspan="5">Urbanización <p:inputText readonly="true" value="#{editarLiquidacionPC.permisoNuevo.nombUrbanizacionImpresa}"  style="width: 70%" /></p:column>
                    <p:column colspan="3">Manzana <p:inputText readonly="true" value="#{editarLiquidacionPC.permisoNuevo.urbmz}" style="width: 50%" /></p:column>
                    <p:column colspan="3">Solar <p:inputText readonly="true" value="#{editarLiquidacionPC.permisoNuevo.urbsolar}" style="width: 50%" /></p:column>
                    <p:column colspan="3">Calle <p:inputText readonly="true" value="#{editarLiquidacionPC.permisoNuevo.calle}" style="width: 70%" /></p:column>
                </p:row>
                <!-- edificación-->
                <p:row>
                    <p:column styleClass="ui-widget-header" colspan="17" style="text-align: center">Caracteristicas del Predio</p:column>
                </p:row>
                <p:row id="rowDtEdif">
                    <p:column colspan="9">
                        <p:dataTable id="dtEdif" var="edf" value="#{editarLiquidacionPC.detallesEdific}" selectionMode="single" selection="#{editarLiquidacionPC.permisoSelect}" rowKey="#{edf.descEdificacion}" emptyMessage="No ha ninguna edificación cargada" rowIndexVar="rowIndex" >
                            <p:ajax event="rowSelect" listener="#{editarLiquidacionPC.onRowSelect}" update="forGenLiq"/> 
                            <p:column headerText="Edificación" style="text-align: center;font-weight: bold">
                                <p:outputLabel value="#{edf.descEdificacion}"/>
                            </p:column>
                            <p:column headerText="# Pisos" style="text-align: center;font-weight: bold">
                                <p:outputLabel value="#{edf.numeroPisos}"/>
                            </p:column>
                            <p:column headerText="Descripción" style="text-align: center;font-weight: bold">
                                <p:outputLabel value="#{edf.descripcion}"/>
                            </p:column>
                            <p:column headerText="Area Construcc" style="text-align: center;font-weight: bold">
                                <p:outputLabel value="#{edf.areaConstruccion}">
                                    <f:convertNumber pattern="####,##0.00"/>
                                </p:outputLabel>
                            </p:column>
                        </p:dataTable>
                    </p:column>

                    <p:column colspan="8" rowspan="2"  > 
                        <p:panelGrid columns="4" layout="grid">
                            Altura<p:inputText value="#{editarLiquidacionPC.permisoNuevo.altura}" style="width: 100%;" type="decimal" readonly="true" >
                                <f:convertNumber pattern="####,##0.00" />
                            </p:inputText>
                            # Edifi. <p:inputText value="#{editarLiquidacionPC.permisoNuevo.cantidadEdificaciones}" style="width: 100%;" type="number" readonly="true"/>

                            # Piso B.N.B <p:inputText value="#{editarLiquidacionPC.permisoNuevo.pisosBnb}" style="width: 100%;" type="number" readonly="true"/>
                            # Piso S.N.B  <p:inputText value="#{editarLiquidacionPC.permisoNuevo.pisosSnb}" style="width: 100%;" type="number" readonly="true"/>

                            Area. Edif. <p:inputText id="ad" value="#{editarLiquidacionPC.permisoNuevo.areaEdificaciones}" style="width: 100%;" readonly="true" >
                                <f:convertNumber pattern="####,##0.00" />
                            </p:inputText>
                            # Parqueo <p:inputText value="#{editarLiquidacionPC.permisoNuevo.cantidadParqueos}" style="width: 100%;" readonly="true"/>

                            Area.Parqueo <p:inputText value="#{editarLiquidacionPC.permisoNuevo.areaParqueos}" style="width: 100% !important" readonly="true" >
                                <f:convertNumber pattern="####,##0.00" />
                                <p:ajax event="change" listener="#{editarLiquidacionPC.calculoAreaConstruccion()}" update="ac"/>
                            </p:inputText> 
                            Ret. Frontal <p:inputText value="#{editarLiquidacionPC.permisoNuevo.retiroFrontal}" style="width: 100%;" readonly="true" >
                                <f:convertNumber pattern="####,##0.00" />
                            </p:inputText>

                            Ret. Lateral1 <p:inputText id="retLat1" value="#{editarLiquidacionPC.permisoNuevo.retiroLateral1}" style="width: 100%;" readonly="true" >
                                <f:convertNumber pattern="####,##0.00" />
                            </p:inputText>
                            Retiro Lateral2 <p:inputText id="retLat2" value="#{editarLiquidacionPC.permisoNuevo.retiroLateral2}" style="width: 100%;" readonly="true">
                                <f:convertNumber pattern="####,##0.00" />
                            </p:inputText>

                            Retiro Posterior <p:inputText value="#{editarLiquidacionPC.permisoNuevo.retiroPosterior}" style="width: 100%;" readonly="true"  >
                                <f:convertNumber pattern="####,##0.00" />
                            </p:inputText>
                        </p:panelGrid>
                        Descripción de la Edificación.<br/>
                        <p:inputText value="#{editarLiquidacionPC.permisoNuevo.descFamiliar}" style="width: 100%;" readonly="true"/>
                    </p:column>
                </p:row>

                <p:row id="rowEspEdfi">
                    <p:column colspan="9">
                        <p:dataTable id="dtCartEdif" value="#{editarLiquidacionPC.permisoSelect.peDetallePermisoCollection}" var="d" style="width: 100%" emptyMessage="No ha cargado documento alguno">
                            <p:column headerText="Edificacion" style="text-align: center; " >
                                <h:outputText value="#{d.idPermisoEdificacion.descEdificacion}"/>  
                            </p:column>

                            <p:column headerText="Categoría" style="text-align: center; font-weight: bold">
                                <p:outputLabel value="#{d.idCatEdfProp.categoria.nombre}"/>
                            </p:column>

                            <p:column headerText="Características" style="text-align: center; font-weight: bold">
                                <p:outputLabel value="#{d.idCatEdfProp.nombre}"/>
                            </p:column>

                            <p:column headerText="Porcentaje" style="text-align: center; font-weight: bold; width: 110px;">
                                <p:outputLabel value="#{d.porcentaje}" >
                                    <f:convertNumber pattern="####,##0.00"/>
                                </p:outputLabel>
                            </p:column>
                        </p:dataTable>
                    </p:column>
                </p:row>

                <p:row styleClass="ui-widget-header">
                    <p:column colspan="3" style="text-align: center">Retiro Frontal</p:column> 
                    <p:column colspan="4" style="text-align: center">Retiro Lateral 1</p:column> 
                    <p:column colspan="4" style="text-align: center">Retiro Lateral 2 </p:column> 
                    <p:column colspan="3" style="text-align: center">Retiro Posterior</p:column> 
                    <p:column colspan="3" style="text-align: center">Registro Vista </p:column> 
                </p:row>
                <p:row >
                    <p:column colspan="3">Carta/Ados 
                        <h:selectOneRadio readonly="true" styleClass="noBorder" id="carados1" value="#{editarLiquidacionPC.permisoNuevo.caradosrf}" style="font-family: Arial;font-weight:lighter;font-size: 12px" >                                             
                            <f:selectItem itemLabel="S" itemValue="S" itemDisabled="true" />  
                            <f:selectItem itemLabel="N" itemValue="N" itemDisabled="true"  />  
                        </h:selectOneRadio>
                    </p:column> 
                    <p:column colspan="4">Carta/Ados 
                        <h:selectOneRadio readonly="true" styleClass="noBorder" id="carados2" value="#{editarLiquidacionPC.permisoNuevo.caradosrl1}" style="font-family: Arial;font-weight:lighter;font-size: 12px" >                                             
                            <f:selectItem itemLabel="S" itemValue="S" />  
                            <f:selectItem itemLabel="N" itemValue="N" itemDisabled="true"  />  
                        </h:selectOneRadio>
                    </p:column> 
                    <p:column colspan="4">Carta/Ados 
                        <h:selectOneRadio readonly="true" styleClass="noBorder" id="carados3" value="#{editarLiquidacionPC.permisoNuevo.caradosrl2}" style="font-family: Arial;font-weight:lighter;font-size: 12px" >                                             
                            <f:selectItem itemLabel="S" itemValue="S" itemDisabled="true" />  
                            <f:selectItem itemLabel="N" itemValue="N" itemDisabled="true"  />  
                        </h:selectOneRadio>
                    </p:column>  
                    <p:column colspan="3">Carta/Ados 
                        <h:selectOneRadio readonly="true" styleClass="noBorder" id="carados4" value="#{editarLiquidacionPC.permisoNuevo.caradosrp}" style="font-family: Arial;font-weight:lighter;font-size: 12px" >                                             
                            <f:selectItem itemLabel="S" itemValue="S"  itemDisabled="true"/>  
                            <f:selectItem itemLabel="N" itemValue="N" itemDisabled="true"  />  
                        </h:selectOneRadio>
                    </p:column> 
                    <p:column colspan="3">Registro Vista 
                        <h:selectOneRadio readonly="true" styleClass="noBorder" id="carados5" value="#{editarLiquidacionPC.permisoNuevo.registroVista}" style="font-family: Arial;font-weight:lighter;font-size: 12px" onkeyup="siguiente(this, event);" >                                             
                            <f:selectItem itemLabel="S" itemValue="S" itemDisabled="true" />  
                            <f:selectItem itemLabel="N" itemValue="N" itemDisabled="true"  />  
                        </h:selectOneRadio>
                    </p:column> 
                </p:row>
                <p:row >
                    <p:column colspan="3">Carta/Acer 
                        <h:selectOneRadio readonly="true" styleClass="noBorder" id="carAcer1" value="#{editarLiquidacionPC.permisoNuevo.caracerrf}" style="font-family: Arial;font-weight:lighter;font-size: 12px" onkeyup="siguiente(this, event);" >                                             
                            <f:selectItem itemLabel="S" itemValue="S" itemDisabled="true" />  
                            <f:selectItem itemLabel="N" itemValue="N" itemDisabled="true"  />  
                        </h:selectOneRadio>
                    </p:column> 
                    <p:column colspan="4">Carta/Acer 
                        <h:selectOneRadio readonly="true" styleClass="noBorder" id="carAcer2" value="#{editarLiquidacionPC.permisoNuevo.caracerrl1}" style="font-family: Arial;font-weight:lighter;font-size: 12px" onkeyup="siguiente(this, event);" >                                             
                            <f:selectItem itemLabel="S" itemValue="S"  itemDisabled="true"/>  
                            <f:selectItem itemLabel="N" itemValue="N"  itemDisabled="true" />  
                        </h:selectOneRadio>
                    </p:column> 
                    <p:column colspan="4">Carta/Acer 
                        <h:selectOneRadio readonly="true" styleClass="noBorder" id="carAcer3" value="#{editarLiquidacionPC.permisoNuevo.caracerrl2}" style="font-family: Arial;font-weight:lighter;font-size: 12px" onkeyup="siguiente(this, event);" >                                             
                            <f:selectItem itemLabel="S" itemValue="S" itemDisabled="true" />  
                            <f:selectItem itemLabel="N" itemValue="N" itemDisabled="true"  />  
                        </h:selectOneRadio>
                    </p:column>  
                    <p:column colspan="3">Carta/Acer 
                        <h:selectOneRadio readonly="true" styleClass="noBorder" id="carAcer4" value="#{editarLiquidacionPC.permisoNuevo.caracerrp}" style="font-family: Arial;font-weight:lighter;font-size: 12px" onkeyup="siguiente(this, event);" >                                             
                            <f:selectItem itemLabel="S" itemValue="S" itemDisabled="true" />  
                            <f:selectItem itemLabel="N" itemValue="N" itemDisabled="true"  />  
                        </h:selectOneRadio>
                    </p:column> 
                </p:row>

                <p:row>
                    <p:column styleClass="ui-widget-header" colspan="17" style="text-align: center">Materiales de Construcción </p:column>
                </p:row>
                <p:row>
                    <p:column colspan="3">Area/Construcción<br/>
                        <p:inputText id="ac" value="#{editarLiquidacionPC.permisoNuevo.areaConstruccion}" readonly="true"/>
                    </p:column> 
                    <p:column colspan="3">Area/Implantación<br/>
                        <p:inputText value="#{editarLiquidacionPC.permisoNuevo.areaImplantacion}" readonly="true"/>
                    </p:column> 
                    <p:column colspan="3">Area/Solar<br/>
                        <p:inputText value="#{editarLiquidacionPC.permisoNuevo.areaSolar}" readonly="true"/>
                    </p:column>  
                    <p:column colspan="3">Linea/Fabrica<br/>
                        <p:inputText value="#{editarLiquidacionPC.permisoNuevo.lineaFabrica}" readonly="true"/>
                    </p:column> 
                    <p:column colspan="5">Observación<br/>
                        <p:inputTextarea value="#{editarLiquidacionPC.permisoNuevo.observacion}" readonly="true" style="width: 80%"/>
                    </p:column> 
                </p:row>

            </p:panelGrid>
            <div align="center">
                <p:commandButton rendered="#{!editarLiquidacionPC.impresoPermiso}" id="btnImpLiq" value="Completar Tarea" onclick="PF('dlgObsGenCert').show()" update="forObsPC" style="height: 30px; color: #ffffff; background: #616161 !important; font-weight: bold;"/>
                <p:commandButton rendered="#{editarLiquidacionPC.impresoPermiso}" id="btnBandTar" value="Bandeja de Tareas" actionListener="#{editarLiquidacionPC.bandejaTareasCer()}" style="height: 30px; color: #ffffff; background: #616161 !important; font-weight: bold;"/>
            </div>

        </h:form>

        <p:dialog widgetVar="dlgObsGenCert" modal="true" appendTo="@(body)" width="500" 
                  resizable="false" closable="true" closeOnEscape="true">
            <h:form id="forObsPC">
                <p:messages autoUpdate="true" closable="true" showSummary="true"/>
                <p:panel id="pnlObsPC" header="Ingrese sus observaciones" style="width: 100%">
                    <div align="center">
                        <p:inputTextarea id="observ" value="#{editarLiquidacionPC.ob.observacion}" 
                                         rows="4" style="width: 100%; text-transform: uppercase" required="true" requiredMessage="Debe ingresar las observaciones"
                                         placeholder="Las observaciones son obligatorias para continuar con el tramite"/>
                        <br/>
                        <p:commandButton id="btnVal" value="Imprimir Permiso" actionListener="#{editarLiquidacionPC.imprimirPermiso()}" icon="ui-icon-circle-arrow-e" iconPos="s"
                                         oncomplete="PF('dlgObsGenCert').hide()" style="color: #ffffff; background: #616161 !important; font-weight: bold; height: 30px" />

                    </div>
                </p:panel>
            </h:form>
        </p:dialog>

    </ui:define>

</ui:composition>

