<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE composition PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
                template="/template/template.xhtml"
                xmlns:p="http://primefaces.org/ui"
                xmlns:h="http://xmlns.jcp.org/jsf/html" xmlns="http://www.w3.org/1999/xhtml"
                xmlns:f="http://xmlns.jcp.org/jsf/core">
    <ui:define name="content">
        <h:form id="frmMain">
            <p:panel id="pRequisitos" header="Fusion de Predios: Seleccion de requisitos" style="width: 100%" toggleable="true">
                <center>
                    <p:panelGrid columns="3" style="width: 50%; border: 0">
                        <h:outputText value="No. Identificacion" style="text-align: right; font-weight: bold"/>
                        <p:inputText value="#{requisitosFP.cedulaRuc}" style="text-align: center; width: 100%"/>
                        <p:commandButton update="frmMain" actionListener="#{requisitosFP.buscarEnte()}" style="color: #ffffff; background: #616161 !important; font-weight: bold; height: 30px;" value="Buscar" />
                    </p:panelGrid>
                </center>
                <p:panel id="ppredios" header="Datos del Solicitante " style="width: 100%" rendered="#{requisitosFP.userValido}">
                    <p:panelGrid columns="1" layout="grid">
                        <h:outputText value="No. Identificacion: #{requisitosFP.solicitante.ciRuc}" style="text-transform: uppercase;"/>
                        <h:outputText value="Razon Social: #{requisitosFP.solicitante.nombreComercial}" rendered="#{!requisitosFP.solicitante.esPersona}" style="text-transform: uppercase;"/>
                        <h:outputText value="Nombre: #{requisitosFP.solicitante.nombres} #{requisitosFP.solicitante.apellidos}" rendered="#{requisitosFP.solicitante.esPersona}" style="text-transform: uppercase;"/>
                    </p:panelGrid>
                    <p:dataTable  id="dataLisPredios"  value="#{requisitosFP.predios}" var="itemPr" emptyMessage="No tiene datos" style="width: 100%;" reflow="true"
                                  selection="#{requisitosFP.predio}" rowKey="#{itemPr.id}">
                        <f:facet name="header">Seleccione el predio de referencia, para listar los requisitos</f:facet>
                        <p:column selectionMode="single" style="width: 5%; text-align: center"/>
                        <p:column headerText="Código Predial" style="width: 50%">
                            <h:outputText value="#{itemPr.sector}.#{itemPr.mz}.#{itemPr.cdla}.#{itemPr.mzdiv}.#{itemPr.solar}.#{itemPr.div1}.#{itemPr.div2}.
                                          #{itemPr.div3}.#{itemPr.div4}.#{itemPr.div5}.#{itemPr.div6}.#{itemPr.div7}.#{itemPr.div8}.#{itemPr.div9}" style="text-align: center"/>
                        </p:column>
                        <p:column headerText="No. Predio" style="width: 20%">
                            <h:outputText value="#{itemPr.numPredio}" style="text-align: center"/>
                        </p:column>
                        <p:column headerText="Ciudadela" style="width: 20%">
                            <h:outputText value="#{itemPr.ciudadela.nombre}" style="text-align: center"/>
                        </p:column>
                        <f:facet name="footer">
                            <p:commandButton id="btnVer" icon="ui-icon-search" value="Lisar requistos" actionListener="#{requisitosFP.mostrarReq()}" update="frmMain"/>
                        </f:facet>
                    </p:dataTable>
                    <br/>
                    <br/>
                    <p:dataTable id="dtrequisitos" value="#{requisitosFP.requisitos}" rendered="#{requisitosFP.mostrarRequisitos}"
                                 var="req" reflow="true"  emptyMessage="No se encontró ningun Requisito">
                        <f:facet name="header">Listado de Requisitos: #{requisitosFP.tramite.descripcion} - No. Predio: #{requisitosFP.predio.numPredio}</f:facet>
                        <p:column headerText="Requisito" style="width: 75%;">
                            <h:outputText value="#{req.nombre}" style="text-transform: uppercase;"/>
                        </p:column>
                        <p:column headerText="Presentar Documento">
                            <center>
                                <p:inputText value="#{validarRequisito.entrada}"  rendered="#{req.tieneComprobante}" />
                                <p:fileUpload  rendered="#{!req.tieneComprobante}" fileUploadListener="#{requisitosFP.handleFileUpload}"
                                               multiple="false"
                                               mode="advanced"
                                               fileLimit="1"
                                               label="Seleccionar"
                                               skinSimple="true"
                                               update="messages"
                                               sizeLimit="35000000" 
                                               allowTypes="/(\.|\/)(gif|jpe?g|png|pdf)$/"/>
                                <p:growl id="messages" showDetail="true"/>
                            </center>
                        </p:column>
                    </p:dataTable>
                    <br/>
                    <center><p:commandButton value="Validar archivos" onclick="PF('obs').show()" rendered="#{requisitosFP.mostrarRequisitos}" style="color: #ffffff; background: #616161 !important; font-weight: bold; height: 30px"/></center>
                </p:panel>
            </p:panel>
        </h:form>

        <p:dialog id="dlgObs" widgetVar="obs" header="#{requisitosFP.tramite.descripcion}" appendTo="@(body)" modal="true" width="500" resizable="false" closable="true" closeOnEscape="true">
            <h:form id="frmObs" target="_blank">
                <p:panel id="pobs" header="Ingrese sus observaciones" style="width: 100%">
                    <div align="center">
                        <p:inputTextarea id="obsservacion" value="#{requisitosFP.obs.observacion}" rows="4" style="width: 100%; text-transform: uppercase" required="true" placeholder="Las observaciones son obligatorias para continuar con el tramite"/>
                        <br/>
                        <p:commandButton id="btnValidar" value="Validar Requisitos" actionListener="#{requisitosFP.iniciarProceso()}" oncomplete="PF('obs').hide()" style="color: #ffffff; background: #616161 !important; font-weight: bold; height: 30px"/>
                    </div>
                </p:panel>
            </h:form>
        </p:dialog>

    </ui:define>
</ui:composition>