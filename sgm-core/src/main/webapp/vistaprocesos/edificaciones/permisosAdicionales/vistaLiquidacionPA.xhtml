<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE composition PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
                template="/template/template.xhtml"
                xmlns:p="http://primefaces.org/ui"
                xmlns:pe="http://primefaces.org/ui/extensions"
                xmlns:h="http://xmlns.jcp.org/jsf/html" xmlns="http://www.w3.org/1999/xhtml"
                xmlns:f="http://xmlns.jcp.org/jsf/core">
    <ui:define name="top">
        <p:panelGrid styleClass="noBorder" columns="4" style="width: 100%;font-size: 14px;">
            <p:outputLabel value="Tarea: Edición Tasa Liquidacion" style="font-weight: bolder;color: #005f9c"/>
            <p:outputLabel value="Trámite: #{editarTasaPA.ht.id}" style="font-weight: bolder;color: #005f9c"/>
            <p:outputLabel value="Responsable: #{editarTasaPA.base.session.name_user}" style="font-weight: bolder;color: #005f9c"/>
        </p:panelGrid>
    </ui:define>
    <ui:define name="content">
        <h:form id="frmMain">

            <p:panel id="pnlDP" style="width: 100%;">
                <h:panelGroup id="pnlContenedor" rendered="#{editarTasaPA.datosPredio!=null}">
                    <p:panelGrid  style="width: 100%;" styleClass="noBorder" >
                        <f:facet name="header">  
                            <p:row>  
                                <p:column >Sector</p:column>  
                                <p:column >Mnz.</p:column>  
                                <p:column >Cdla.</p:column>  
                                <p:column >Mnz. Div</p:column>  
                                <p:column>Solar</p:column>  
                                <p:column>Div1</p:column>  
                                <p:column>Div2</p:column>  
                                <p:column>Div3</p:column>  
                                <p:column>Div4</p:column>  
                                <p:column>Div5</p:column>  
                                <p:column>Div6</p:column>  
                                <p:column>Div7</p:column>  
                                <p:column>Div8</p:column>  
                                <p:column>Div9</p:column>  
                                <!--p:column>Buscar</p:column-->
                            </p:row>  
                        </f:facet>
                        <p:row style="width: 100%;">
                            <p:column><p:inputText style="width: 100%" readonly="true" value="#{editarTasaPA.datosPredio.sector}"/></p:column>
                            <p:column><p:inputText style="width: 100%" readonly="true" value="#{editarTasaPA.datosPredio.mz}"/></p:column>
                            <p:column><p:inputText style="width: 100%" readonly="true" value="#{editarTasaPA.datosPredio.cdla}"/></p:column>
                            <p:column><p:inputText style="width: 100%" readonly="true" value="#{editarTasaPA.datosPredio.mzdiv}"/></p:column>
                            <p:column><p:inputText style="width: 100%" readonly="true" value="#{editarTasaPA.datosPredio.solar}"/></p:column>
                            <p:column><p:inputText style="width: 100%" readonly="true" value="#{editarTasaPA.datosPredio.div1}"/></p:column>
                            <p:column><p:inputText style="width: 100%" readonly="true" value="#{editarTasaPA.datosPredio.div2}"/></p:column>
                            <p:column><p:inputText style="width: 100%" readonly="true" value="#{editarTasaPA.datosPredio.div3}"/></p:column>
                            <p:column><p:inputText style="width: 100%" readonly="true" value="#{editarTasaPA.datosPredio.div4}"/></p:column>
                            <p:column><p:inputText style="width: 100%" readonly="true" value="#{editarTasaPA.datosPredio.div5}"/></p:column>
                            <p:column><p:inputText style="width: 100%" readonly="true" value="#{editarTasaPA.datosPredio.div6}"/></p:column>
                            <p:column><p:inputText style="width: 100%" readonly="true" value="#{editarTasaPA.datosPredio.div7}"/></p:column>
                            <p:column><p:inputText style="width: 100%" readonly="true" value="#{editarTasaPA.datosPredio.div8}"/></p:column>
                            <p:column><p:inputText style="width: 100%" readonly="true" value="#{editarTasaPA.datosPredio.div9}"/></p:column>
                            <!--p:column><p:commandButton update="frmMain" actionListener="#{editarTasaPA.buscarPredio}" style="color: #ffffff; background: #616161 !important; font-weight: bold; height: 30px; float: right" value="Buscar" /></p:column-->
                        </p:row>
                    </p:panelGrid>

                    <p:column colspan="5" style="text-align: center;">
                        <h:outputText value="Propietarios: " style="font-weight: bold;font-size: 14px"/>
                    </p:column>
                    <center>   
                        <h:panelGroup styleClass="noBorder">
                            <p:dataTable    id="dtpropietarios" paginatorPosition="top"
                                            rows="5"
                                            paginator="true"
                                            value="#{editarTasaPA.lisPropietarios}" var="itemP"
                                            emptyMessage="No tiene datos" style="width: 75%">
                                <p:column headerText="#C.I. o R.U.C." style="width: 75%;">
                                    <h:outputText value="#{itemP.ente.ciRuc}" style="text-transform: uppercase;"/>
                                </p:column>
                                <p:column headerText="Propietario" style="width: 75%;">
                                    <h:outputText value="#{itemP.ente.nombreComercial}" rendered="#{!itemP.ente.esPersona}" style="text-transform: uppercase;"/>
                                    <h:outputText value="#{itemP.ente.nombres} #{itemP.ente.apellidos}" rendered="#{itemP.ente.esPersona}" style="text-transform: uppercase;"/>
                                </p:column>
                            </p:dataTable>
                        </h:panelGroup>
                    </center>
                    <p:panelGrid style="width: 100%;" >
                        <f:facet name="header">
                            Ubicación
                        </f:facet>
                        <p:row style="width: 100%;">
                            <p:column><h:outputText value="Cantón :" style="margin-right: 25px;"/> <p:inputText value="#{editarTasaPA.canton.nombre}" style="width: 75%" readonly="true"/></p:column>
                            <p:column><h:outputText value="Parroquia :" style="margin-right: 25px;"/> <p:inputText value="#{editarTasaPA.parroquia.descripcion}" style="width: 75%" readonly="true"/></p:column>
                            <p:column><h:outputText value="Urbanización :" style="margin-right: 25px;"/> <p:inputText value="#{editarTasaPA.datosPredio.ciudadela.nombre}" style="width: 75%" readonly="true"/></p:column>
                            <p:column><h:outputText value="Calle :" style="margin-right: 25px;"/> <p:inputText  value="#{editarTasaPA.datosPredio.calle}" style="width: 75%"/></p:column>

                        </p:row>
                        <p:row>
                            <p:column colspan="2"><h:outputText value="Código Catastral Actual :" style="margin-right: 25px;"/> <p:inputText value="#{editarTasaPA.codigoCatastral}" readonly="true" style="width: 70%"/></p:column>
                            <p:column><h:outputText value="Mz :" style="margin-right: 75px;"/> <p:inputText value="#{editarTasaPA.datosPredio.mz}" readonly="true" style="width: 75%"/></p:column>
                            <p:column><h:outputText value="Solar :" style="margin-right: 25px;"/> <p:inputText value="#{editarTasaPA.datosPredio.solar}" readonly="true" style="width: 75%"/></p:column>
                        </p:row>
                    </p:panelGrid>
                    <p:panel id="panelDatosDelPermiso" header="Datos del Permiso">
                        <p:panelGrid columns="5">
                            <h:outputText value="Tipo de permiso:"/>
                            <h:outputText value="Trámite #:"/>
                            <h:outputText value="Fecha de ingreso:"/>
                            <h:outputText value="Fecha de emisión:"/>
                            <h:outputText value="Fecha de caducidad:"/>
                            <h:outputText value="#{editarTasaPA.permisoAdicional.tipoPermisoAdicional.descripcion}"/>
                            <h:outputText value="#{editarTasaPA.ht.id}"/>
                            <p:calendar value="#{editarTasaPA.permisoAdicional.fechaIngresoTramite}" pattern="dd/MM/yyyy"/>
                            <p:calendar value="#{editarTasaPA.permisoAdicional.fechaEmision}" disabled="true" pattern="dd/MM/yyyy"/>
                            <p:calendar value="#{editarTasaPA.permisoAdicional.fechaCaducidad}" pattern="dd/MM/yyyy"/>
                        </p:panelGrid>
                    </p:panel>
                    <center>
                        <p:panel id="panelResponsable" header="Ingreso de Datos">
                            <p:panelGrid columns="2">
                                <h:panelGroup>
                                    <p:panelGrid columns="2">
                                        <h:outputText value="C.I. técnico responsable:"/>
                                        <p:panelGrid columns="2">
                                            <p:inputText value="#{editarTasaPA.usuario.ente.ciRuc}" readonly="true"/>
                                            <p:commandLink value="Buscar" actionListener="#{editarTasaPA.buscarEnte()}" update="datosResponsableForm" disabled="true"/>
                                        </p:panelGrid>
                                        <h:outputText value="Nombre del responsable técnico:"/>
                                        <p:inputText value="#{editarTasaPA.nombreResponsable}" readonly="true" style="width: 100%;"/>
                                        <h:outputText value="Reg. Prof.:"/>
                                        <p:inputText value="#{editarTasaPA.regProfResponsable}" readonly="true" style="width: 100%;"/>
                                    </p:panelGrid>
                                </h:panelGroup>
                                <h:panelGroup>
                                    <p:panelGrid columns="2">
                                        <h:outputText value="Sector:"/>
                                        <p:inputText value="#{editarTasaPA.datosPredio.sector}"/>
                                        <h:outputText value="Urbanización:"/>
                                        <h:panelGroup>
                                            <center>
                                                <p:selectOneMenu value="#{editarTasaPA.permisoAdicional.urbanizacion}" converter="entityConverter" style="width: 80%;">
                                                    <f:selectItem itemLabel="Seleccionar" itemValue="#{null}" />
                                                    <f:selectItems value="#{editarTasaPA.catCiudadelaList}" var="modelo" itemValue="#{modelo}" itemLabel="#{modelo.nombre}"/>
                                                </p:selectOneMenu>
                                            </center>
                                        </h:panelGroup>
                                        <h:outputText value="Calle:"/>
                                        <p:inputText value="#{editarTasaPA.datosPredio.calle}"/>
                                        <h:outputText value="Mz:"/>
                                        <p:inputText value="#{editarTasaPA.datosPredio.mz}" readonly="true"/>
                                        <h:outputText value="Solar:"/>
                                        <p:inputText value="#{editarTasaPA.datosPredio.solar}" readonly="true"/>
                                        <h:outputText value="Código catastral:"/>
                                        <p:inputText value="#{editarTasaPA.datosPredio.codigoPredial}" readonly="true"/>
                                    </p:panelGrid>
                                </h:panelGroup>
                                <h:panelGroup>

                                    <p:dataTable id="dtPermisos" value="#{editarTasaPA.peDetallePermisosAdicionalesList}" var="dpa"
                                                 rows="5" paginator="true" reflow="true" style="width: 100%">

                                        <p:column headerText="Descripcion" style="width: 25%">
                                            #{dpa.descripcion}
                                        </p:column>
                                        <p:column headerText="Cantidad" style="width: 25%">
                                            #{dpa.area}
                                        </p:column>
                                        <p:column headerText="Unidad" style="width: 25%">
                                            #{dpa.unidadMedida.abreviatura}
                                        </p:column>
                                        <p:column headerText="Acción" style="width: 20%">
                                            <center><p:commandLink update="dtPermisos" actionListener="#{editarTasaPA.eliminarDetallePermisoAdicional(dpa)}" style="height: 30px;" value="Eliminar"  /></center>
                                        </p:column>
                                    </p:dataTable>

                                </h:panelGroup>
                                <h:panelGroup>
                                    <p:panelGrid columns="2" layout="grid">
                                        <h:outputText value="Permiso Adicional"/>
                                        <p:inputText value="#{editarTasaPA.permisoAdicional.id}" disabled="true"/>
                                        <h:outputText value="Área del solar:"/>
                                        <p:inputText value="#{editarTasaPA.permisoAdicional.areaSolar}" />
                                        <h:outputText value="N° de pisos sobre nivel del bordillo:"/>
                                        <p:inputText value="#{editarTasaPA.permisoAdicional.numPisosSnb}" />
                                        <h:outputText value="N° de pisos bajo nivel del bordillo:"/>
                                        <p:inputText value="#{editarTasaPA.permisoAdicional.numPisosBnb}" />
                                        <h:outputText value="Altura de construcción:"/>
                                        <p:inputText value="#{editarTasaPA.permisoAdicional.alturaConst}" />
                                        <h:outputText value="Total a edificar:"/>
                                        <p:inputText value="#{editarTasaPA.permisoAdicional.totalEdificar}" />
                                    </p:panelGrid>
                                </h:panelGroup>
                                <h:panelGroup>
                                    <p:panelGrid columns="2" id="nuevoPGroup">
                                        <h:outputText value="Estructura:"/>
                                        <h:panelGroup>
                                            <center>
                                                <p:selectOneMenu value="#{editarTasaPA.estructura}" converter="entityConverter" style="width: 80%;">
                                                    <f:selectItem itemLabel="Seleccionar" itemValue="#{null}" />
                                                    <f:selectItems value="#{editarTasaPA.estructuraList}" var="model" itemValue="#{model}" itemLabel="#{model.nombre}"/>
                                                </p:selectOneMenu>
                                            </center>
                                        </h:panelGroup>
                                        <h:outputText value="Instalación:"/>
                                        <h:panelGroup>
                                            <center>
                                                <p:selectOneMenu value="#{editarTasaPA.instalacion}" converter="entityConverter" style="width: 80%;">
                                                    <f:selectItem itemLabel="Seleccionar" itemValue="#{null}" />
                                                    <f:selectItems value="#{editarTasaPA.instalacionesElecList}" var="model2" itemValue="#{model2}" itemLabel="#{model2.nombre}"/>
                                                </p:selectOneMenu>
                                            </center>
                                        </h:panelGroup>
                                        <h:outputText value="Piso PB:"/>
                                        <h:panelGroup>
                                            <center>
                                                <p:selectOneMenu value="#{editarTasaPA.pisoPB}" converter="entityConverter" style="width: 80%;">
                                                    <f:selectItem itemLabel="Seleccionar" itemValue="#{null}" />
                                                    <f:selectItems value="#{editarTasaPA.pisosList}" var="model3" itemValue="#{model3}" itemLabel="#{model3.nombre}"/>
                                                </p:selectOneMenu>
                                            </center>
                                        </h:panelGroup>
                                        <h:outputText value="Piso PA:"/>
                                        <h:panelGroup>
                                            <center>
                                                <p:selectOneMenu value="#{editarTasaPA.pisoPA}" converter="entityConverter" style="width: 80%;">
                                                    <f:selectItem itemLabel="Seleccionar" itemValue="#{null}" />
                                                    <f:selectItems value="#{editarTasaPA.pisosList}" var="model4" itemValue="#{model4}" itemLabel="#{model4.nombre}"/>
                                                </p:selectOneMenu>
                                            </center>
                                        </h:panelGroup>
                                        <h:outputText value="Cubierta:"/>
                                        <h:panelGroup>
                                            <center>
                                                <p:selectOneMenu value="#{editarTasaPA.cubierta}" converter="entityConverter" style="width: 80%;">
                                                    <f:selectItem itemLabel="Seleccionar" itemValue="#{null}" />
                                                    <f:selectItems value="#{editarTasaPA.cubiertaList}" var="model5" itemValue="#{model5}" itemLabel="#{model5.nombre}"/>
                                                </p:selectOneMenu>
                                            </center>
                                        </h:panelGroup>
                                        <h:outputText value="Paredes:"/>
                                        <h:panelGroup>
                                            <center>
                                                <p:selectOneMenu value="#{editarTasaPA.paredes}" converter="entityConverter" style="width: 80%;">
                                                    <f:selectItem itemLabel="Seleccionar" itemValue="#{null}" />
                                                    <f:selectItems value="#{editarTasaPA.paredesList}" var="model6" itemValue="#{model6}" itemLabel="#{model6.nombre}"/>
                                                </p:selectOneMenu>
                                            </center>
                                        </h:panelGroup>
                                        <h:outputText value="Línea de fabrica"/>
                                        <h:panelGroup>
                                            <center>
                                                <p:inputText value="#{editarTasaPA.lineaFabrica}" style="width: 80%;"/>
                                            </center>
                                        </h:panelGroup>
                                        <h:outputText value="Descripción:"/>
                                        <p:inputTextarea style="float: right; width: 250px;" rows="3" cols="60"  value="#{editarTasaPA.descripcion}"/>         
                                    </p:panelGrid>
                                </h:panelGroup>
                            </p:panelGrid>
                        </p:panel>

                        <p:panel id="panelIng" header="Responsable" style="width: 200px;">
                            <center>
                                <p:selectOneMenu value="#{editarTasaPA.htd.firma}" converter="entityConverter" style="width: 100%;">
                                    <f:selectItems value="#{editarTasaPA.firmas}" var="modelF" itemValue="#{modelF}" itemLabel="#{modelF.nomCompleto}"/>
                                </p:selectOneMenu>
                            </center>
                        </p:panel>
                    </center>
                    <h:panelGroup id="botonesGroup">
                        <p:commandButton style="color: #ffffff; width: 150px; background: #616161 !important; font-weight: bold; height: 30px;" value="Regresar"  />
                    </h:panelGroup>

                </h:panelGroup>
                <h:panelGroup rendered="#{editarTasaPA.datosPredio==null}">
                    <center>
                        <h1>
                            Hubo un error en el trámite.
                        </h1>
                    </center>
                </h:panelGroup>
            </p:panel>
        </h:form>

    </ui:define>
</ui:composition>