<ui:composition 
    xmlns="http://www.w3.org/1999/xhtml"
    template="/template/template.xhtml"
    xmlns:f="http://xmlns.jcp.org/jsf/core"
    xmlns:h="http://xmlns.jcp.org/jsf/html" xmlns="http://www.w3.org/1999/xhtml"
    xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
    xmlns:p="http://primefaces.org/ui"
    xmlns:pe="http://primefaces.org/ui/extensions"
    xmlns:dialog="http://xmlns.jcp.org/jsf/composite/dialog">
    <ui:define name="meta">
    </ui:define>

    <ui:define name="content">
        <h:form id="mainForm">
            <p:panelGrid styleClass="noBorder" columns="4" style="width: 100%;font-size: 14px;">
                <p:outputLabel value="Tarea: #{comprobarCertificadoRP.taskDataByTaskID.name}" style="font-weight: bolder;color: #005f9c"/>
                <p:outputLabel value="TrÃ¡mite: #{comprobarCertificadoRP.tramite.id}" style="font-weight: bolder;color: #005f9c"/>
                <p:outputLabel value="Responsable: #{comprobarCertificadoRP.taskDataByTaskID.assignee}" style="font-weight: bolder;color: #005f9c"/>
            </p:panelGrid>
            <p:tabView id="tdatos">
                <p:tab id="tgen" title="Tasa de liquidacion">
                    <p:panelGrid id="pgSolicitante" columns="4" styleClass="noBorder" style="width: 100%;">
                        <f:facet name="header">
                            <p:column colspan="4">
                                Datos Generales : #{generarTasaLiqRP.tramite.tipoTramite.descripcion}
                            </p:column>
                        </f:facet>
                        <h:outputText value="Solicitante " style="font-weight: bold; text-transform: uppercase"/>
                        <h:outputText value="#{comprobarCertificadoRP.tramite.solicitante.apellidos} #{comprobarCertificadoRP.tramite.solicitante.nombres}" rendered="#{comprobarCertificadoRP.tramite.solicitante.esPersona}" style="text-transform: uppercase"/>
                        <h:outputText value="#{comprobarCertificadoRP.tramite.solicitante.razonSocial}" rendered="#{!comprobarCertificadoRP.tramite.solicitante.esPersona}" style="text-transform: uppercase"/>
                        <h:outputText value="No. Identificacion " style="font-weight: bold; text-transform: uppercase"/>
                        <h:outputText value="#{comprobarCertificadoRP.tramite.solicitante.ciRuc}" style="text-transform: uppercase"/>
                        <h:outputText value="Predio Referencial " style="font-weight: bold; text-transform: uppercase"/>
                        <h:outputText value="#{comprobarCertificadoRP.tramite.numPredio}" style=" text-transform: uppercase"/>
                        <h:outputText value="Codigo predial " style="font-weight: bold; text-transform: uppercase"/>
                        <h:outputText value="#{comprobarCertificadoRP.predio.sector} - #{comprobarCertificadoRP.predio.mz} - #{comprobarCertificadoRP.predio.cdla} - #{comprobarCertificadoRP.predio.mzdiv} - #{comprobarCertificadoRP.predio.solar} - #{comprobarCertificadoRP.predio.div1} - #{comprobarCertificadoRP.predio.div2} - #{comprobarCertificadoRP.predio.div3} - 
                                      #{comprobarCertificadoRP.predio.div4} - #{comprobarCertificadoRP.predio.div5} - #{comprobarCertificadoRP.predio.div6} - #{comprobarCertificadoRP.predio.div7} - #{comprobarCertificadoRP.predio.div8} - 
                                      #{comprobarCertificadoRP.predio.div9} - #{comprobarCertificadoRP.predio.phv} - #{comprobarCertificadoRP.predio.phh} " style="text-transform: uppercase"/>
                        <h:outputText value="Urbanizacion " style="font-weight: bold; text-transform: uppercase"/>
                        <h:outputText value="#{comprobarCertificadoRP.predio.ciudadela.nombre}" style="text-transform: uppercase"/>
                        <h:outputText value="Calle " style="font-weight: bold; text-transform: uppercase"/>
                        <h:outputText value="#{comprobarCertificadoRP.predio.calle}" style="text-transform: uppercase"/>
                    </p:panelGrid>
                    <br/>
                    <p:dataTable id="dtPredios" value="#{comprobarCertificadoRP.predio.catPredioPropietarioCollection}" var="p" reflow="true" style="width: 100%">
                        <f:facet name="header">Listado de propietarios</f:facet>
                        <p:column headerText="Identificacion" style="width: 30%; text-align: center">
                            <p:outputLabel value="#{p.ente.ciRuc}"/>
                        </p:column>
                        <p:column headerText="Propietario" style="width: 70%">
                            <p:outputLabel value="#{p.ente.razonSocial}" rendered="#{!p.ente.esPersona}"/>
                            <p:outputLabel value="#{p.ente.apellidos} #{p.ente.nombres}" rendered="#{p.ente.esPersona}"/>
                        </p:column>
                    </p:dataTable>
                    <br/>
                    <p:panel id="datosreporte" style="width: 100%" header="Detalle del Tramite">  
                        <p:dataTable id="dtDetalle" value="#{comprobarCertificadoRP.tramite.historicoTramiteDetCollection}" var="dt" reflow="true" style="width: 100%">
                            <p:column headerText="Num. Planos">
                                <p:outputLabel value="#{dt.numPlanos}"/>
                            </p:column>
                            <p:column headerText="Observacion">
                                <p:outputLabel value="#{dt.descripcion}"/>
                            </p:column>
                            <p:column headerText="Responsable">
                                <p:outputLabel value="#{dt.responsable}"/>
                            </p:column>
                            <p:column headerText="Total a pagar">
                                <p:outputLabel value="#{dt.total}"/>
                            </p:column>
                        </p:dataTable>
                        <br/>
                        <h:outputText value="Estatus : #{comprobarCertificadoRP.mensaje}" style="font-weight: bold; text-transform: uppercase"/>
                        <p:spacer width="5px"/>
                        <h:panelGroup id="botonesGroup">
                            <center>
                                <p:commandButton value="Entregar Certificado" update="frmObs" onclick="PF('obs').show()" rendered="#{comprobarCertificadoRP.mostrarBoton}" icon="ui-icon-check" styleClass="btnStyle" style="height: 30px;" />
                            </center>
                        </h:panelGroup>
                    </p:panel>
                </p:tab>
                <p:tab id="tdocs" title="Observaciones">
                    <p:dataTable id="dtobs" value="#{comprobarCertificadoRP.tramite.observacionesCollection}" var="obs" reflow="true" style="width: 100%">
                        <f:facet name="header">Observaciones</f:facet>
                        <p:column headerText="Descripcion" style="width: 40%">
                            #{obs.observacion}
                        </p:column>
                        <p:column headerText="tarea" style="width: 25%">
                            #{obs.tarea}
                        </p:column>
                        <p:column headerText="Responsable" style="width: 20%">
                            #{obs.userCre}
                        </p:column>
                        <p:column headerText="Fecha" style="width: 15%">
                            #{obs.fecCre}
                        </p:column>
                    </p:dataTable>
                </p:tab>
                <p:tab id="tobs" title="Documentos">
                    <dialog:detalleArchivosAct archivos="#{comprobarCertificadoRP.processInstanceAllAttachmentsFiles}" />
                </p:tab>
            </p:tabView>
        </h:form>
        <p:dialog id="dlgObs" widgetVar="obs" header="#{comprobarCertificadoRP.tramite.tipoTramiteNombre}" appendTo="@(body)" modal="true" width="500" resizable="false" closable="true" closeOnEscape="true">
            <h:form id="frmObs" target="_blank">
                <p:panel id="pobs" header="Ingrese sus observaciones" style="width: 100%">
                    <div align="center">
                        <p:inputTextarea id="obsservacion" value="#{comprobarCertificadoRP.obs.observacion}" rows="4" style="width: 100%; text-transform: uppercase" required="true" placeholder="Las observaciones son obligatorias para continuar con el tramite"/>
                        <br/>
                        <p:commandButton id="btnValidar" value="Finalizar"  actionListener="#{comprobarCertificadoRP.completarTarea()}" oncomplete="PF('obs').hide()" style="color: #ffffff; background: #616161 !important; font-weight: bold; height: 30px"/>
                    </div>
                </p:panel>
            </h:form>
        </p:dialog>
    </ui:define>
</ui:composition>