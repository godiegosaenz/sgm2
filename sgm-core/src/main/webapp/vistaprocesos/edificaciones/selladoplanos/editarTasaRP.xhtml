<ui:composition 
    xmlns="http://www.w3.org/1999/xhtml"
    template="/template/template.xhtml"
    xmlns:f="http://xmlns.jcp.org/jsf/core"
    xmlns:h="http://xmlns.jcp.org/jsf/html" xmlns="http://www.w3.org/1999/xhtml"
    xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
    xmlns:p="http://primefaces.org/ui"
    xmlns:pe="http://primefaces.org/ui/extensions"
    xmlns:dialog="http://xmlns.jcp.org/jsf/composite/dialog">
    
    <ui:define name="content">
        <p:panelGrid styleClass="noBorder" columns="4" style="width: 100%;font-size: 14px;">
            <p:outputLabel value="Trámite: #{generarTasaLiqRP.tramite.id}" style="font-weight: bolder;color: #005f9c"/>
            <p:outputLabel value="Tarea: #{generarTasaLiqRP.taskDataByTaskID.name}" style="font-weight: bolder;color: #005f9c"/>
            <p:outputLabel value="Responsable: #{generarTasaLiqRP.taskDataByTaskID.assignee}" style="font-weight: bolder;color: #005f9c"/>
        </p:panelGrid>  
        <h:form id="mainForm">
            <p:panel id="pDatos" header="Datos Generales : #{generarTasaLiqRP.tramite.tipoTramite.descripcion}" style="width: 100%">
                <br/>
                <p:panelGrid id="pgSolicitante" columns="4" styleClass="noBorder">
                    <h:outputText value="Solicitante " style="font-weight: bold; text-transform: uppercase"/>
                    <h:outputText value="#{generarTasaLiqRP.tramite.solicitante.apellidos} #{generarTasaLiqRP.tramite.solicitante.nombres}" rendered="#{generarTasaLiqRP.tramite.solicitante.esPersona}" style="text-transform: uppercase"/>
                    <h:outputText value="#{generarTasaLiqRP.tramite.solicitante.razonSocial}" rendered="#{!generarTasaLiqRP.tramite.solicitante.esPersona}" style="text-transform: uppercase"/>
                    <h:outputText value="No. Identificacion " style="font-weight: bold; text-transform: uppercase"/>
                    <h:outputText value="#{generarTasaLiqRP.tramite.solicitante.ciRuc}" style="text-transform: uppercase"/>
                    <h:outputText value="Predio Referencial " style="font-weight: bold; text-transform: uppercase"/>
                    <h:outputText value="#{generarTasaLiqRP.tramite.numPredio}" style=" text-transform: uppercase"/>
                    <h:outputText value="Codigo predial " style="font-weight: bold; text-transform: uppercase"/>
                    <h:outputText value="#{generarTasaLiqRP.predio.sector} - #{generarTasaLiqRP.predio.mz} - #{generarTasaLiqRP.predio.cdla} - #{generarTasaLiqRP.predio.mzdiv} - #{generarTasaLiqRP.predio.solar} - #{generarTasaLiqRP.predio.div1} - #{generarTasaLiqRP.predio.div2} - #{generarTasaLiqRP.predio.div3} - 
                                  #{generarTasaLiqRP.predio.div4} - #{generarTasaLiqRP.predio.div5} - #{generarTasaLiqRP.predio.div6} - #{generarTasaLiqRP.predio.div7} - #{generarTasaLiqRP.predio.div8} - 
                                  #{generarTasaLiqRP.predio.div9} - #{generarTasaLiqRP.predio.phv} - #{generarTasaLiqRP.predio.phh} " style="text-transform: uppercase"/>
                    <h:outputText value="Urbanizacion " style="font-weight: bold; text-transform: uppercase"/>
                    <h:outputText value="#{generarTasaLiqRP.predio.ciudadela.nombre}" style="text-transform: uppercase"/>
                    <h:outputText value="Calle " style="font-weight: bold; text-transform: uppercase"/>
                    <h:outputText value="#{generarTasaLiqRP.predio.calle}" style="text-transform: uppercase"/>
                    <h:outputText value="Valor avaluo " style="font-weight: bold; text-transform: uppercase"/>
                    <h:outputText value="$#{generarTasaLiqRP.tramite.valorLiquidacion}" style="text-transform: uppercase"/>
                </p:panelGrid>
                <br/>
                <p:tabView id="tdatos">
                    <p:tab id="tgen" title="Tasa de liquidacion">
                        <p:dataTable id="dtPredios" value="#{generarTasaLiqRP.predio.catPredioPropietarioCollection}" var="p" reflow="true" style="width: 100%">
                            <f:facet name="header">Listado de propietarios</f:facet>
                            <p:column headerText="Identificacion" style="width: 30%; text-align: center">
                                <p:outputLabel value="#{p.ente.ciRuc}"/>
                            </p:column>
                            <p:column headerText="Propietario" style="width: 70%">
                                <p:outputLabel value="#{p.ente.razonSocial}" rendered="#{!p.ente.esPersona}"/>
                                <p:outputLabel value="#{p.ente.apellidos} #{p.ente.nombres}" rendered="#{p.ente.esPersona}"/>
                            </p:column>
                        </p:dataTable>
                        <br/>
                        <p:panel id="datosreporte" style="width: 100%">  
                            <p:panelGrid id="caracteristica" style="width: 80%">
                                <p:row>
                                    <p:column >
                                        <center><b>CARACTERÍSTICAS DEL PREDIO</b></center>
                                    </p:column>
                                    <p:column>
                                    </p:column>
                                    <p:column>
                                        <center><b>DESCRIPCIÓN DE LA EDIFICACIÓN</b></center>
                                    </p:column>
                                </p:row>
                                <p:row>
                                    <p:column headerText="CARACTERÍSTICAS DEL PREDIO" >
                                        <p:outputLabel value="N./Piso sobre nivel bordillo"/>
                                    </p:column>
                                    <p:column>
                                        <pe:inputNumber value="#{generarTasaLiqRP.avaluo.numPisosSobreBord}" decimalPlaces="0">
                                        </pe:inputNumber>
                                    </p:column>
                                    <p:column headerText="DESCRIPCIÓN DE LA EDIFICACIÓN">
                                        Planos Ingresados :  <pe:inputNumber value="#{generarTasaLiqRP.avaluo.numPlanos}" decimalPlaces="0" >
                                            <p:ajax event="change" listener="#{generarTasaLiqRP.calcularTotal()}" update="mainForm"/>
                                        </pe:inputNumber>
                                    </p:column>
                                </p:row>
                                <p:row>
                                    <p:column >
                                        <p:outputLabel value="N./Piso bajo nivel bordillo"/>
                                    </p:column>
                                    <p:column>
                                        <pe:inputNumber value="#{generarTasaLiqRP.avaluo.numPisosBajoBord}" decimalPlaces="0"/>
                                    </p:column>
                                    <p:column rowspan="5">
                                        <p:inputTextarea id="descripcionid" value="#{generarTasaLiqRP.avaluo.descripcion}" rows="10" cols="50" style="width: 100%" readonly="true"/>
                                    </p:column>
                                </p:row>
                                <p:row>
                                    <p:column >
                                        <p:outputLabel value="Área de Edificación"/>
                                    </p:column>
                                    <p:column>
                                        <pe:inputNumber value="#{generarTasaLiqRP.avaluo.areaEdificacion}">
                                        </pe:inputNumber>
                                    </p:column>
                                </p:row>
                                <p:row>
                                    <p:column >
                                        <p:outputLabel value="Avaluo de Construcción"/>
                                    </p:column>
                                    <p:column>
                                        <pe:inputNumber id="avaluoConstrid" value="#{generarTasaLiqRP.avaluo.avaluoConstruccion}" >
                                        </pe:inputNumber>
                                    </p:column>
                                </p:row>
                                <p:row>
                                    <p:column >
                                        <p:outputLabel value="Avaluo del Solar"/>
                                    </p:column>
                                    <p:column>
                                        <pe:inputNumber value="#{generarTasaLiqRP.avaluo.avaluoSolar}" >
                                        </pe:inputNumber>
                                    </p:column>
                                </p:row>
                                <p:row>
                                    <p:column >
                                        <p:outputLabel value="Avaluo de la Propiedad"/>
                                    </p:column>
                                    <p:column>
                                        <pe:inputNumber id="avaluoid" value="#{generarTasaLiqRP.avaluo.avaluoPropiedad}" />
                                    </p:column>
                                </p:row>
                            </p:panelGrid>
                            <p:spacer width="5px"/>
                            <p:panelGrid id="result" style="width: 40%">
                                <p:row>
                                    <p:column>
                                        <center><b>BASE DEL CÁLCULO ($)</b></center>
                                    </p:column>
                                    <p:column>
                                        <center><b>TOTAL A PAGAR</b></center>
                                    </p:column>
                                </p:row>
                                <p:row>
                                    <p:column style="text-align: center">
                                        <pe:inputNumber value="#{generarTasaLiqRP.avaluo.baseCalculo}" decimalPlaces="0" symbol="$"  symbolPosition="p" disabled="true"/>
                                    </p:column>
                                    <p:column style="text-align: center">
                                        <p:inputText id="totalpagar" value="#{generarTasaLiqRP.avaluo.total}"  readonly="true"/>
                                    </p:column>
                                </p:row>
                                <p:row>
                                    <p:column colspan="3">
                                        Director(a) de Edificaciones: <br/>
                                        <p:selectOneMenu value="#{generarTasaLiqRP.avaluo.firma}" effect="fade" converter="entityConverter"> 
                                            <f:selectItems value="#{generarTasaLiqRP.firmas}" var="item" itemLabel="#{item.nomCompleto}" itemValue="#{item}"/>  
                                        </p:selectOneMenu>
                                    </p:column>
                                </p:row>
                                <p:row>
                                    <p:column colspan="3" >
                                        Responsable: <br/>
                                        <p:inputText value="#{generarTasaLiqRP.avaluo.responsable}" style="width: 300px" readonly="true"/>
                                    </p:column>
                                </p:row>
                            </p:panelGrid>
                            <br/>
                            <h:panelGroup id="botonesGroup">
                                <center>
                                    <p:commandButton id="btnGuardar" rendered="#{!generarTasaLiqRP.cert}" update="botonesGroup" actionListener="#{generarTasaLiqRP.guardar()}" icon="ui-icon-document" style="color: #ffffff; width: 150px; background: #616161 !important; font-weight: bold; height: 30px;" value="Editar tasa"  />
                                    <p:commandButton id="btnImp" rendered="#{generarTasaLiqRP.cert}" ajax="false"  actionListener="#{generarTasaLiqRP.imprimirLiq()}" icon="ui-icon-print" style="color: #ffffff; width: 150px; background: #616161 !important; font-weight: bold; height: 30px;" value="Imprimir Tasa"  />
                                    <p:commandButton id="btnFin" value="Mis tareas" actionListener="#{generarTasaLiqRP.continuar()}" style="color: #ffffff; width: 150px; background: #616161 !important; font-weight: bold; height: 30px;" icon="ui-icon-check"/>
                                </center>
                            </h:panelGroup>
                        </p:panel>
                    </p:tab>
                    <p:tab id="tadicionales" title="Adicionales">
                        <p:tabView id="tadic">
                            <p:tab id="tdocs" title="Observaciones">
                                <p:dataTable id="dtobs" value="#{generarTasaLiqRP.tramite.observacionesCollection}" var="obs" reflow="true" style="width: 100%">
                                    <f:facet name="header">Observaciones</f:facet>
                                    <p:column headerText="Descripcion" style="width: 40%">
                                        #{obs.observacion}
                                    </p:column>
                                    <p:column headerText="tarea" style="width: 25%">
                                        #{obs.tarea}
                                    </p:column>
                                    <p:column headerText="Responsable" style="width: 20%">
                                        #{obs.userCre}
                                    </p:column>
                                    <p:column headerText="Fecha" style="width: 15%">
                                        #{obs.fecCre}
                                    </p:column>
                                </p:dataTable>
                            </p:tab>
                            <p:tab id="tobs" title="Documentos">
                                <dialog:detalleArchivosAct archivos="#{generarTasaLiqRP.processInstanceAttachmentsFiles}" />
                            </p:tab>
                        </p:tabView>
                    </p:tab>
                </p:tabView>
            </p:panel>
        </h:form>
    </ui:define>
</ui:composition>