<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE composition PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
                template="/template/template.xhtml"
                xmlns:p="http://primefaces.org/ui"
                xmlns:f="http://xmlns.jcp.org/jsf/core"
                xmlns:h="http://xmlns.jcp.org/jsf/html" xmlns="http://www.w3.org/1999/xhtml"
                xmlns:pe="http://primefaces.org/ui/extensions">

    <ui:define name="events">

    </ui:define>

    <ui:define name="page_title">
        Agregar Propietarios
    </ui:define>

    <ui:define name="top">
        <h1>Agregar Propietarios y Datos de escritura.</h1>
    </ui:define>

    <ui:define name="content">
        <h:form id="formIngPropPH"  >
            
            <h:panelGroup rendered="#{generarPH1.esPropietario}" >
                <div align="right">
                    <p:commandButton actionListener="#{generarPH1.agregarPropietarios()}" value="Agregar Propietario" style="height: 30px; text-align: center " styleClass="btnStyle" />
                </div>
                <p:dataTable id="dtProp" value="#{generarPH1.propietarios}" var="p" reflow="true" selectionMode="single" selection="#{generarPH1.enteSelect}" rowKey="#{p.ente.id}" emptyMessage="No hay ningun propietario asociado al predio"  >
                    <p:ajax event="rowSelect" listener="#{generarPH1.onRowSelect}"/>
                    <p:column headerText="Tipo Propietarios" style="width: 15%; ">
                        <p:outputLabel value="#{p.propietarios.tipo.valor}"/>
                    </p:column>
                    <p:column headerText="Apellido/Nombre">
                        <p:outputLabel value="#{p.ente.nombres} #{p.ente.apellidos}" rendered="#{p.ente.esPersona}"/>
                        <p:outputLabel value="#{p.ente.razonSocial}" rendered="#{!p.ente.esPersona}"/>
                    </p:column>
                    <p:column headerText="C.I. / R.U.C" style="width: 15%;">
                        <p:outputLabel value="#{p.ente.ciRuc}" />
                    </p:column>
                    <!--p:column headerText="Email">
                        <p:outputLabel value="#{p.ente.enteCorreoCollection.get(0)}" />
                    </p:column-->
                    <p:column headerText="Opción" style="width: 20%;">
                        <p:commandButton actionListener="#{generarPH1.eliminarPropietario(p)}" value="Eliminar" styleClass="btnStyle" icon="ui-icon-trash"/>
                        <p:commandButton actionListener="#{generarPH1.editarEnte(p)}" value="Editar" styleClass="btnStyle" icon="ui-icon-pencil"/>
                    </p:column>
                </p:dataTable>

                <br/><br/>
                <p:outputLabel value="Nombre en Comprobante de Pago: "/>
                <p:inputText value="#{generarPH1.modelPredios.predio.nomCompPago}" style="width: 30%; "/>

                <br/><br/>
                <p:commandButton value="Siguiente" actionListener="#{generarPH1.siguiente()}" update="formIngPropPH" style="height: 30Px; " styleClass="btnStyle" icon="ui-icon-circle-arrow-e"/>
            </h:panelGroup>

            <h:panelGroup id="pgDatEsc" rendered="#{!generarPH1.esPropietario}">
                <p:panelGrid id="pnDatEscrt" >
                    <f:facet name="header" >
                        <p:column colspan="5" style="font-weight: bold; font-size: 14px;">Dominio y Tenencia</p:column>
                    </f:facet>
                    <p:row>
                        <p:column>
                            <h:outputText value="Tipo Propietario: " style="font-weight: bold"/>  <br/>
                            <p:selectOneMenu value="#{generarPH1.propiedad}" converter="entityConverter">  
                                <f:attribute name="name" value="CatPropiedadItem" />
                                <f:selectItems value="#{generarPH1.catPropiedadItemList}" var="pi" itemLabel="#{pi.nombre}" itemValue="#{pi}"/>  
                            </p:selectOneMenu> 
                        </p:column>
                        <p:column>
                            <h:outputText value="Tipo Tenencia: " style="font-weight: bold"/> <br/>
                            <p:selectOneMenu value="#{generarPH1.tenencia}" converter="entityConverter">  
                                <f:attribute name="name" value="CatTenenciaItem" />
                                <f:selectItems value="#{generarPH1.catTenenciaItemList}" var="ti" itemLabel="#{ti.nombre}" itemValue="#{ti}"/>  
                            </p:selectOneMenu> 
                        </p:column>
                        <p:column colspan="3" >
                            <p:outputLabel value="Soporta predio hipoteca:"/>
                            <p:spacer width="10"/>
                            <p:selectBooleanCheckbox value="#{generarPH1.modelPredios.predio.soportaHipoteca}" />
                        </p:column>
                    </p:row>

                    <p:row>
                        <p:column styleClass="ui-widget-header" colspan="5" style="font-weight: bold; text-align: center; font-size: 14px;">
                            Infraestructura y Servicios - Conexión Domiciliaria de
                        </p:column>
                    </p:row>
                    <p:row>
                        <p:column>
                            <p:outputLabel value="Agua potable:"/>
                            <p:spacer width="10"/>
                            <p:selectBooleanCheckbox value="#{generarPH1.modelPredios.predioS6.tieneAguaPotable}" />
                        </p:column>
                        <p:column>
                            <p:outputLabel value="No. de medidores de Agua:"/>
                            <p:spacer width="10"/>
                            <p:inputText value="#{generarPH1.modelPredios.predioS6.numMedElect}" style="width: 38px;" maxlength="4" />
                        </p:column>
                        <p:column>
                            <p:outputLabel value="Electricidad:"/>
                            <p:spacer width="10"/>
                            <p:selectBooleanCheckbox value="#{generarPH1.modelPredios.predioS6.tieneElectricidad}" />
                        </p:column>
                        <p:column colspan="2">
                            <p:outputLabel value="No. de medidores Elect.:"/>
                            <p:spacer width="10"/> <!-- Cambiar etiqueta -->
                            <p:inputText value="#{generarPH1.modelPredios.predioS6.numMedElect}" style="width: 38px;" maxlength="4"  />
                        </p:column>
                    </p:row>
                    <p:row>
                        <p:column>
                            <p:outputLabel value="Teléfono fijo:"/>
                            <p:spacer width="10"/>
                            <p:selectBooleanCheckbox value="#{generarPH1.modelPredios.predioS6.tieneTelfFijo}" />
                        </p:column>
                        <p:column >
                            <p:outputLabel value="No. telefónico:"/>
                            <p:spacer width="30"/>
                            <p:inputText value="#{generarPH1.modelPredios.predioS6.telfFijo}"  />
                        </p:column>
                        <p:column colspan="3" >
                            <p:outputLabel value="Internet:"/>
                            <p:spacer width="30"/>
                            <p:selectBooleanCheckbox value="#{generarPH1.modelPredios.predioS6.tieneInternet}" />
                        </p:column>
                    </p:row>

                    <p:row>
                        <p:column styleClass="ui-widget-header" colspan="5" style="font-weight: bold; text-align: center; font-size: 14px;">
                            Datos de Escritura
                        </p:column>
                    </p:row>
                    <p:row>
                        <p:column>
                            <p:outputLabel value="Notaria:"/>
                            <p:spacer width="5"/>
                            <p:inputText id="not" value="#{generarPH1.modelPredios.predioS6.notaria}" style="width: 65px;" maxlength="4" />
                            <pe:keyFilter for="not" mask="num" />
                        </p:column>
                        <p:column>
                            <h:outputText value="Cantón: " style="font-weight: bold"/>  <br/>
                            <p:selectOneMenu value="#{generarPH1.canton}" converter="entityConverter">  
                                <f:attribute name="name" value="CatCanton" />
                                <f:selectItem itemLabel="Seleccione..." itemValue="#{null}"/>
                                <f:selectItems value="#{generarPH1.catCantonList}" var="cant" itemLabel="#{cant.nombre}" itemValue="#{cant}"/>  
                            </p:selectOneMenu> 
                        </p:column>
                        <p:column>
                            <p:outputLabel value="Fec. escritura:"/>
                            <p:spacer width="5"/>
                            <p:calendar value="#{generarPH1.modelPredios.predioS6.fechaInscripcion}" />
                        </p:column>
                        <p:column>
                            <p:outputLabel value="Fec. inscripción:"/>
                            <p:spacer width="5"/>
                            <p:calendar value="#{generarPH1.modelPredios.predioS6.fechaEscritura}" />
                        </p:column>
                        <p:column>
                            <p:outputLabel value="No. de registro: "/>
                            <p:spacer width="5"/>
                            <p:inputText value="#{generarPH1.modelPredios.predioS6.numRegistro}" style="width: 65px;" maxlength="4">
                                <f:convertNumber maxIntegerDigits="4" maxFractionDigits="0" type="number"/>
                            </p:inputText>
                        </p:column>
                    </p:row>
                    <p:row>
                        <p:column colspan="3">
                            No. de repertorio:
                            <p:inputText value="#{generarPH1.modelPredios.predioS6.numRepertorio}" style="width: 100px;"  >
                                <f:convertNumber maxFractionDigits="0" type="number"/>
                            </p:inputText>
                            Folio <p:inputText value="#{generarPH1.modelPredios.predioS6.folioDesde}" style="width: 65px" />
                            al <p:inputText value="#{generarPH1.modelPredios.predioS6.folioHasta}" style="width: 65px"/>
                            Área Solar <pe:inputNumber value="#{generarPH1.modelPredios.predioS6.areaSolar}" style="width: 100px" decimalPlaces="2"/>
                        </p:column>
                        <p:column>
                            <p:outputLabel value="Área Cons: "/>
                            <p:spacer width="5"/>
                            <pe:inputNumber value="#{generarPH1.modelPredios.predioS6.areaSolar}" style="width: 100px" decimalPlaces="2"/>
                        </p:column>
                        <p:column>
                            <p:outputLabel value="Trasl. Dominio: "/>
                            <p:spacer width="5"/>
                            <p:selectOneMenu value="#{generarPH1.dominio}" converter="entityConverter">  
                                <f:attribute name="name" value="CatTiposDominio" />
                                <f:selectItem itemLabel="Seleccione..." itemValue="#{null}"/>
                                <f:selectItems value="#{generarPH1.catTiposDominio}" var="d" itemLabel="#{d.nombre}" itemValue="#{d}"/>  
                            </p:selectOneMenu> 
                        </p:column>
                    </p:row>
                </p:panelGrid>
                <br/>
                <p:commandButton value="Guardar" actionListener="#{generarPH1.guardarDatosEscritura()}" icon="ui-icon-disk" style="height: 30px; " styleClass="btnStyle"/>
            </h:panelGroup>
        </h:form>

        <p:dialog id="dIngPro" widgetVar="dIngPro" modal="true" width="550" height="550" closable="true" resizable="false" header="Ingreso de Información">
            <h:form id="formProp">
                <h:panelGrid columns="2" cellspacing="5" cellpadding="5">
                    <h:outputText value="Tipo Propietario: " style="font-weight: bold"/> 
                    <p:selectOneMenu value="#{generarPH1.tipoPropietario}" converter="entityConverter" immediate="true" >  
                        <f:attribute name="name" value="CtlgItem" />
                        <f:selectItems value="#{generarPH1.tiposPropietarios}" var="t" itemLabel="#{t.valor}" itemValue="#{t}"/>  
                    </p:selectOneMenu> 

                    <h:panelGroup>
                        <p:outputLabel value="Es Residente:"/>
                        <p:spacer width="30"/>
                        <p:selectBooleanCheckbox value="#{generarPH1.esResidente}" />
                    </h:panelGroup>

                    <h:panelGroup>
                        <p:outputLabel value="Es Persona Natural:"/>
                        <p:spacer width="30"/>
                        <p:selectBooleanCheckbox value="#{generarPH1.enteNuevo.esPersona}" >
                            <p:ajax update="formProp"/>
                        </p:selectBooleanCheckbox>
                    </h:panelGroup>
                    <!--h:panelGroup-->
                    <p:outputLabel value="Número RUC:" rendered="#{!generarPH1.enteNuevo.esPersona}"/>
                    <p:outputLabel value="Número Cédula:" rendered="#{generarPH1.enteNuevo.esPersona}"/>
                    <!--/h:panelGroup-->

                    <h:panelGroup>
                        <p:inputMask mask="9999999999" value="#{generarPH1.enteNuevo.ciRuc}" rendered="#{generarPH1.enteNuevo.esPersona}"/>
                        <p:inputMask mask="9999999999999" value="#{generarPH1.enteNuevo.ciRuc}" rendered="#{!generarPH1.enteNuevo.esPersona}"/>
                        <p:spacer width="10"/>
                        <p:commandLink actionListener="#{generarPH1.buscarEnte()}" >
                            <p:graphicImage value="/css/homeIconsImages/buscar.png" height="25" width="25"/>
                        </p:commandLink>
                    </h:panelGroup>

                    <p:outputLabel value="Nombres:" rendered="#{generarPH1.enteNuevo.esPersona}"/>
                    <p:inputText value="#{generarPH1.enteNuevo.nombres}" rendered="#{generarPH1.enteNuevo.esPersona}" style="width: 250px;"/>
                    <p:outputLabel value="Razón Social:" rendered="#{!generarPH1.enteNuevo.esPersona}"/>
                    <p:inputText value="#{generarPH1.enteNuevo.nombreComercial}" rendered="#{!generarPH1.enteNuevo.esPersona}" style="width: 250px;"/>

                    <p:outputLabel value="Apellidos:" rendered="#{generarPH1.enteNuevo.esPersona}"/>
                    <p:inputText value="#{generarPH1.enteNuevo.apellidos}" rendered="#{generarPH1.enteNuevo.esPersona}" style="width: 250px;"/>
                    <p:outputLabel value="Representante Legal:" rendered="#{!generarPH1.enteNuevo.esPersona}"/>
                    <h:panelGroup rendered="#{!generarPH1.enteNuevo.esPersona}">
                        <p:inputText value="#{generarPH1.representanteLegal}" rendered="#{!generarPH1.enteNuevo.esPersona}" style="width: 350px;" readonly="true"/>
                        <p:spacer width="10"/>
                        <p:commandLink id="busReprestL" actionListener="#{generarPH1.seleccionarReprest()}"  rendered="#{!generarPH1.enteNuevo.esPersona}" >
                            <p:graphicImage value="/css/homeIconsImages/buscar.png" height="25" width="25"/>
                        </p:commandLink>
                    </h:panelGroup>

                    <p:outputLabel value="Fec. Nacimiento:" rendered="#{generarPH1.enteNuevo.esPersona}"/>
                    <p:calendar value="#{generarPH1.enteNuevo.fechaNacimiento}" rendered="#{generarPH1.enteNuevo.esPersona}"/>

                    <p:outputLabel value="Dirección:"/>
                    <p:inputText value="#{generarPH1.enteNuevo.direccion}" style="width: 350px;"/>                   
                </h:panelGrid>

                <br/>
                <p:dataTable id="dtCorr" value="#{generarPH1.enteNuevo.enteCorreoCollection}" scrollHeight="65" scrollable="true" var="c" emptyMessage="No se encontro ningún correo" style="width: 310px;" >
                    <f:facet name="header">
                        <p:inputText value="#{generarPH1.correo.email}" style="width: 200px"  />
                        <p:commandButton value="Agregar" icon="ui-icon-plus" update="dtCorr" styleClass="btnStyle" actionListener="#{generarPH1.agregarCorreo()}" />
                    </f:facet>
                    <p:column headerText="Correo" >
                        <h:outputLabel value="#{c.email}"/>
                    </p:column>
                    <p:column headerText="Eliminar" width="60" >
                        <p:commandLink value="eliminar" actionListener="#{generarPH1.eliminarCorreo(c)}"/>
                    </p:column>
                </p:dataTable>

                <p:dataTable id="dtTel" value="#{generarPH1.enteNuevo.enteTelefonoCollection}" scrollHeight="65" scrollable="true" var="t" emptyMessage="No se encontro ningún Teléfono" style="width: 255px;">
                    <f:facet name="header">
                        <p:inputText value="#{generarPH1.telefono.telefono}" />
                        <p:commandButton value="Agregar" icon="ui-icon-plus" actionListener="#{generarPH1.agregarTelefono()}" update="dtTel" styleClass="btnStyle"/>
                    </f:facet>
                    <p:column headerText="Teléfono" >
                        <h:outputLabel value="#{t.telefono}"/>
                    </p:column>
                    <p:column headerText="Eliminar"  width="60" >
                        <p:commandLink value="eliminar" actionListener="#{generarPH1.eliminarTelefono(t)}"/>
                    </p:column>
                </p:dataTable>

                <p:commandButton actionListener="#{generarPH1.agragarNuevoProp()}" value="Agregar" rendered="#{generarPH1.nuevo}" icon="ui-icon-plus" style="height: 30px;" styleClass="btnStyle"/>
                <p:commandButton actionListener="#{generarPH1.modificarEnte()}" value="Modificar" rendered="#{!generarPH1.nuevo}" icon="ui-icon-plus" style="height: 30px;" styleClass="btnStyle"/>

            </h:form>
        </p:dialog>

        <p:dialog id="dSelectRep" header="Representantes" widgetVar="dSelectRep" resizable="false" modal="false" position="center" closable="true" width="800">
            <h:form id="formSelectRep">
                <p:dataTable id="dtIntervLazy" paginator="true" lazy="true" rows="10" rowsPerPageTemplate="10,30,50" scrollHeight="350" scrollable="true"
                             paginatorTemplate="{FirstPageLink} {PreviousPageLink} {PageLinks} {CurrentPageReport} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
                             value="#{generarPH1.enteLazy}" var="user" emptyMessage="No se encontró ningún Item">
                    <p:column headerText="C.I./R.U.C." style="text-align: center;" filterBy="#{user.ciRuc}" filterStyle="width: 80%;" width="120">
                        <h:outputText value="#{user.ciRuc}" style="text-align: center; font-size: 12px"/>
                    </p:column>
                    <p:column headerText="Nombres" style="text-align: center" filterBy="#{user.nombres}" filterStyle="width: 80%;" >
                        <h:outputText value="#{user.nombres}"/>
                    </p:column>
                    <p:column headerText="Apellidos" style="text-align: center" filterBy="#{user.apellidos}" filterStyle="width: 80%;" >
                        <h:outputText value="#{user.apellidos}"/>
                    </p:column>   
                    <p:column headerText="Selecc." style="text-align: center;" width="60">
                        <p:commandButton icon="ui-icon-plusthick" style="height: 20px;" styleClass="btnStyle" actionListener="#{generarPH1.agregarRepresentante(user)}" />                           
                    </p:column>
                </p:dataTable>
            </h:form>
        </p:dialog>
    </ui:define>

</ui:composition>
