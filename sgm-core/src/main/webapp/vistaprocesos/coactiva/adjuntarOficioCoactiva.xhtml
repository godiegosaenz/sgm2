<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE composition PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
                template="/template/template.xhtml"
                xmlns:p="http://primefaces.org/ui"
                xmlns:h="http://xmlns.jcp.org/jsf/html" xmlns="http://www.w3.org/1999/xhtml"
                xmlns:f="http://xmlns.jcp.org/jsf/core"
                xmlns:pe="http://primefaces.org/ui/extensions"
                xmlns:dialog="http://xmlns.jcp.org/jsf/composite/dialog">
    <ui:define name="metadata">
        <f:metadata>
            <f:event type="preRenderView" listener="#{oficioCoactiva.doPreRenderView()}"/>
        </f:metadata>
    </ui:define>
    <ui:define name="content">
        <center>
            <h1>Juicio Coactiva</h1>
        </center>
        <h:form id="mainForm">
            <h:panelGrid styleClass="noBorder" columns="4" style="width: 100%;font-size: 14px;">
                <h:outputText value="Tarea: #{oficioCoactiva.taskDataByTaskID.name}" style="font-weight: bolder;color: #005f9c"/>
                <p:outputLabel value="Nº Tramite: #{oficioCoactiva.ht.id}" style="font-weight: bolder;color: #005f9c"/>
                <p:outputLabel value="Responsable: #{oficioCoactiva.taskDataByTaskID.assignee}" style="font-weight: bolder;color: #005f9c"/>
            </h:panelGrid>
            <br></br>
            <p:tabView id="mainTab">
                <p:tab title="Información Juicio">
                    <p:fieldset legend="Información del Juicio">
                        <h:panelGrid styleClass="noBorder" columns="8">
                            <h:outputText value="No Juicio:" style="font-weight: bolder; color: #0033FF;"/>
                            <p:inputText value="#{oficioCoactiva.juicio.numeroJuicio}" readonly="true"/>
                            <h:outputText value="Año Juicio:" style="font-weight: bolder; color: #0033FF;"/>
                            <p:inputText value="#{oficioCoactiva.juicio.anioJuicio}" readonly="true"/>
                            <h:outputText value="Fecha Juicio:" style="font-weight: bolder; color: #0033FF;"/>
                            <p:inputText value="#{oficioCoactiva.juicio.fechaJuicio}" readonly="true">
                                <f:convertDateTime pattern="dd/MM/yyyy"/>
                            </p:inputText>
                            <h:outputText value="Valor Total de Juicio:" style="font-weight: bolder; color: #0033FF;"/>
                            <p:inputText value="#{oficioCoactiva.juicio.totalDeuda}" readonly="true"/>
                        </h:panelGrid>
                        <h:panelGrid styleClass="noBorder" columns="7">
                            <h:outputText value="Estado Juicio:" style="font-size: 14px;   color: #0033FF;"/>
                            <p:spacer width="5"/>
                            <h:outputText value="#{oficioCoactiva.juicio.estadoJuicio.descripcion}" style="font-size: 14px; font-weight: bolder; color: #0033FF;"/>
                            <p:spacer width="5"/>
                            <h:outputText value="Abogado:" style="font-size: 14px;  color: #0033FF;"/>
                            <p:spacer width="5"/>
                            <h:outputText value="#{oficioCoactiva.juicio.abogadoJuicio.detalle}" style="font-size: 14px;font-weight: bolder;color: #0033FF;"/>
                        </h:panelGrid>
                    </p:fieldset>
                    <p:dataTable id="dtCoactiva" value="#{oficioCoactiva.titulos}" var="jui" emptyMessage="Sin elementos..."
                                 scrollable="true" scrollHeight="200" style="text-align: center;" rowIndexVar="index" rowStyleClass="#{jui.estadoLiquidacion.id eq 1 ? 'orange' : null}">
                        <f:facet name="header">Titulos de Credito Agregados al Juicio</f:facet>
                        <p:column headerText="No" width="35">
                            <p:outputLabel value="#{index+1}"/>
                        </p:column>
                        <p:column headerText="Mat. Inmob." width="150">
                            <p:outputLabel value="#{jui.predio.numPredio}"/>
                        </p:column>
                        <p:column headerText="Cod. Predial">
                            <p:outputLabel value="#{jui.predio.codigoPredialCompleto}"/>
                        </p:column>
                        <p:column headerText="Año Deuda" width="100">
                            <p:outputLabel value="#{jui.anio}"/>
                        </p:column>
                        <p:column headerText="Total Deuda" width="150">
                            <p:outputLabel value="#{jui.totalPago}" style="font-weight: bold; font-size: 14px;"/>
                        </p:column>
                        <p:column headerText="Estado" width="100">
                            <p:outputLabel value="#{jui.estadoLiquidacion.descripcion}" style="font-weight: bold; font-size: 14px;"/>
                        </p:column>
                        <!--<p:column headerText="Info" width="50">
                            <p:commandLink>
                                <p:graphicImage value="/css/homeIconsImages/detalle.png" height="16"/>   
                            </p:commandLink>
                        </p:column>-->
                    </p:dataTable>
                </p:tab>
                <p:tab title="Observaciones">
                    <p:dataTable value="#{oficioCoactiva.ht.observacionesCollection}" var="obs" reflow="true"
                                 style="text-align: center" emptyMessage="Sin observaciones..."
                                 scrollable="true" scrollHeight="200">
                        <f:facet name="header">Observaciones Adjuntas al Juicio</f:facet>
                        <p:column headerText="Observacion">
                            <h:outputText value="#{obs.observacion}"/>
                        </p:column>
                        <p:column headerText="Tarea" width="250">
                            <h:outputText value="#{obs.tarea}"/>
                        </p:column>
                        <p:column headerText="Responsable" width="150">
                            <h:outputText value="#{obs.userCre}"/>
                        </p:column>
                        <p:column headerText="Fecha" width="150">
                            <h:outputText value="#{obs.fecCre}">
                                <f:convertDateTime pattern="dd-MM-yyyy HH:mm"/>
                            </h:outputText>
                        </p:column>
                    </p:dataTable>
                </p:tab>
                <p:tab title="Documentos">
                    <dialog:detalleArchivosAct archivos="#{oficioCoactiva.processInstanceAllAttachmentsFiles}" />
                </p:tab>
            </p:tabView>
            <div align="center">
                <p:commandButton value="Mantener Estado" icon="ui-icon-refresh" styleClass="btnStyle" actionListener="#{oficioCoactiva.showDlgObservacion(1)}" rendered="#{oficioCoactiva.tarea == 1 || oficioCoactiva.tarea == 2}"/>
                <p:spacer height="1" width="20"/>
                <p:commandButton value="Pasar Siguiente Estado" icon="ui-icon-plus" styleClass="btnStyle" actionListener="#{oficioCoactiva.showDlgObservacion(2)}"/>
                <p:spacer height="1" width="20"/>
                <p:commandButton value="Baja y Archivo" icon="ui-icon-cancel" styleClass="btnStyle" actionListener="#{oficioCoactiva.showDlgObservacion(3)}" rendered="#{oficioCoactiva.tarea == 1}"/>
            </div>
        </h:form>
        
        <p:dialog header="Adjuntar Documento" widgetVar="dlgDocumento" width="500" height="400" modal="true" resizable="false" position="center">
            <h:form id="formDoc">
                <h:panelGrid columns="1" styleClass="noBorder" style="width: 100%;">
                    OBSERVACIÓN:
                    <p:inputTextarea value="#{oficioCoactiva.observacion}" style="width: 100%" rows="4" autoResize="false"/>
                    DOCUMENTOS:
                </h:panelGrid>
                <h:panelGrid columns="1" styleClass="noBorder" style="width: 100%;text-align: center">
                    <p:fileUpload fileUploadListener="#{oficioCoactiva.handleFileUpload}" update="dtDocumentos"
                                  label="Seleccionar" uploadLabel="Subir" cancelLabel="Cancelar" multiple="false"
                                  mode="advanced" dragDropSupport="false"  sizeLimit="1000000000"
                                  allowTypes="#{oficioCoactiva.formatoArchivos}" /> 
                    <p:dataList id="dtDocumentos" value="#{oficioCoactiva.files}" var="docs"
                                emptyMessage="Sin documentos..." style="text-align: center">
                        <f:facet name="header">Nombre</f:facet>
                        <p:outputLabel value="#{docs.nombre}"/>
                    </p:dataList>
                    <br/>
                    <p:commandButton value="Aceptar" icon="ui-icon-check" styleClass="btnStyle" actionListener="#{oficioCoactiva.completarTarea()}"/>
                </h:panelGrid>
            </h:form>
        </p:dialog>
        
    </ui:define>
</ui:composition>
