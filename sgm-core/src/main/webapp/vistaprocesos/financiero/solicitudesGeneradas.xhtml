<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE composition PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
                template="/template/template.xhtml"
                xmlns:h="http://xmlns.jcp.org/jsf/html" xmlns="http://www.w3.org/1999/xhtml"
                xmlns:p="http://primefaces.org/ui"
                xmlns:f="http://xmlns.jcp.org/jsf/core"
                xmlns:poue="http://primefaces.org/ui/extensions">

    <ui:define name="events">

    </ui:define>

    <ui:define name="head">

    </ui:define>
    <ui:define name="content">
        <div align="center">
            <h1>Solicitudes Generadas</h1>            

        </div>
        <h:form id="frmLiquidaciones">
            <p:dataTable id="dtLiq" value="#{solicitudesGeneradas.lazy}" reflow="true"
                         filterEvent="enter" rows="20" rowsPerPageTemplate="20,50,100"
                         emptyMessage="No se encontraron registros" lazy="true" paginator="true"
                         var="lc1" nullSortOrder="-1">
                <p:column headerText="Id Exo" filterStyle="width: 95%" filterBy="#{lc1.id}" width="8%">
                    <p:outputLabel value="#{lc1.id}"/>
                </p:column>
                <p:column headerText="Clase Exoneración"> 
                    <p:outputLabel value="#{lc1.exoneracionTipo.exoneracionClase.descripcion}" style="width: 100%; " />
                </p:column>
                <p:column headerText="Tipo Exoneración" filterStyle="width: 95%" filterBy="#{lc1.exoneracionTipo.descripcion}">
                    <p:outputLabel value="#{lc1.exoneracionTipo.descripcion}"/>
                </p:column>
                <p:column headerText="Num. Predio" filterStyle="width: 95%" width="8%" >
                    <p:outputLabel value="#{lc1.predio.numPredio}" rendered="#{lc1.predio != null}"/>
                    <p:outputLabel value="#{lc1.predioRustico.regCatastral} - #{lc1.predioRustico.idPredial} - #{lc1.predioRustico.parroquia.id}" rendered="#{lc1.predioRustico != null}"/>
                </p:column>
                <p:column headerText="Num. Trámite" filterStyle="width: 95%" filterBy="#{lc1.tramite.id}" width="8%">
                    <p:outputLabel value="#{lc1.tramite.id}"/>
                </p:column>
                <p:column headerText="Años" filterStyle="width: 95%" filterBy="#{lc1.anioInicio}" width="8%"  >
                    <p:outputLabel value="#{lc1.anioInicio} - #{lc1.anioFin}"/>
                </p:column>
                <p:column headerText="Identificación" filterStyle="width: 95%" filterBy="#{lc1.solicitante.ciRuc}" width="10%">
                    <p:outputLabel value="#{lc1.solicitante.ciRuc}"/>
                </p:column>
                <p:column headerText="Solicitante" filterStyle="width: 95%" filterBy="#{lc1.solicitante.nombreCompleto}">
                    <p:outputLabel value="#{lc1.solicitante.nombreCompleto}"/>
                </p:column>
                <p:column headerText="Opciones" width="8%" style="text-align: center; ">
                    <p:commandButton  icon="ui-icon-info" iconPos="center" styleClass="btnStyle"
                                      actionListener="#{solicitudesGeneradas.detalle(lc1)}"/>
                    <!--                    <p:spacer width="5"/>
                                        <p:commandButton  icon="ui-icon-print" iconPos="center" styleClass="btnStyle"
                                                         actionListener="#{solicitudesGeneradas.imprimir(lc1)}"/>-->
                </p:column>
            </p:dataTable>
        </h:form>

        <p:dialog widgetVar="detalle" width="70%" height="500" modal="true" closeOnEscape="true" 
                  closable="true" appendTo="@(body)" position="center" resizable="false" 
                  header="Detalle Liquidación" >
            <h:form id="detalle">
                <p:tabView id="tabDetalle">
                    <p:tab title="Información">

                        <br/>
                        <p:panelGrid columns="1" layout="grid" >
                            <p:panelGrid columns="4" layout="grid" columnClasses="ui-grid-col-1, ui-grid-col-4, ui-grid-col-1, ui-grid-col-4" >
                                <p:outputLabel value="Clase Exoneración"/> 
                                <p:inputText value="#{solicitudesGeneradas.solicitudExoneracion.exoneracionTipo.exoneracionClase.descripcion}" 
                                             readonly="true" style="width: 100%; " title="#{solicitudesGeneradas.solicitudExoneracion.exoneracionTipo.exoneracionClase.descripcion}" />
                                <p:outputLabel value="Tipo Exoneración"/> 
                                <p:inputText value="#{solicitudesGeneradas.solicitudExoneracion.exoneracionTipo.descripcion}" 
                                             readonly="true" style="width: 100%; " title="#{solicitudesGeneradas.solicitudExoneracion.exoneracionTipo.descripcion}"/>
                                <p:outputLabel value="Núm Trámite"/> 
                                <p:inputText value="#{solicitudesGeneradas.solicitudExoneracion.tramite.id}" readonly="true" />
                                <p:outputLabel value="Fecha Ingreso"/> 
                                <p:inputText value="#{solicitudesGeneradas.solicitudExoneracion.fechaIngreso}" readonly="true" >
                                    <f:convertDateTime pattern="dd/MM/yyyy"/>
                                </p:inputText>
                                <p:outputLabel value="Estado"/> 
                                <p:inputText value="#{solicitudesGeneradas.solicitudExoneracion.estado.descripcion}" readonly="true" />
                                <p:outputLabel value="#{solicitudesGeneradas.solicitudExoneracion.tipoValor.descripcion}"/> 
                                <p:inputText value="#{solicitudesGeneradas.solicitudExoneracion.valor}" readonly="true" />
                                <!--                                <p:outputLabel value=""/> 
                                                                <p:outputLabel value=""/> -->
                            </p:panelGrid>
                            <p:panelGrid columns="2" columnClasses="ui-grid-col-1, ui-grid-col-4" >
                                <f:facet name="header">
                                    Solicitante
                                </f:facet>
                                <p:outputLabel value="Cédula/RUC"/> 
                                <p:inputText value="#{solicitudesGeneradas.solicitudExoneracion.solicitante.ciRuc}" readonly="true" />
                                <p:outputLabel value="Nombres "/> 
                                <p:inputText value="#{solicitudesGeneradas.solicitudExoneracion.solicitante.nombreCompleto}" style="width: 100%" readonly="true" />
                                <p:outputLabel value="Dirección "/> 
                                <p:inputText value="#{solicitudesGeneradas.solicitudExoneracion.solicitante.direccion}" style="width: 100%" readonly="true" />
                            </p:panelGrid>
                        </p:panelGrid>
                        <br/>


                    </p:tab>
                    <p:tab title="Solicitudes Generadas">
<!--                        <p:dataTable value="# {solicitudesGeneradas.solicitudExoneracion.fnSolicitudExoneracionAutomaticaCollection}" 
                                     var="sol1" style="width: 100%; "
                                     paginator="true" paginatorAlwaysVisible="false" emptyMessage="No se encontraron Registros..."
                                     rows="20" rowsPerPageTemplate="20,50" reflow="true"  >
                            <f:facet name="header">
                                Solicicitudes
                            </f:facet>
                            <p:column headerText="Años" width="15%" >
                                <p:outputLabel value="#{sol1.anio}"/>
                            </p:column>
                            <p:column headerText="Fecha Ingreso">
                                <p:outputLabel value="#{sol1.fechaIngreso}">
                                    <f:convertDateTime pattern="dd/MM/yyyy"/>
                                </p:outputLabel>
                            </p:column>
                            <p:column headerText="Calle"  >
                                <p:outputLabel value="#{sol1.predio.calle}"/>
                            </p:column>
                            <p:column headerText="Manzana"  width="10%">
                                <p:outputLabel value="#{sol1.predio.urbSolarnew}"/>
                            </p:column>
                            <p:column headerText="Solar"  width="10%">
                                <p:outputLabel value="#{sol1.predio.urbMz}"/>
                            </p:column>-->
<!--                        </p:dataTable>-->
                    </p:tab>
                    <p:tab title="Predios">
                        <p:dataTable value="#{solicitudesGeneradas.solicitudExoneracion.tramite.historicoTramiteDetCollection}" 
                                     var="d1" style="width: 100%; "
                                     paginator="true" paginatorAlwaysVisible="false" emptyMessage="No se encontraron Registros..."
                                     rows="20" rowsPerPageTemplate="20,50" reflow="true"  >
                            <f:facet name="header">
                                Predio Asociados
                            </f:facet>
                            <p:column headerText="Num. Predio" width="15%" >
                                <p:outputLabel value="#{d1.predio.numPredio}"/>
                            </p:column>
                            <p:column headerText="Urbanización">
                                <p:outputLabel value="#{d1.predio.ciudadela.nombre}"/>
                            </p:column>
                            <p:column headerText="Calle"  >
                                <p:outputLabel value="#{d1.predio.calle}"/>
                            </p:column>
                            <p:column headerText="Manzana"  width="10%">
                                <p:outputLabel value="#{d1.predio.urbSolarnew}"/>
                            </p:column>
                            <p:column headerText="Solar"  width="10%">
                                <p:outputLabel value="#{d1.predio.urbMz}"/>
                            </p:column>
                        </p:dataTable>
                    </p:tab>
                    <p:tab title="Liquidaciones">
                        <p:dataTable value="#{solicitudesGeneradas.solicitudExoneracion.renSolicitudesLiquidacionCollection}" 
                                     var="liqAfect1" style="width: 100%; " rowIndexVar="rowIndex" 
                                     paginator="true" paginatorAlwaysVisible="false" emptyMessage="No se encontraron Registros..."
                                     rows="20" rowsPerPageTemplate="20,50" reflow="true" id="dtLiqAfect5"  >
                            <f:facet name="header">
                                Liquidaciones Afectadas por la exoneracion
                            </f:facet>
                            <p:column headerText="Años" width="15%"  >
                                <p:outputLabel value="#{liqAfect1.liquidacion.anio}"/>
                            </p:column>
                            <p:column headerText="Fecha Ingreso">
                                <p:outputLabel value="#{liqAfect1.liquidacion.fechaIngreso}" >
                                    <f:convertDateTime pattern="dd/MM/yyyy"/>
                                </p:outputLabel>
                            </p:column>
                            <p:column headerText="Num. Liquidacion"  >
                                <p:outputLabel value="#{liqAfect1.liquidacion.numLiquidacion}" title="#{liqAfect1.liquidacion.idLiquidacion}"/>
                            </p:column>
                            <p:column headerText="Total"  width="10%">
                                <p:outputLabel value="#{liqAfect1.liquidacion.totalPago}"/>
                            </p:column>
                            <p:column headerText="Estado"  width="10%">
                                <p:outputLabel value="Activo" rendered="#{liqAfect1.liquidacion.estadoLiquidacion.id eq 2}"/>
                                <p:outputLabel value="Anterior" rendered="#{liqAfect1.liquidacion.estadoLiquidacion.id eq 4}"/>
                            </p:column>
                            <p:column id="colDet" headerText="Detalle"  width="10%">
                                <p:outputLabel id="det" value="Rubros"/>
                                <p:overlayPanel id="myPanel" for="det" showEvent="mouseover" hideEvent="mouseout"
                                                appendToBody="@(body)" style="width: 30%">
                                    <p:outputLabel value="Id Liquidacion #{liqAfect1.liquidacion.idLiquidacion}" style="font-weight: bold;"/>
                                    <p:dataTable id="dtRubros3" rows="5" paginatorPosition="top" value="#{liqAfect1.liquidacion.renDetLiquidacionCollection}" 
                                                 style="text-align: center;"
                                                 paginator="true" var="rubro1" emptyMessage="No hay datos que mostrar">
                                        <p:column headerText="Descripcion" style="text-align: left;">
                                            <p:outputLabel value="#{solicitudesGeneradas.getRubro(rubro1.rubro).descripcion}"/>
                                        </p:column>
                                        <p:column headerText="Valor" width="30%">
                                            <p:outputLabel value="#{rubro1.valor}"/>
                                        </p:column>
                                    </p:dataTable> 
                                </p:overlayPanel> 
                            </p:column>
                        </p:dataTable>
                    </p:tab>
                    <p:tab title="Tareas">
<!--                        <p:dataTable value="#{solicitudesGeneradas.taskInstance}" var="task" scrollable="true" paginator="true" paginatorPosition="top" scrollRows="8" scrollHeight="230" rows="10">
                            <p:column headerText="Tarea" width="50%">
                                <p:outputLabel value="#{task.name}"/>
                            </p:column>
                            <p:column headerText="Asignado a" >
                                <p:outputLabel value="#{task.assignee}" rendered="#{task.assignee ne null}"/>
                            </p:column>
                            <p:column headerText="Inicio" width="15%">
                                <p:outputLabel value="#{task.startTime}" >
                                    <f:convertDateTime pattern="dd/MM/YYYY"/>
                                </p:outputLabel>
                            </p:column>
                            <p:column headerText="Fin" width="15%">
                                <p:outputLabel value="#{task.endTime}">
                                    <f:convertDateTime pattern="dd/MM/YYYY"/>
                                </p:outputLabel>
                            </p:column>-->
                        <!--</p:dataTable>-->
                    </p:tab>
                    <p:tab id="observacion" title="Observación">
                        <p:panel>
                            <p:dataTable id="obs1" value="#{solicitudesGeneradas.solicitudExoneracion.tramite.observacionesCollection}" 
                                         reflow="true" var="obs1" rows="5" paginator="true" 
                                         paginatorPosition="top" emptyMessage="No hay datos para mostrar">
                                <p:column headerText="Observación">
                                    <center><h:outputText value="#{obs1.observacion}"/></center>
                                </p:column>
                                <p:column headerText="Fecha de Creación">
                                    <center><h:outputText value="#{obs1.fecCre}"/></center>
                                </p:column>

                                <p:column headerText="Responsable">
                                    <center><h:outputText value="#{obs1.userCre}"/></center>
                                </p:column>
                                <p:column headerText="Taréa">
                                    <center><h:outputText value="#{obs1.tarea}"/></center>
                                </p:column>
                            </p:dataTable>
                        </p:panel>
                    </p:tab>
                </p:tabView>
                <center>
                    <p:commandButton value="Salir" onclick="PF('detalle').hide()" styleClass="btnStyle"/>
                </center>
            </h:form>
        </p:dialog>    
    </ui:define>

</ui:composition>
