<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE composition PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
                template="/template/template.xhtml"
                xmlns:p="http://primefaces.org/ui"
                xmlns:h="http://xmlns.jcp.org/jsf/html" xmlns="http://www.w3.org/1999/xhtml"
                xmlns:f="http://xmlns.jcp.org/jsf/core"
                xmlns:dialog="http://xmlns.jcp.org/jsf/composite/dialog"
                xmlns:pe="http://primefaces.org/ui/extensions">
    
    <ui:define name="head">
        <script src="../../resources/pfJs/keyPress.js" type="text/javascript"></script>
        <style type="text/css">
            .ui-selectoneradio label{
                font-size: 1.2em;
                font-weight: bold;
            }
            .ui-datatable .ui-datatable-scrollable-body .ui-datatable thead th, .ui-datatable tbody td, .ui-datatable tfoot td, .ui-datatable tfoot th{
                height : 20px;
                padding: 3px 5px;
            } 
        </style>
    </ui:define>
    <ui:define name="content">
        <h:form id="frmMain">
            <div align="center">
                <!--PRIEMER GRID-->
                <h1><h:outputText value="Carga de Ficheros Bancarios"/></h1>
                <p:panelGrid layout="grid" columns="2" style="width: 80%">
                    <p:outputLabel  value="* Eliga la Entidad Bancaria:" style="font-weight: bolder" />
                    <p:selectOneMenu id="console"  style="width:100px" converter="entityConverter" value="#{procesamientoBancos.formato}">
                        <f:selectItem itemLabel="Seleccionar" itemValue="#{null}"/>
                        <f:selectItems value="#{procesamientoBancos.bancos}" var="b" itemLabel="#{b.banco}" itemValue="#{b}"/>
                    </p:selectOneMenu>  

                    <p:outputLabel  value="* Seleccione el Archivo:" style="font-weight: bolder"/>
                    <p:commandButton value="Cargar Archivo" type="button" onclick="PF('ModalArchivo').show();" update="documento" />
                </p:panelGrid>
                <br/>
                <!--BOTON REPORTE -->
                <div align="right">
                    <p:commandButton value="Reporte" icon="ui-icon-print" type="button" onclick="PF('ModalReporte').show();" update="reporte" />
                </div>
            </div>     
            <br/>
            
            <p:dataTable id="dtEmisionArchivo" emptyMessage="No tiene datos" value="#{procesamientoBancos.consolidados}" var="archivo"  lazy="true" paginator="true" rows="50" rowsPerPageTemplate="50,100,200" style="width: 100%">
                <p:column headerText="No. Predio">
                    <h:outputText value="#{archivo.numPredio}" style="text-align: center"/>
                </p:column>

                <p:column headerText="Año">
                    <h:outputText value="#{archivo.anio}" style="text-align: center"/>
                </p:column>

                <p:column headerText="Fecha">
                    <h:outputText value="#{archivo.fecha}" style="text-align: center"/>
                </p:column>

                <p:column headerText="Valor">
                    <h:outputText value="#{archivo.valor}" style="text-align: center"/>
                </p:column>

                <p:column headerText="Banco">
                    <h:outputText value="#{archivo.banco}" style="text-align: center"/>
                </p:column>

                <p:column headerText="Estado">
                    <h:outputText value="#{archivo.estado}" style="text-align: center"/>
                </p:column>

                <p:column headerText="Fecha de Cobro">
                    <h:outputText value="#{archivo.fechaCobro}" style="text-align: center"/>
                </p:column>

                <p:column headerText="No.Comprobante">
                    <h:outputText value="#{archivo.numComprobante}" style="text-align: center"/>
                </p:column>
            </p:dataTable>
        </h:form>
        
        <!--MODAL PARA LA CARGA DEL ARCHIVO DE TEXTO-->              
        <p:dialog id="dlgCargadeArchivo" widgetVar="ModalArchivo" header="Seleccione el Archivo" modal="true" appendTo="@(body)" width="50%" height="120" resizable="false" closable="true" closeOnEscape="true">
            <h:form id="frmCargarArchivo">
                <p:panelGrid columns="1" layout="grid">
                    <p:column headerText="Presentar Documento">
                        <center>
                            <p:fileUpload  fileUploadListener="#{procesamientoBancos.handleFileUpload}"
                                           multiple="false"
                                           mode="advanced"
                                           fileLimit="1"
                                           label="Seleccionar"
                                           uploadLabel="Subir" cancelLabel="Cancelar"
                                           skinSimple="true"
                                           update="messages"
                                           sizeLimit="35000000" 
                                           allowTypes="/(\.|\/)(txt)$/"/>
                            <p:growl id="messages" showDetail="true"/>
                        </center>
                    </p:column>
                </p:panelGrid>
            </h:form>
        </p:dialog>

        <!--MODAL PARA GENERAR EL REPORTE-->              
        <p:dialog id="dlgReporteArchivo" widgetVar="ModalReporte" header="REPORTE BANCO BOLIVARIANO" modal="true" appendTo="@(body)" width="50%" height="360" resizable="false" closable="true" closeOnEscape="true">
            <h:form id="frmReporteBancos">
                <p:panelGrid columns="1" layout="grid">
                    <p:column headerText="Presentar Reporte">
                        <center>
                             <H2> Seleccione las Fechas</H2>
                            <p:panelGrid columns="2">
                                                              
                                <h:outputText value="Fecha Desde:"/>
                                <p:calendar value="#{procesamientoBancos.fechaDesde}" pattern="dd/MM/yyy" showOn="button"/>

                                <h:outputText value="Fecha Hasta:"/>
                                <p:calendar value="#{procesamientoBancos.fechaHasta}" pattern="dd/MM/yyy" showOn="button"/>
                                                            
                            </p:panelGrid>

                             <p:panelGrid columns="3">
                                 <div align="center">
                                     <p:commandButton id="btnConsultar" value="CONSULTAR"  style="font-size: 15px; font-weight: bolder;" styleClass="btnStyle"
                                        icon="ui-icon-search" iconPos="right" actionListener="#{procesamientoBancos.listaInformacion()}"
                                        update="dtEmisionReporteBanco"/>
                                 </div>
                            </p:panelGrid>
                            <br></br>
                            <p:dataTable id="dtEmisionReporteBanco" emptyMessage="No tiene datos" value="#{procesamientoBancos.consolidados}"
                                         var="banco"  lazy="true" paginator="true" rows="50" rowsPerPageTemplate="50,100">
                                
                                  <p:column headerText="Cod.Predio" width="70" style="text-align: center;">
                                    <h:outputText value="#{banco.numPredio}"/>
                                </p:column>         
                                
                                <p:column headerText="Fecha de Cobro" width="80" style="text-align: center;">
                                    <h:outputText value="#{banco.fechaCobro}"/>
                                </p:column>
                                
                                <p:column headerText="Año" width="50" style="text-align: center;">
                                    <h:outputText value="#{banco.anio}"/>
                                </p:column>
                                
<!--                                <p:column headerText="Cod.Nuevo" width="100" style="text-align: center;">
                                    <h:outputText value=""/>
                                </p:column>-->

                                <p:column headerText="Valor" width="100" style="text-align: center;">
                                    <h:outputText value="#{banco.valor}"/>
                                </p:column>     
                                
                                <p:column headerText="Estado" width="50" style="text-align: center;">
                                    <h:outputText value="#{banco.estado}"/>
                                </p:column> 
                            
                                </p:dataTable>
                            <br></br>
                            <p:panelGrid styleClass="noBorder" style="font-size: 12px;font-weight: bolder;" columns="7">
                                <div align="center">
                                     <p:commandButton id="btnImprimir" value="IMPRIMIR"  style="font-size: 15px; font-weight: bolder;" styleClass="btnStyle"
                                        icon="ui-icon-print" iconPos="right" actionListener="#{procesamientoBancos.imprimirReporte()}" update="dtEmisionReporteBanco"/>
                                </div>
                            </p:panelGrid>
                            <br></br>                                      
                            <p:growl id="messages" showDetail="true"/>
                        </center>
                    </p:column>
                </p:panelGrid>
            </h:form>
        </p:dialog>        
        
    </ui:define>
</ui:composition>


