<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE composition PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
                template="./../../template/template.xhtml"
                xmlns:h="http://xmlns.jcp.org/jsf/html" xmlns="http://www.w3.org/1999/xhtml"
                xmlns:dialog="http://xmlns.jcp.org/jsf/composite/dialog"
                xmlns:p="http://primefaces.org/ui"
                xmlns:f="http://xmlns.jcp.org/jsf/core"
                xmlns:poue="http://primefaces.org/ui/extensions">

    <ui:define name="head">
        <style type="text/css">
            .ui-datepicker .ui-datepicker-title select {
                font-size: 1em;
                margin: 1px 0;
                color: black;
            }
            .ui-state-active, .ui-widget-content .ui-state-active, .ui-widget-header .ui-state-active{
                font-weight: bold;
                color: #444;
                background: #FF7E00;
            }
            .ui-datatable .ui-datatable-header, .ui-datatable .ui-datatable-footer {
                text-align: center;
                padding: 0px 0px;
            }
        </style>
    </ui:define>

    <ui:define name="page_title">

    </ui:define>

    <ui:define name="top">
        <h1>Ingreso de Solicitud de Exoneracion</h1>
    </ui:define>

    <ui:define name="content">
        <center>
            <h1>Solicitud de Exoneraciones</h1>
        </center>
        <h:form id="frmSolExo">
            <center>
                <h:panelGroup rendered="#{solicitudExoneracion.usuarioAutorizado}">


<!--                    <p:selectOneRadio value="#{solicitudExoneracion.tipoPredio}" columns="2" layout="grid" style="width: 150px;">
                        <f:selectItem itemLabel="Urbano" itemValue="#{1}"  />
                        <f:selectItem itemLabel="Rustico" itemValue="#{2}" />
                        <p:ajax update="frmSolExo" listener="#{solicitudExoneracion.actualizarTipoPredio()}"/>
                    </p:selectOneRadio>-->
                    <br/>
                    <h:panelGrid columns="2">
                        <p:selectOneMenu value="#{solicitudExoneracion.entradas['tipo']}" >
                            <f:selectItem itemLabel="Propietario" itemValue="#{1}" />
                            <f:selectItem itemLabel="Grupo" itemValue="#{2}" />
                            <p:ajax update="frmSolExo" listener="#{solicitudExoneracion.actualizarFrm()}"/>
                        </p:selectOneMenu>
                        <h:panelGroup rendered="#{solicitudExoneracion.entradas['tipo'] == 1}">
                            <p:inputText value="#{solicitudExoneracion.entradas['ente'].ciRuc}" placeholder="C&#233;dula o Ruc" rendered="#{solicitudExoneracion.entradas['tipo'] == 1}"/>
                            <p:commandButton value="Buscar" actionListener="#{solicitudExoneracion.consultarSolicitante()}" update="frmSolExo"  styleClass="btnStyle" style="height: 25px;" />
                        </h:panelGroup>
                        <h:panelGroup rendered="#{solicitudExoneracion.entradas['tipo'] == 2}">
                            <p:commandButton value="Predios" actionListener="#{solicitudExoneracion.mostrarPredios()}" 
                                             styleClass="btnStyle" style="height: 25px;" >
                                <p:ajax update="frmSolExo" event="dialogReturn" listener="#{solicitudExoneracion.seleccionarObject}" />
                            </p:commandButton>
                        </h:panelGroup>
                    </h:panelGrid>
                    <br/>
                    <dialog:datosEnteRedesing ente="#{solicitudExoneracion.comprador}"
                                              esPersona="#{solicitudExoneracion.esPersonaComp}"
                                              buscar="false"
                                              header="Datos Solicitante" 
                                              width="400"
                                              id="dte"
                                              rendered="#{solicitudExoneracion.entradas['tipo'] == 1}"/>
                </h:panelGroup>
                <h:panelGroup rendered="#{!solicitudExoneracion.usuarioAutorizado}">
                    <center>
                        <h3>
                            Usuario no autorizado
                        </h3>
                    </center>
                </h:panelGroup>
            </center>

            <br/>
            <h:panelGroup id="panel" rendered="#{solicitudExoneracion.mostrar}" >
                <br></br>
                <div align="right">
                    <p:commandButton value="Agregar Predios" actionListener="#{solicitudExoneracion.mostrarPredios()}"  styleClass="btnStyle" style="height: 25px;" >
                        <p:ajax event="dialogReturn" process="@this" listener="#{solicitudExoneracion.seleccionarObjectAdd}" update="frmSolExo:dtPredios"/>
                    </p:commandButton>
                </div>
                <br></br>
                <p:dataTable value="#{solicitudExoneracion.entradas['prediosEncontrados']}" rows="5" rowKey="#{prop5.id}"
                             selection="#{solicitudExoneracion.predios}" var="prop5" styleClass="ui-panelgrid-blank"
                             rowIndexVar="index" paginator="true" paginatorPosition="top" reflow="true"
                             emptyMessage="No se encontr&#243; ning&#250;n item." id="dtPredios"
                             rendered="#{solicitudExoneracion.tipoPredio eq 1}">
                    <f:facet name="header">
                        <p:outputLabel value="Listado de Predios Urbanos." style="font-size: 16px; font-weight: bold; color: #006699; padding: 0px;"/>

                    </f:facet>
                    <p:column selectionMode="multiple" style="width:25px; text-align:left; "/>
                    <p:column style="width: 15%; text-align:left; " headerText="N&#250;mero de Predio" >
                        <h:outputText value="#{prop5.numPredio}" />
                    </p:column>
                    <p:column style="width: 20%; text-align:left; " headerText="C&#243;digo Predial">
                        <h:outputText value="#{prop5.codigoPredial}" />
                    </p:column>
                    <p:column style="width: 25%; text-align:left; " headerText="Urbanizaci&#243;n">
                        <h:outputText value="#{prop5.ciudadela.nombre}" />
                    </p:column>
                    <p:column style="width: 15%; text-align:left; " headerText="Manzana">
                        <h:outputText value="#{prop5.mz}" />
                    </p:column>
                    <p:column style="width: 15%; text-align:left; " headerText="Solar" >
                        <h:outputText value="#{prop5.solar}" />
                    </p:column>
                    <p:column style="width: 10%; text-align:left; " headerText="Opciones" >
                        <p:commandLink actionListener="#{solicitudExoneracion.eliminarPredio(prop5)}" update="frmSolExo:dtPredios" >
                            <p:graphicImage value="/css/homeIconsImages/delete.png"/>
                        </p:commandLink>
                    </p:column>
                </p:dataTable>

                <p:dataTable value="#{solicitudExoneracion.entradas['prediosEncontrados']}" rows="5" rowKey="#{rust1.id}"
                             selection="#{solicitudExoneracion.prediosRusticos}" var="rust1" styleClass="ui-panelgrid-blank"
                             rowIndexVar="index" paginator="true" paginatorPosition="top" reflow="true"
                             emptyMessage="No se encontr&#243; ning&#250;n item." id="dtPrediosRusticos"
                             rendered="#{solicitudExoneracion.tipoPredio eq 2}">
                    <f:facet name="header">
                        <p:outputLabel value="Listado de Predios Rurales." style="font-size: 16px; font-weight: bold; color: #006699; padding: 0px;"/>
                        <p:commandButton value="Agregar Predios" actionListener="#{solicitudExoneracion.mostrarPredios()}" styleClass="btnStyle" style="height: 25px;" >
                            <p:ajax event="dialogReturn" listener="#{solicitudExoneracion.seleccionarObjectAddRustico}" update="frmSolExo:dtPrediosRusticos"/>
                        </p:commandButton>
                    </f:facet>
                    <p:column selectionMode="multiple" style="width:25px; text-align:left; "/>
                    <p:column headerText="Reg. Catastral" filterStyle="width: 90%" style="text-align: center; " >
                        <h:outputText value="#{rust1.regCatastral}"/>
                    </p:column>
                    <p:column headerText="Id. Predial" style="text-align: center;">
                        <h:outputText value="#{rust1.idPredial}"  />
                    </p:column>
                    <p:column headerText="Parroquia" style="text-align: center; " >
                        <h:outputText value="#{rust1.parroquia}"/>
                    </p:column> 
                    <p:column headerText="Ubicaci&#243;n" style="text-align: center; "  >
                        <h:outputText value="#{rust1.nombrePredio}"/>
                    </p:column>
                    <p:column headerText="Sitio" style="text-align: center; " >
                        <h:outputText value="#{rust1.sitio}"/>
                    </p:column>
                    <p:column style="width: 8%" headerText="Poligono">
                        <h:outputText value="#{rust1.poligono}" />
                    </p:column>
                    <p:column style="width: 8%" headerText="Superficie">
                        <h:outputText value="#{rust1.superficie}" />
                    </p:column>
                    <p:column style="width: 8%" headerText="Avaluo">
                        <h:outputText value="#{rust1.avaluoCatastral}" />
                    </p:column>
                    <p:column style="width: 10%" headerText="Opciones">
                        <p:commandLink actionListener="#{solicitudExoneracion.eliminarPredioRustico(rust1)}" update="frmSolExo:dtPrediosRusticos" >
                            <p:graphicImage value="/css/homeIconsImages/delete.png"/>
                        </p:commandLink>
                    </p:column>
                </p:dataTable>
                <br/>
                <h:panelGroup  layout="block" class="Container Wid100 MarTop10">
                    <h:panelGrid columns="2">
                        <h:panelGroup >
                            <h:panelGroup layout="block" class="Container50">
                                <p:fieldset legend="A&#241;o de vigencia" style="width: 250px; " >
                                    <h:panelGrid columns="1" >
                                        <h:panelGroup layout="block"  >
                                            <p:outputLabel value="Inicio"/>
                                            <p:spinner value="#{solicitudExoneracion.entradas['solicitud'].anioInicio}" min="1500" maxlength="4" title="A&#241;o de inicio" tabindex="0"/>                                    
                                        </h:panelGroup>    
                                        <h:panelGroup layout="block"  >
                                            <p:outputLabel value="Fin "/>
                                            <p:spacer width="10" />
                                            <p:spinner value="#{solicitudExoneracion.entradas['solicitud'].anioFin}" min="1900" maxlength="4" title="A&#241;o de fin" tabindex="0"/>
                                        </h:panelGroup>    
                                    </h:panelGrid>
                                </p:fieldset>
                            </h:panelGroup>
                            <!--                        <br/>
                                                    <p:panelGrid columns="2" columnClasses="ui-grid-col-6, ui-grid-col-2"  styleClass="ui-panelgrid-blank">
                                                        <p:outputLabel value="Semestre Aplicaci&#243;n"/>
                                                        <p:spinner value="#{solicitudExoneracion.entradas['solicitud'].semestreInicio}" max="2" min="0" maxlength="1" title="0 para lo
                            s dos semestres, 1 primer semestre y 2 segundo semestres" immediate="true" />
                                                    </p:panelGrid>-->

                            <h:panelGroup layout="block" class="Container50">
                                <p:fieldset legend="Tipo de Exoneraci&#243;n">
                                    <h:panelGrid columns="1" >
                                        <h:panelGroup layout="block"  >
                                            <p:outputLabel value="Clase de Exoneraci&#243;n" for="s3"/><br></br>
                                            <p:selectOneMenu id="s3" value="#{solicitudExoneracion.exoneracion}" converter="entityConverter" title="Seleccione La clase de exoneraci&#243;n" >
                                                <f:selectItem itemValue="#{null}" itemLabel="Seleccione..."/>
                                                <f:selectItems value="#{solicitudExoneracion.exoneraciones}" var="cl2" itemValue="#{cl2}" itemLabel="#{cl2.id} - #{cl2.descripcion}"/>
                                                <p:ajax update="frmSolExo:s2" listener="#{solicitudExoneracion.actualizarTipo()}"/>
                                            </p:selectOneMenu>
                                        </h:panelGroup>
                                        <h:panelGroup layout="block"  >
                                            <p:outputLabel value="Tipo de Exoneraci&#243;n" for="s2"/><br></br>
                                            <p:selectOneMenu id="s2" value="#{solicitudExoneracion.exoneracionTipo}" converter="entityConverter" title="Seleccione el tipo de exoneraci&#243;n" >
                                                <f:selectItem itemValue="#{null}" itemLabel="Seleccione..."/>
                                                <f:selectItems value="#{solicitudExoneracion.tiposExonracion}" var="t2" itemValue="#{t2}" itemLabel="#{t2.id}-#{t2.descripcion}"/>
                                            </p:selectOneMenu>
                                        </h:panelGroup>
                                    </h:panelGrid>
                                </p:fieldset>
                            </h:panelGroup>
                        </h:panelGroup>
                        <p:panelGrid columns="2" styleClass="ui-panelgrid-blank">

                        </p:panelGrid>
                    </h:panelGrid>
                </h:panelGroup>

                <br/>
                <center>
                    <p:commandButton actionListener="#{solicitudExoneracion.mostrarObs()}" update="menSol:dlgDilLiq" value="Registrar" styleClass="btnStyle"/>
                </center>
            </h:panelGroup>
        </h:form>

        <dialog:observaciones id="ComObs" 
                              observaciones="#{solicitudExoneracion.entradas['obs']}"
                              actionButton="#{solicitudExoneracion.registrarSolicitud()}"  />

        <dialog:dialogNumLiquidacion id="menSol" actionButton="#{solicitudExoneracion.ocultar()}"
                                     headerDialog="#{solicitudExoneracion.entradas['header']}"
                                     idLiq="#{solicitudExoneracion.entradas['numSol']}"
                                     desc="#{solicitudExoneracion.entradas['desc']}"
                                     update="frmSolExo" />
    </ui:define>

</ui:composition>
