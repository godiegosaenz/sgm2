<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE composition PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
                template="/template/template.xhtml"
                xmlns:p="http://primefaces.org/ui"
                xmlns:h="http://xmlns.jcp.org/jsf/html" xmlns="http://www.w3.org/1999/xhtml"
                xmlns:f="http://xmlns.jcp.org/jsf/core">
    <ui:define name="metadata">
        <f:metadata>

        </f:metadata>
    </ui:define>
    <ui:define name="top">
        <h3>Letreros</h3>
    </ui:define>
    <ui:define name="content">
        <h:form id="frmMain">
            <center>
                <p:panelGrid style="width: 100%; margin-bottom: 15px;">
                    <p:row>
                        <p:column colspan="3">
                            <p:outputLabel value="PROPIETARIO: #{letrerosView.local.propietario.nombreCompleto}"/>
                        </p:column>
                    </p:row>
                    <p:row>
                        <p:column >
                            <p:outputLabel value="RAZON SOCIAL: #{letrerosView.local.razonSocial.nombreCompleto}" rendered="#{letrerosView.local.razonSocial != null}"/>
                        </p:column>
                        <p:column >
                            <p:outputLabel value="NOMBRE COMERCIAL: #{letrerosView.local.nombreLocal}"/>
                        </p:column>
                        <p:column >
                            <p:outputLabel value="FECHA INGRESO: #{letrerosView.local.fechaIngreso}"/><p:outputLabel value=""><f:convertDateTime pattern="dd/MM/yyyy"/></p:outputLabel>
                        </p:column>
                    </p:row>
                    <p:row>
                        <p:column>
                            <p:outputLabel value="AREA: #{letrerosView.local.area}"/>
                        </p:column>
                        <p:column >
                            <p:outputLabel value="ESTADO DEL LOCAL: ACTIVO" rendered="#{letrerosView.local.estadoLocalComercial eq 1}"/>
                            <p:outputLabel value="ESTADO DEL LOCAL: INHABILITADO" rendered="#{letrerosView.local.estadoLocalComercial eq 2}"/>
                            <p:outputLabel value="ESTADO DEL LOCAL: CLAUSURADO" rendered="#{letrerosView.local.estadoLocalComercial eq 3}"/>
                        </p:column>
                        <p:column >
                            <p:outputLabel value="NO. DE LOCAL: #{letrerosView.local.numLocal}"/>
                        </p:column>
                    </p:row>
                    
                </p:panelGrid>
                <p:fieldset legend="Datos de la liquidacion del letrero" style="float: left">
                    <p:panelGrid>
                        <p:outputLabel value="AREA: "/>
                        <p:inputText value="#{letrerosView.detalle.areaEdificacion}" disabled="#{letrerosView.local == null}"/>
                    </p:panelGrid>
                    <center>
                        <p:commandButton value="Generar liquidacion" actionListener="#{letrerosView.completarTarea}" disabled="#{letrerosView.local == null}"/>
                    </center>
                </p:fieldset>
                <p:commandButton value="Buscar Local" onclick="PF('dlgSearch').show()" update="frmSearch"
                                                                 style="float: right" styleClass="btnStyle" />
            </center>
        </h:form>
        
        <!-- -->
        
        <p:dialog id="dlgSearch" widgetVar="dlgSearch" position="top" width="70%" header="Buscar local comercial" appendTo="@(body)" modal="true" resizable="false" closable="true" closeOnEscape="true">
            <h:form id="frmSearch">
                <p:messages id="messages" showDetail="true" autoUpdate="true" closable="true" />
                
                <center>
                    <p:dataTable id="dtLocales" lazy="true" value="#{letrerosView.locales}"
                                 var="local" rows="10" paginator="true" paginatorPosition="top"
                                 rowsPerPageTemplate="10, 20, 50, 100" filterEvent="enter" widgetVar="dtLocales" >
                        

                        <p:column headerText="Nombre del local" filterBy="#{local.nombreLocal}" width="28%;">
                            <center><h:outputText value="#{local.nombreLocal}"/></center>
                        </p:column>
                        <p:column headerText="Número del local" filterBy="#{local.numLocal}" width="12%;">
                            <center><h:outputText value="#{local.numLocal}"/></center>
                        </p:column>
                        <p:column headerText="Área del local" filterBy="#{local.area}" width="10%;">
                            <center><h:outputText value="#{local.area}"/></center>
                        </p:column>
                        
                        <p:column headerText="Propietario del local" width="30%;"
                                  filterBy="#{local.propietario.nombresCompletos}">
                            <center><h:outputText value="#{local.propietario.nombres} #{local.propietario.apellidos}" rendered="#{local.propietario.esPersona}"/>
                                <h:outputText value="#{local.propietario.razonSocial}" rendered="#{!local.propietario.esPersona}"/></center>
                        </p:column>
                        
                        <p:column headerText="Estado" width="11%;" filterBy="#{local.estadoLocalComercial}"
                                  filterMatchMode="contains" filterStyle="width: 95%">
                            <f:facet name="filter"  >
                                <p:selectOneMenu id="cat" onchange="PF('dtLocales').filter()" 
                                                 style="width: 75%; font-size: 10px;" >
                                    <f:selectItem itemLabel="Estado Local" itemValue="#{null}" noSelectionOption="true"/>
                                    <f:selectItem itemLabel="Habilitado" itemValue="#{1}" />
                                    <f:selectItem itemLabel="Inhabilitado" itemValue="#{2}" />
                                    <f:selectItem itemLabel="Clausurado" itemValue="#{3}" />
                                </p:selectOneMenu>
                            </f:facet>
                            <center>
                                <h:outputText value="Habilitado" rendered="#{local.estadoLocalComercial eq 1}"   />
                                <h:outputText value="Inhabilitado" rendered="#{local.estadoLocalComercial eq 2}"   />
                                <h:outputText value="Clausurado" rendered="#{local.estadoLocalComercial eq 3}" />
                            </center>
                        </p:column>
                        
                        <p:column width="10%;" headerText="Acción">
                            <p:commandButton value="Seleccionar" actionListener="#{letrerosView.setLocal(local)}" update="frmMain" onclick="PF('dlgSearch').hide()"/>
                        </p:column>
                    </p:dataTable>
                </center>
            </h:form>
        </p:dialog>
        
    </ui:define>
</ui:composition>