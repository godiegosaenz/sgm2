SELECT itemFORMA.* as forma, itemsuelo.valor as suelo, itemtopo.valor as topo , edif.ano_fin_cons, iedifestado.valor as estado,  iedifcondi.valor as condicion, edif.*, serv.ee tiene_luz, serv.abast_agua as tiene_agua,  itemplanta.valor as electricidad, servitem.* as EXCRETAS, item.valor as conjunto, cont.nombres, cont.apellidos, p.provincia, p.canton, pp.id, 
c.nombre, 
p.parroquia,  t.zona, p.sector, p.mz, p.solar, 
p.area_levantada, --p.bloque, p.piso, p.unidad,
* FROM catastro.predio p  
left outer join catastro.ciudadela c ON c.id = p.ciudadela
inner join catastro.predio_propietario pp ON pp.predio = p.id
inner join sisapp.contacto cont ON pp.propietario = cont.id
inner join catastro.catalogo_item item ON item.id = p.tipo_conjunto
inner join catastro.catalogo_item itemtopo ON itemtopo.id = p.topografia
inner join catastro.catalogo_item itemsuelo ON itemsuelo.id = p.TIPO_SUELO 
inner join catastro.catalogo_item itemFORMA ON itemFORMA.id = P.FORMA
inner join flow.orden_det D ON D.PREDIO = P.ID
inner join flow.orden_trabajo T ON T.ID = D.ORDEN
left outer join catastro.predio_edificacion edif ON edif.predio = p.id
left outer join catastro.predio_servicio serv ON serv.predio = p.id
inner join catastro.catalogo_item servitem ON servitem.id = serv.alcan_sanitario
inner join catastro.catalogo_item itemplanta ON itemplanta.id = serv.planta_ee
inner join catastro.catalogo_item iedifestado ON iedifestado.id = edif.estado_edif
inner join catastro.catalogo_item iedifcondi ON iedifcondi.id = edif.condicion
 where p.num_predio = 5228;

---------------------------------------------------------------------


SELECT itemFORMA.* as forma, itemsuelo.valor as suelo, itemtopo.valor as topo , edif.ano_fin_cons, iedifestado.valor as estado,  iedifcondi.valor as condicion,
 edif.*, serv.ee tiene_luz, serv.abast_agua as tiene_agua,  itemplanta.valor as electricidad, servitem.* as EXCRETAS, item.valor as conjunto, cont.nombres, 
 cont.apellidos, p.provincia, p.canton, pp.id, c.nombre, p.parroquia,   p.sector, p.mz, p.solar, p.area_levantada, 
 --p.bloque, p.piso, p.unidad,
* FROM catastro_CENSAL.predio p  
left outer join catastro_CENSAL.ciudadela c ON c.id = p.ciudadela
left outer join catastro_CENSAL.predio_propietario pp ON pp.predio = p.id
left outer join sisapp.contacto cont ON pp.propietario = cont.id
left outer join catastro_CENSAL.catalogo_item item ON item.id = p.tipo_conjunto
left outer join catastro_CENSAL.catalogo_item itemtopo ON itemtopo.id = p.topografia
left outer join catastro_CENSAL.catalogo_item itemsuelo ON itemsuelo.id = p.TIPO_SUELO 
left outer join catastro_CENSAL.catalogo_item itemFORMA ON itemFORMA.id = P.FORMA
--inner join flow.orden_det D ON D.PREDIO = P.ID
--inner join flow.orden_trabajo T ON T.ID = D.ORDEN
left outer join catastro_CENSAL.predio_edificacion edif ON edif.predio = p.id
left outer join catastro_CENSAL.predio_servicio serv ON serv.predio = p.id
left outer join catastro_CENSAL.catalogo_item servitem ON servitem.id = serv.alcan_sanitario
left outer  join catastro_CENSAL.catalogo_item itemplanta ON itemplanta.id = serv.planta_ee
left outer join  catastro_CENSAL.catalogo_item iedifestado ON iedifestado.id = edif.estado_edif
left outer join catastro_CENSAL.catalogo_item iedifcondi ON iedifcondi.id = edif.condicion
 where p.num_predio = 21790;

