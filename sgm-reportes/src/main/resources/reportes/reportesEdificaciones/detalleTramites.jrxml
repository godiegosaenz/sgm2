<?xml version="1.0" encoding="UTF-8"?>
<jasperReport xmlns="http://jasperreports.sourceforge.net/jasperreports" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://jasperreports.sourceforge.net/jasperreports http://jasperreports.sourceforge.net/xsd/jasperreport.xsd" name="detalleTramites" language="groovy" pageWidth="595" pageHeight="842" columnWidth="575" leftMargin="10" rightMargin="10" topMargin="10" bottomMargin="10" uuid="9fdf6a8d-7086-4769-b86b-6e3a87e0679b">
	<property name="ireport.zoom" value="2.0"/>
	<property name="ireport.x" value="675"/>
	<property name="ireport.y" value="11"/>
	<parameter name="LOGO" class="java.lang.String"/>
	<parameter name="TRAMITES" class="java.util.Collection">
		<parameterDescription><![CDATA[]]></parameterDescription>
		<defaultValueExpression><![CDATA[]]></defaultValueExpression>
	</parameter>
	<parameter name="DESDE" class="java.util.Date"/>
	<parameter name="HASTA" class="java.util.Date"/>
	<parameter name="ESTADO" class="java.lang.String"/>
	<queryString>
		<![CDATA[SELECT ht.id as tramite,tt.descripcion,ht.fecha,ht.estado,ht.nombre_propietario, ht.num_liquidacion, ht.tipo_tramite_nombre
FROM sgm_app.ge_tipo_tramite tt
LEFT OUTER JOIN sgm_flow.historico_tramites ht ON (ht.tipo_tramite=tt.id)
WHERE tt.departamento=1 AND tt.estado AND ht.id IS NOT NULL
AND $X{IN,tt.id,TRAMITES}
AND (to_char(ht.fecha, 'yyyy-MM-dd')::timestamp BETWEEN $P{DESDE}::timestamp AND $P{HASTA}::timestamp)
AND (ht.estado ILIKE $P{ESTADO} OR $P{ESTADO} IS NULL)
ORDER BY tt.descripcion ASC, ht.id ASC]]>
	</queryString>
	<field name="tramite" class="java.lang.Long"/>
	<field name="descripcion" class="java.lang.String"/>
	<field name="fecha" class="java.sql.Timestamp"/>
	<field name="estado" class="java.lang.String"/>
	<field name="nombre_propietario" class="java.lang.String"/>
	<field name="num_liquidacion" class="java.lang.Long"/>
	<field name="tipo_tramite_nombre" class="java.lang.String"/>
	<group name="tipo_tramite">
		<groupExpression><![CDATA[$F{descripcion}]]></groupExpression>
		<groupHeader>
			<band height="24">
				<staticText>
					<reportElement x="0" y="0" width="41" height="12" uuid="6850fcbd-6c38-45d1-9ee2-5d860cd68744"/>
					<textElement>
						<font size="8" isBold="true"/>
					</textElement>
					<text><![CDATA[Tramite]]></text>
				</staticText>
				<textField>
					<reportElement x="41" y="0" width="149" height="12" uuid="7f5b2668-ad24-480c-842d-c3bd85fbd74b"/>
					<textElement>
						<font size="8"/>
					</textElement>
					<textFieldExpression><![CDATA[$F{descripcion}]]></textFieldExpression>
				</textField>
				<staticText>
					<reportElement x="0" y="12" width="41" height="12" uuid="d9b623eb-007d-423c-8a80-3539ae191ec2"/>
					<textElement>
						<font size="8" isBold="true"/>
					</textElement>
					<text><![CDATA[# Tramite]]></text>
				</staticText>
				<staticText>
					<reportElement x="41" y="12" width="58" height="12" uuid="bcb0cc30-aa95-4471-84f2-eeba3ea7e919"/>
					<textElement>
						<font size="8" isBold="true"/>
					</textElement>
					<text><![CDATA[Fecha]]></text>
				</staticText>
				<staticText>
					<reportElement x="99" y="12" width="80" height="12" uuid="a4181739-d80e-415a-8eac-a5b6940a886a"/>
					<textElement>
						<font size="8" isBold="true"/>
					</textElement>
					<text><![CDATA[Estado]]></text>
				</staticText>
				<staticText>
					<reportElement x="179" y="12" width="110" height="12" uuid="d0a7ee7f-4315-42e3-8661-9d6bf8cc8767"/>
					<textElement>
						<font size="8" isBold="true"/>
					</textElement>
					<text><![CDATA[Solicitante]]></text>
				</staticText>
				<staticText>
					<reportElement x="300" y="12" width="113" height="12" uuid="56764aba-e8d0-4218-b618-8bbc02940daa"/>
					<textElement>
						<font size="8" isBold="true"/>
					</textElement>
					<text><![CDATA[LiquidaciÃ³n]]></text>
				</staticText>
				<staticText>
					<reportElement x="413" y="12" width="162" height="12" uuid="4eb708f6-b0ae-42b6-8608-55579c60a5d2"/>
					<textElement>
						<font size="8" isBold="true"/>
					</textElement>
					<text><![CDATA[Detalle Tramite]]></text>
				</staticText>
			</band>
		</groupHeader>
		<groupFooter>
			<band height="21">
				<textField>
					<reportElement x="41" y="0" width="138" height="14" uuid="3af251a7-589b-4ba2-982a-0abe57f94a78"/>
					<textFieldExpression><![CDATA[$V{tipo_tramite_COUNT}]]></textFieldExpression>
				</textField>
				<staticText>
					<reportElement x="0" y="0" width="41" height="14" uuid="2ae6e4da-2a23-4fe3-ac76-6b97057e23bf"/>
					<text><![CDATA[Total:]]></text>
				</staticText>
			</band>
		</groupFooter>
	</group>
	<background>
		<band splitType="Stretch"/>
	</background>
	<title>
		<band height="71" splitType="Stretch">
			<image>
				<reportElement x="0" y="18" width="120" height="38" uuid="b8d2d6b2-5602-47c7-88bb-faa59fad9eb2"/>
				<imageExpression><![CDATA[$P{LOGO}]]></imageExpression>
			</image>
			<staticText>
				<reportElement mode="Opaque" x="0" y="0" width="575" height="16" backcolor="#CCCCCC" uuid="726fd512-fc5e-404e-9ca8-c4e1c740bb69"/>
				<textElement>
					<font size="12" isBold="true"/>
				</textElement>
				<text><![CDATA[Reporte: Detalle de Tramites.]]></text>
			</staticText>
			<staticText>
				<reportElement x="438" y="18" width="57" height="20" uuid="17e9cdc3-0676-4cbf-9fbd-dda56d9433b5"/>
				<textElement textAlignment="Right"/>
				<text><![CDATA[Fecha:]]></text>
			</staticText>
			<textField pattern="dd/MM/yyyy" isBlankWhenNull="true">
				<reportElement x="495" y="18" width="80" height="20" uuid="16f9b826-4a0e-481c-bc64-d19b1d3edeae"/>
				<textFieldExpression><![CDATA[new java.util.Date()]]></textFieldExpression>
			</textField>
			<staticText>
				<reportElement x="0" y="56" width="120" height="15" uuid="bab76373-b8af-4090-bf12-13b1d768834e"/>
				<textElement>
					<font isBold="true"/>
				</textElement>
				<text><![CDATA[Criterio de busqueda]]></text>
			</staticText>
			<textField pattern="dd/MM/yyyy" isBlankWhenNull="true">
				<reportElement x="155" y="56" width="55" height="15" uuid="1a9898fd-ffb6-4b14-8af0-6abb4f41ae3b"/>
				<textFieldExpression><![CDATA[$P{DESDE}]]></textFieldExpression>
			</textField>
			<textField pattern="dd/MM/yyyy" isBlankWhenNull="true">
				<reportElement x="245" y="56" width="55" height="15" uuid="315d1d5f-ee71-452e-99c5-971dfd2e8f24"/>
				<textFieldExpression><![CDATA[$P{HASTA}]]></textFieldExpression>
			</textField>
			<textField isBlankWhenNull="true">
				<reportElement x="358" y="56" width="217" height="15" uuid="54c9915a-1b33-446c-9704-0188a03a0af2"/>
				<textFieldExpression><![CDATA[$P{TRAMITES}.equals( null )?"TODOS LOS TRAMITES":$P{TRAMITES}]]></textFieldExpression>
			</textField>
			<staticText>
				<reportElement x="120" y="56" width="35" height="15" uuid="9a402a45-7c83-4b6e-8edb-792242aef5ef"/>
				<textElement textAlignment="Right"/>
				<text><![CDATA[Desde:]]></text>
			</staticText>
			<staticText>
				<reportElement x="210" y="56" width="35" height="15" uuid="58aa883b-6deb-4fff-a7ba-c005f2192f7c"/>
				<textElement textAlignment="Right"/>
				<text><![CDATA[Hasta:]]></text>
			</staticText>
			<staticText>
				<reportElement x="307" y="56" width="51" height="15" uuid="e4dbdba9-be6d-46c3-80d9-18f2f0c25171"/>
				<textElement textAlignment="Right"/>
				<text><![CDATA[Tramites:]]></text>
			</staticText>
		</band>
	</title>
	<pageHeader>
		<band height="9" splitType="Stretch"/>
	</pageHeader>
	<columnHeader>
		<band height="9" splitType="Stretch"/>
	</columnHeader>
	<detail>
		<band height="13" splitType="Stretch">
			<textField>
				<reportElement x="0" y="0" width="41" height="13" uuid="493ebfe5-c0ed-4a86-916f-543a9ba67cea"/>
				<textElement textAlignment="Center">
					<font size="8"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{tramite}]]></textFieldExpression>
			</textField>
			<textField pattern="dd/MM/yyyy">
				<reportElement x="41" y="0" width="58" height="13" uuid="b05e2e18-6835-4e03-b7d6-70ed84fe177c"/>
				<textElement>
					<font size="8"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{fecha}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="99" y="0" width="80" height="13" uuid="f5ec83ea-9bf3-40a4-89f6-7bbcb4ef0868"/>
				<textElement>
					<font size="8"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{estado}]]></textFieldExpression>
			</textField>
			<textField isBlankWhenNull="true">
				<reportElement x="179" y="0" width="110" height="13" uuid="dacd9455-8faa-4801-94d3-a9594e43e664"/>
				<textElement>
					<font size="8"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{nombre_propietario}]]></textFieldExpression>
			</textField>
			<textField isBlankWhenNull="true">
				<reportElement x="300" y="0" width="113" height="13" uuid="7beff3fd-2b7f-4756-8a90-a747848c0945"/>
				<textElement>
					<font size="8"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{num_liquidacion}==null?"Por Liquidar":"Liquidado:"+$F{num_liquidacion}]]></textFieldExpression>
			</textField>
			<textField isBlankWhenNull="true">
				<reportElement x="413" y="0" width="162" height="13" uuid="755e5fc4-27d9-437c-b9eb-b921aaec42a9"/>
				<textElement verticalAlignment="Middle">
					<font size="6"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{tipo_tramite_nombre}]]></textFieldExpression>
			</textField>
		</band>
	</detail>
	<columnFooter>
		<band splitType="Stretch"/>
	</columnFooter>
	<pageFooter>
		<band splitType="Stretch"/>
	</pageFooter>
	<summary>
		<band splitType="Stretch"/>
	</summary>
</jasperReport>
